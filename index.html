<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Funcionários</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Estados brasileiros completos
        const ESTADOS_BRASILEIROS = [
            { sigla: 'AC', nome: 'Acre' },
            { sigla: 'AL', nome: 'Alagoas' },
            { sigla: 'AP', nome: 'Amapá' },
            { sigla: 'AM', nome: 'Amazonas' },
            { sigla: 'BA', nome: 'Bahia' },
            { sigla: 'CE', nome: 'Ceará' },
            { sigla: 'DF', nome: 'Distrito Federal' },
            { sigla: 'ES', nome: 'Espírito Santo' },
            { sigla: 'GO', nome: 'Goiás' },
            { sigla: 'MA', nome: 'Maranhão' },
            { sigla: 'MT', nome: 'Mato Grosso' },
            { sigla: 'MS', nome: 'Mato Grosso do Sul' },
            { sigla: 'MG', nome: 'Minas Gerais' },
            { sigla: 'PA', nome: 'Pará' },
            { sigla: 'PB', nome: 'Paraíba' },
            { sigla: 'PR', nome: 'Paraná' },
            { sigla: 'PE', nome: 'Pernambuco' },
            { sigla: 'PI', nome: 'Piauí' },
            { sigla: 'RJ', nome: 'Rio de Janeiro' },
            { sigla: 'RN', nome: 'Rio Grande do Norte' },
            { sigla: 'RS', nome: 'Rio Grande do Sul' },
            { sigla: 'RO', nome: 'Rondônia' },
            { sigla: 'RR', nome: 'Roraima' },
            { sigla: 'SC', nome: 'Santa Catarina' },
            { sigla: 'SP', nome: 'São Paulo' },
            { sigla: 'SE', nome: 'Sergipe' },
            { sigla: 'TO', nome: 'Tocantins' }
        ];

        // Feriados nacionais
        const FERIADOS_NACIONAIS_2025 = {
            '2025-01-01': 'Confraternização Universal',
            '2025-03-03': 'Carnaval',
            '2025-03-04': 'Carnaval',
            '2025-04-18': 'Sexta-feira Santa',
            '2025-04-21': 'Tiradentes',
            '2025-05-01': 'Dia do Trabalho',
            '2025-06-19': 'Corpus Christi',
            '2025-09-07': 'Independência do Brasil',
            '2025-10-12': 'Nossa Senhora Aparecida',
            '2025-11-02': 'Finados',
            '2025-11-15': 'Proclamação da República',
            '2025-11-20': 'Consciência Negra',
            '2025-12-25': 'Natal'
        };

        // Funções auxiliares
        const validarCPF = (cpf) => {
            cpf = cpf.replace(/[^\d]/g, '');
            if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
            let soma = 0;
            for (let i = 0; i < 9; i++) soma += parseInt(cpf.charAt(i)) * (10 - i);
            let resto = (soma * 10) % 11;
            if (resto === 10 || resto === 11) resto = 0;
            if (resto !== parseInt(cpf.charAt(9))) return false;
            soma = 0;
            for (let i = 0; i < 10; i++) soma += parseInt(cpf.charAt(i)) * (11 - i);
            resto = (soma * 10) % 11;
            if (resto === 10 || resto === 11) resto = 0;
            return resto === parseInt(cpf.charAt(10));
        };

        const validarCNPJ = (cnpj) => {
            cnpj = cnpj.replace(/[^\d]/g, '');
            if (cnpj.length !== 14 || /^(\d)\1+$/.test(cnpj)) return false;
            let tamanho = 12, numeros = cnpj.substring(0, tamanho), digitos = cnpj.substring(tamanho);
            let soma = 0, pos = tamanho - 7;
            for (let i = tamanho; i >= 1; i--) {
                soma += numeros.charAt(tamanho - i) * pos--;
                if (pos < 2) pos = 9;
            }
            let resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
            if (resultado !== parseInt(digitos.charAt(0))) return false;
            tamanho = 13;
            numeros = cnpj.substring(0, tamanho);
            soma = 0;
            pos = tamanho - 7;
            for (let i = tamanho; i >= 1; i--) {
                soma += numeros.charAt(tamanho - i) * pos--;
                if (pos < 2) pos = 9;
            }
            resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
            return resultado === parseInt(digitos.charAt(1));
        };

        const formatarCPF = (cpf) => cpf.replace(/[^\d]/g, '').replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        const formatarCNPJ = (cnpj) => cnpj.replace(/[^\d]/g, '').replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
        const formatarMoeda = (valor) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor || 0);
        const formatarData = (data) => data ? new Date(data + 'T00:00:00').toLocaleDateString('pt-BR') : '';

        const calcularDiasFerias = (dataAdmissao) => {
            const hoje = new Date();
            const admissao = new Date(dataAdmissao);
            const diffTime = Math.abs(hoje - admissao);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            const mesesTrabalhados = Math.floor(diffDays / 30);
            const periodoAquisitivo = Math.floor(mesesTrabalhados / 12);
            const mesesRestantes = 12 - (mesesTrabalhados % 12);
            const dataVencimento = new Date(admissao);
            dataVencimento.setMonth(dataVencimento.getMonth() + ((periodoAquisitivo + 1) * 12));
            
            return {
                periodoAquisitivo,
                mesesRestantes,
                dataVencimento: dataVencimento.toISOString().split('T')[0],
                diasFerias: 30
            };
        };

        // Sistema de armazenamento local otimizado
        const Storage = {
            save: (key, data) => {
                try {
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (e) {
                    console.error('Erro ao salvar:', e);
                    return false;
                }
            },
            load: (key, defaultValue = null) => {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : defaultValue;
                } catch (e) {
                    console.error('Erro ao carregar:', e);
                    return defaultValue;
                }
            }
        };

        // Componente Principal
        function App() {
            const [usuarioLogado, setUsuarioLogado] = useState(null);
            const [paginaAtual, setPaginaAtual] = useState('dashboard');
            const [dados, setDados] = useState({
                empresas: [],
                funcionarios: [],
                avisos: [],
                registrosPonto: [],
                holerites: [],
                solicitacoesFerias: [],
                feriadosPontoFacultativo: [],
                documentos: []
            });

            useEffect(() => {
                const dadosSalvos = Storage.load('sistemaRH_v2', {
                    empresas: [],
                    funcionarios: [],
                    avisos: [],
                    registrosPonto: [],
                    holerites: [],
                    solicitacoesFerias: [],
                    feriadosPontoFacultativo: [],
                    documentos: []
                });
                setDados(dadosSalvos);
            }, []);

            useEffect(() => {
                if (usuarioLogado) {
                    Storage.save('sistemaRH_v2', dados);
                }
            }, [dados, usuarioLogado]);

            const atualizarDados = (campo, valor) => {
                setDados(prev => ({ ...prev, [campo]: valor }));
            };

            const avisosNaoLidos = dados.avisos.filter(a => 
                !a.lidoPor?.includes(usuarioLogado?.id)
            ).length;

            if (!usuarioLogado) {
                return <Login onLogin={setUsuarioLogado} funcionarios={dados.funcionarios} />;
            }

            return (
                <div className="flex h-screen bg-gray-100">
                    <Sidebar 
                        usuario={usuarioLogado} 
                        paginaAtual={paginaAtual}
                        setPagina={setPaginaAtual}
                        onLogout={() => setUsuarioLogado(null)}
                        avisosNaoLidos={avisosNaoLidos}
                    />
                    <div className="flex-1 overflow-auto">
                        <Header usuario={usuarioLogado} />
                        <main className="p-6">
                            {paginaAtual === 'dashboard' && (
                                <Dashboard dados={dados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'empresas' && (
                                <GestaoEmpresas dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'funcionarios' && (
                                <GestaoFuncionarios dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'rendimentos' && (
                                <Rendimentos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'jornada' && (
                                <RegistroJornada dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'ferias' && (
                                <Ferias dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'feriados' && (
                                <Feriados dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'avisos' && (
                                <Avisos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'documentos' && (
                                <Documentos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'informacoes' && (
                                <Informacoes />
                            )}
                        </main>
                    </div>
                </div>
            );
        }

        // Login
        function Login({ onLogin, funcionarios }) {
            const [usuario, setUsuario] = useState('');
            const [senha, setSenha] = useState('');
            const [erro, setErro] = useState('');

            const handleLogin = (e) => {
                e.preventDefault();
                if (usuario === 'admin' && senha === 'admin123') {
                    onLogin({ nome: 'Administrador', tipo: 'admin', id: 'admin' });
                } else {
                    const func = funcionarios.find(f => f.cpf.replace(/[^\d]/g, '') === usuario.replace(/[^\d]/g, ''));
                    if (func && senha === 'func123') {
                        onLogin({ nome: func.nome, tipo: 'funcionario', id: func.id, cpf: func.cpf });
                    } else {
                        setErro('Usuário ou senha inválidos');
                    }
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600">
                    <div className="bg-white p-8 rounded-lg shadow-2xl w-96">
                        <div className="text-center mb-8">
                            <i className="fas fa-users-cog text-6xl text-blue-600 mb-4"></i>
                            <h1 className="text-3xl font-bold text-gray-800">Sistema RH</h1>
                            <p className="text-gray-600 mt-2">Gestão de Funcionários</p>
                        </div>
                        <form onSubmit={handleLogin}>
                            <div className="mb-4">
                                <label className="block text-gray-700 mb-2">Usuário / CPF</label>
                                <input type="text" value={usuario} onChange={(e) => setUsuario(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="Digite seu usuário ou CPF" />
                            </div>
                            <div className="mb-6">
                                <label className="block text-gray-700 mb-2">Senha</label>
                                <input type="password" value={senha} onChange={(e) => setSenha(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="Digite sua senha" />
                            </div>
                            {erro && <div className="mb-4 p-3 bg-red-100 text-red-700 rounded-lg">{erro}</div>}
                            <button type="submit" className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition">
                                Entrar
                            </button>
                        </form>
                        <div className="mt-6 text-sm text-gray-600 text-center">
                            <p>Admin: admin / admin123</p>
                            <p>Funcionário: CPF / func123</p>
                        </div>
                    </div>
                </div>
            );
        }

        // Continua...
        // Sidebar
        function Sidebar({ usuario, paginaAtual, setPagina, onLogout, avisosNaoLidos }) {
            const menuItems = usuario.tipo === 'admin' ? [
                { id: 'dashboard', icon: 'chart-line', label: 'Dashboard' },
                { id: 'empresas', icon: 'building', label: 'Empresas' },
                { id: 'funcionarios', icon: 'users', label: 'Funcionários' },
                { id: 'rendimentos', icon: 'money-bill-wave', label: 'Rendimentos' },
                { id: 'jornada', icon: 'clock', label: 'Jornada' },
                { id: 'ferias', icon: 'umbrella-beach', label: 'Férias' },
                { id: 'feriados', icon: 'calendar-alt', label: 'Feriados' },
                { id: 'avisos', icon: 'bullhorn', label: 'Avisos', badge: avisosNaoLidos },
                { id: 'documentos', icon: 'file-alt', label: 'Documentos' },
                { id: 'informacoes', icon: 'info-circle', label: 'Informações' },
            ] : [
                { id: 'dashboard', icon: 'chart-line', label: 'Início' },
                { id: 'rendimentos', icon: 'money-bill-wave', label: 'Holerites' },
                { id: 'jornada', icon: 'clock', label: 'Meu Ponto' },
                { id: 'ferias', icon: 'umbrella-beach', label: 'Férias' },
                { id: 'feriados', icon: 'calendar-alt', label: 'Feriados' },
                { id: 'avisos', icon: 'bullhorn', label: 'Avisos', badge: avisosNaoLidos },
                { id: 'documentos', icon: 'file-alt', label: 'Documentos' },
            ];

            return (
                <div className="w-64 bg-gray-900 text-white flex flex-col">
                    <div className="p-6 border-b border-gray-800">
                        <h1 className="text-xl font-bold">Sistema RH</h1>
                        <p className="text-sm text-gray-400 mt-1 truncate">{usuario.nome}</p>
                        <span className={`inline-block px-2 py-1 text-xs rounded mt-2 ${usuario.tipo === 'admin' ? 'bg-red-600' : 'bg-blue-600'}`}>
                            {usuario.tipo === 'admin' ? 'Admin' : 'Funcionário'}
                        </span>
                    </div>
                    <nav className="flex-1 p-4 overflow-y-auto scrollbar-hide">
                        {menuItems.map(item => (
                            <button key={item.id} onClick={() => setPagina(item.id)}
                                className={`w-full text-left px-4 py-3 rounded-lg mb-2 flex items-center justify-between transition ${
                                    paginaAtual === item.id ? 'bg-blue-600 text-white' : 'text-gray-300 hover:bg-gray-800'
                                }`}>
                                <div className="flex items-center">
                                    <i className={`fas fa-${item.icon} mr-3`}></i>
                                    <span className="text-sm">{item.label}</span>
                                </div>
                                {item.badge > 0 && <span className="bg-red-500 text-white text-xs rounded-full px-2 py-1">{item.badge}</span>}
                            </button>
                        ))}
                    </nav>
                    <div className="p-4 border-t border-gray-800">
                        <button onClick={onLogout} className="w-full px-4 py-3 bg-red-600 rounded-lg hover:bg-red-700 transition flex items-center justify-center">
                            <i className="fas fa-sign-out-alt mr-2"></i>Sair
                        </button>
                    </div>
                </div>
            );
        }

        // Header
        function Header({ usuario }) {
            const [dataHora, setDataHora] = useState(new Date());
            useEffect(() => {
                const timer = setInterval(() => setDataHora(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            return (
                <header className="bg-white shadow-sm p-4 flex justify-between items-center">
                    <h2 className="text-2xl font-bold text-gray-800">Bem-vindo, {usuario.nome}!</h2>
                    <div className="text-right">
                        <div className="text-gray-600 text-sm">
                            {dataHora.toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                        </div>
                        <div className="text-gray-500 text-xs">{dataHora.toLocaleTimeString('pt-BR')}</div>
                    </div>
                </header>
            );
        }

        // Dashboard
        function Dashboard({ dados, usuarioLogado }) {
            if (usuarioLogado.tipo === 'funcionario') {
                const meusDados = dados.funcionarios.find(f => f.id === usuarioLogado.id);
                if (!meusDados) return <div className="text-center p-8">Dados não encontrados</div>;

                const feriasInfo = calcularDiasFerias(meusDados.dataAdmissao);
                const meusHolerites = dados.holerites.filter(h => h.funcionarioId === usuarioLogado.id);
                const meusRegistros = dados.registrosPonto.filter(r => r.funcionarioId === usuarioLogado.id);

                return (
                    <div>
                        <h2 className="text-3xl font-bold mb-6">Meu Painel</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-blue-500">
                                <p className="text-gray-600 mb-2">Cargo</p>
                                <p className="text-xl font-bold text-gray-800">{meusDados.cargo}</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-green-500">
                                <p className="text-gray-600 mb-2">Admissão</p>
                                <p className="text-xl font-bold text-gray-800">{formatarData(meusDados.dataAdmissao)}</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-purple-500">
                                <p className="text-gray-600 mb-2">Próximas Férias</p>
                                <p className="text-xl font-bold text-gray-800">{feriasInfo.mesesRestantes} meses</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-orange-500">
                                <p className="text-gray-600 mb-2">Status</p>
                                <p className="text-xl font-bold text-gray-800">{meusDados.status}</p>
                            </div>
                        </div>
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Últimos Holerites</h3>
                                {meusHolerites.length === 0 ? (
                                    <p className="text-gray-500 text-center py-4">Nenhum holerite cadastrado</p>
                                ) : (
                                    <div className="space-y-2">
                                        {meusHolerites.slice(-3).reverse().map((h, i) => (
                                            <div key={i} className="p-3 bg-gray-50 rounded flex justify-between">
                                                <span>{h.mes}/{h.ano}</span>
                                                <span className="font-bold text-green-600">{formatarMoeda(h.salarioLiquido)}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Registros de Hoje</h3>
                                {meusRegistros.filter(r => r.data === new Date().toISOString().split('T')[0]).length === 0 ? (
                                    <p className="text-gray-500 text-center py-4">Nenhum registro hoje</p>
                                ) : (
                                    <div className="space-y-2">
                                        {meusRegistros.filter(r => r.data === new Date().toISOString().split('T')[0]).map((r, i) => (
                                            <div key={i} className="p-3 bg-gray-50 rounded flex justify-between">
                                                <span className={`px-2 py-1 rounded text-xs ${
                                                    r.tipo === 'Entrada' ? 'bg-green-100 text-green-800' :
                                                    r.tipo === 'Saída' ? 'bg-red-100 text-red-800' :
                                                    'bg-yellow-100 text-yellow-800'
                                                }`}>{r.tipo}</span>
                                                <span className="font-bold">{r.hora}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            // Dashboard Admin
            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Dashboard Administrativo</h2>
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        {[
                            { titulo: 'Empresas', valor: dados.empresas.length, icon: 'building', cor: 'blue' },
                            { titulo: 'Funcionários', valor: dados.funcionarios.length, icon: 'users', cor: 'green' },
                            { titulo: 'Ativos', valor: dados.funcionarios.filter(f => f.status === 'Ativo').length, icon: 'user-check', cor: 'purple' },
                            { titulo: 'CLT', valor: dados.funcionarios.filter(f => f.tipoVinculo === 'CLT').length, icon: 'id-card', cor: 'orange' },
                        ].map((card, i) => (
                            <div key={i} className={`bg-white p-6 rounded-lg shadow-lg border-l-4 border-${card.cor}-500`}>
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-gray-600 mb-2">{card.titulo}</p>
                                        <p className="text-4xl font-bold text-gray-800">{card.valor}</p>
                                    </div>
                                    <i className={`fas fa-${card.icon} text-5xl text-${card.cor}-500 opacity-20`}></i>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Gestão de Empresas
        function GestaoEmpresas({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [empresaEditando, setEmpresaEditando] = useState(null);
            const [busca, setBusca] = useState('');

            const empresasFiltradas = dados.empresas.filter(emp =>
                emp.razaoSocial.toLowerCase().includes(busca.toLowerCase()) || emp.cnpj.includes(busca)
            );

            const salvarEmpresa = (empresa) => {
                if (empresaEditando) {
                    atualizar('empresas', dados.empresas.map(e => e.id === empresa.id ? empresa : e));
                } else {
                    atualizar('empresas', [...dados.empresas, { ...empresa, id: Date.now() }]);
                }
                setMostrarForm(false);
                setEmpresaEditando(null);
            };

            if (usuarioLogado.tipo !== 'admin') {
                return (
                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h2 className="text-2xl font-bold mb-4">Empresas Cadastradas</h2>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead><tr className="border-b">
                                    <th className="text-left p-3">Razão Social</th>
                                    <th className="text-left p-3">CNPJ</th>
                                    <th className="text-left p-3">Cidade/UF</th>
                                </tr></thead>
                                <tbody>
                                    {dados.empresas.map((emp, i) => (
                                        <tr key={i} className="border-b hover:bg-gray-50">
                                            <td className="p-3">{emp.razaoSocial}</td>
                                            <td className="p-3">{emp.cnpj}</td>
                                            <td className="p-3">{emp.cidade}/{emp.estado}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                );
            }

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Gestão de Empresas</h2>
                        <button onClick={() => { setMostrarForm(true); setEmpresaEditando(null); }}
                            className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                            <i className="fas fa-plus mr-2"></i>Nova Empresa
                        </button>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow mb-4">
                        <input type="text" placeholder="Buscar empresa..." value={busca} onChange={(e) => setBusca(e.target.value)}
                            className="w-full px-4 py-2 border rounded-lg" />
                    </div>
                    {mostrarForm && (
                        <FormEmpresa empresa={empresaEditando} onSalvar={salvarEmpresa} onCancelar={() => { setMostrarForm(false); setEmpresaEditando(null); }} />
                    )}
                    <div className="bg-white rounded-lg shadow-lg overflow-x-auto">
                        <table className="w-full">
                            <thead className="bg-gray-50"><tr>
                                <th className="text-left p-4">Razão Social</th>
                                <th className="text-left p-4">CNPJ</th>
                                <th className="text-left p-4">Cidade/UF</th>
                                <th className="text-center p-4">Ações</th>
                            </tr></thead>
                            <tbody>
                                {empresasFiltradas.map((emp, i) => (
                                    <tr key={i} className="border-b hover:bg-gray-50">
                                        <td className="p-4 font-medium">{emp.razaoSocial}</td>
                                        <td className="p-4">{emp.cnpj}</td>
                                        <td className="p-4">{emp.cidade}/{emp.estado}</td>
                                        <td className="p-4">
                                            <div className="flex justify-center gap-2">
                                                <button onClick={() => { setEmpresaEditando(emp); setMostrarForm(true); }} className="text-blue-600 hover:text-blue-800">
                                                    <i className="fas fa-edit"></i>
                                                </button>
                                                <button onClick={() => confirm('Excluir?') && atualizar('empresas', dados.empresas.filter(e => e.id !== emp.id))} className="text-red-600 hover:text-red-800">
                                                    <i className="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // Form Empresa
        function FormEmpresa({ empresa, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState(empresa || {
                razaoSocial: '', cnpj: '', endereco: '', bairro: '', cidade: '', estado: ''
            });
            const [erros, setErros] = useState({});

            const handleSubmit = (e) => {
                e.preventDefault();
                const novosErros = {};
                if (!formData.razaoSocial) novosErros.razaoSocial = 'Obrigatório';
                if (!formData.cnpj) novosErros.cnpj = 'Obrigatório';
                else if (!validarCNPJ(formData.cnpj)) novosErros.cnpj = 'CNPJ inválido';
                if (Object.keys(novosErros).length > 0) {
                    setErros(novosErros);
                    return;
                }
                onSalvar({ ...formData, cnpj: formatarCNPJ(formData.cnpj) });
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">{empresa ? 'Editar' : 'Nova'} Empresa</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="md:col-span-2">
                                <label className="block mb-2 font-medium">Razão Social *</label>
                                <input type="text" value={formData.razaoSocial} onChange={(e) => setFormData({...formData, razaoSocial: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.razaoSocial ? 'border-red-500' : ''}`} />
                                {erros.razaoSocial && <p className="text-red-500 text-sm mt-1">{erros.razaoSocial}</p>}
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CNPJ *</label>
                                <input type="text" value={formData.cnpj} onChange={(e) => setFormData({...formData, cnpj: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.cnpj ? 'border-red-500' : ''}`} placeholder="00.000.000/0000-00" />
                                {erros.cnpj && <p className="text-red-500 text-sm mt-1">{erros.cnpj}</p>}
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Endereço</label>
                                <input type="text" value={formData.endereco} onChange={(e) => setFormData({...formData, endereco: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Bairro</label>
                                <input type="text" value={formData.bairro} onChange={(e) => setFormData({...formData, bairro: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Cidade</label>
                                <input type="text" value={formData.cidade} onChange={(e) => setFormData({...formData, cidade: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Estado</label>
                                <select value={formData.estado} onChange={(e) => setFormData({...formData, estado: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {ESTADOS_BRASILEIROS.map(est => <option key={est.sigla} value={est.sigla}>{est.sigla} - {est.nome}</option>)}
                                </select>
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // CONTINUA PRÓXIMO BLOCO...
        // Gestão de Funcionários
        function GestaoFuncionarios({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [funcionarioEditando, setFuncionarioEditando] = useState(null);
            const [busca, setBusca] = useState('');
            const [filtroStatus, setFiltroStatus] = useState('Todos');

            let funcionariosFiltrados = dados.funcionarios.filter(func => {
                const matchBusca = func.nome.toLowerCase().includes(busca.toLowerCase()) || func.cpf.includes(busca) || func.cargo.toLowerCase().includes(busca.toLowerCase());
                const matchStatus = filtroStatus === 'Todos' || func.status === filtroStatus;
                return matchBusca && matchStatus;
            });

            if (usuarioLogado.tipo !== 'admin') {
                funcionariosFiltrados = dados.funcionarios.filter(f => f.id === usuarioLogado.id);
            }

            const salvarFuncionario = (funcionario) => {
                if (funcionarioEditando) {
                    atualizar('funcionarios', dados.funcionarios.map(f => f.id === funcionario.id ? funcionario : f));
                } else {
                    atualizar('funcionarios', [...dados.funcionarios, { ...funcionario, id: Date.now() }]);
                }
                setMostrarForm(false);
                setFuncionarioEditando(null);
            };

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Gestão de Funcionários</h2>
                        {usuarioLogado.tipo === 'admin' && (
                            <button onClick={() => { setMostrarForm(true); setFuncionarioEditando(null); }}
                                className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-user-plus mr-2"></i>Novo Funcionário
                            </button>
                        )}
                    </div>
                    {usuarioLogado.tipo === 'admin' && (
                        <div className="bg-white p-4 rounded-lg shadow mb-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="text" placeholder="Buscar por nome, CPF ou cargo..." value={busca} onChange={(e) => setBusca(e.target.value)}
                                className="px-4 py-2 border rounded-lg" />
                            <select value={filtroStatus} onChange={(e) => setFiltroStatus(e.target.value)} className="px-4 py-2 border rounded-lg">
                                <option value="Todos">Todos os Status</option>
                                <option value="Ativo">Ativo</option>
                                <option value="Inativo">Inativo</option>
                                <option value="Férias">Férias</option>
                                <option value="Afastado">Afastado</option>
                            </select>
                        </div>
                    )}
                    {mostrarForm && (
                        <FormFuncionario funcionario={funcionarioEditando} empresas={dados.empresas} onSalvar={salvarFuncionario} 
                            onCancelar={() => { setMostrarForm(false); setFuncionarioEditando(null); }} />
                    )}
                    <div className="bg-white rounded-lg shadow-lg overflow-x-auto">
                        <table className="w-full">
                            <thead className="bg-gray-50"><tr>
                                <th className="text-left p-4">Nome</th>
                                <th className="text-left p-4">CPF</th>
                                <th className="text-left p-4">Cargo</th>
                                <th className="text-left p-4">Admissão</th>
                                <th className="text-left p-4">Status</th>
                                {usuarioLogado.tipo === 'admin' && <th className="text-center p-4">Ações</th>}
                            </tr></thead>
                            <tbody>
                                {funcionariosFiltrados.map((func, i) => (
                                    <tr key={i} className="border-b hover:bg-gray-50">
                                        <td className="p-4 font-medium">{func.nome}</td>
                                        <td className="p-4">{func.cpf}</td>
                                        <td className="p-4">{func.cargo}</td>
                                        <td className="p-4">{formatarData(func.dataAdmissao)}</td>
                                        <td className="p-4">
                                            <span className={`px-2 py-1 rounded text-xs ${
                                                func.status === 'Ativo' ? 'bg-green-100 text-green-800' :
                                                func.status === 'Inativo' ? 'bg-red-100 text-red-800' :
                                                func.status === 'Férias' ? 'bg-yellow-100 text-yellow-800' :
                                                'bg-gray-100 text-gray-800'
                                            }`}>{func.status}</span>
                                        </td>
                                        {usuarioLogado.tipo === 'admin' && (
                                            <td className="p-4">
                                                <div className="flex justify-center gap-2">
                                                    <button onClick={() => { setFuncionarioEditando(func); setMostrarForm(true); }} className="text-blue-600 hover:text-blue-800">
                                                        <i className="fas fa-edit"></i>
                                                    </button>
                                                    <button onClick={() => confirm('Excluir?') && atualizar('funcionarios', dados.funcionarios.filter(f => f.id !== func.id))} className="text-red-600 hover:text-red-800">
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        )}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // Form Funcionário
        function FormFuncionario({ funcionario, empresas, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState(funcionario || {
                nome: '', cbo: '', cpf: '', rg: '', endereco: '', bairro: '', cidade: '', estado: '', pais: 'Brasil',
                ctps: '', pis: '', dataAdmissao: '', cargo: '', salarioBase: '', empresaId: '', tipoVinculo: 'CLT',
                status: 'Ativo', departamento: '', email: '', telefone: ''
            });
            const [erros, setErros] = useState({});

            const handleSubmit = (e) => {
                e.preventDefault();
                const novosErros = {};
                if (!formData.nome) novosErros.nome = 'Obrigatório';
                if (!formData.cpf) novosErros.cpf = 'Obrigatório';
                else if (!validarCPF(formData.cpf)) novosErros.cpf = 'CPF inválido';
                if (!formData.cargo) novosErros.cargo = 'Obrigatório';
                if (!formData.dataAdmissao) novosErros.dataAdmissao = 'Obrigatório';
                if (Object.keys(novosErros).length > 0) {
                    setErros(novosErros);
                    return;
                }
                onSalvar({ ...formData, cpf: formatarCPF(formData.cpf) });
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">{funcionario ? 'Editar' : 'Novo'} Funcionário</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div className="lg:col-span-3">
                                <label className="block mb-2 font-medium">Nome Completo *</label>
                                <input type="text" value={formData.nome} onChange={(e) => setFormData({...formData, nome: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.nome ? 'border-red-500' : ''}`} />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CPF *</label>
                                <input type="text" value={formData.cpf} onChange={(e) => setFormData({...formData, cpf: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.cpf ? 'border-red-500' : ''}`} placeholder="000.000.000-00" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">RG</label>
                                <input type="text" value={formData.rg} onChange={(e) => setFormData({...formData, rg: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CBO</label>
                                <input type="text" value={formData.cbo} onChange={(e) => setFormData({...formData, cbo: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Cargo *</label>
                                <input type="text" value={formData.cargo} onChange={(e) => setFormData({...formData, cargo: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.cargo ? 'border-red-500' : ''}`} />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Departamento</label>
                                <input type="text" value={formData.departamento} onChange={(e) => setFormData({...formData, departamento: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Tipo de Vínculo *</label>
                                <select value={formData.tipoVinculo} onChange={(e) => setFormData({...formData, tipoVinculo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="CLT">CLT</option>
                                    <option value="Terceiro">Terceiro</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Status *</label>
                                <select value={formData.status} onChange={(e) => setFormData({...formData, status: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Ativo">Ativo</option>
                                    <option value="Inativo">Inativo</option>
                                    <option value="Férias">Férias</option>
                                    <option value="Afastado">Afastado</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data de Admissão *</label>
                                <input type="date" value={formData.dataAdmissao} onChange={(e) => setFormData({...formData, dataAdmissao: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.dataAdmissao ? 'border-red-500' : ''}`} />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Salário Base</label>
                                <input type="number" step="0.01" value={formData.salarioBase} onChange={(e) => setFormData({...formData, salarioBase: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CTPS</label>
                                <input type="text" value={formData.ctps} onChange={(e) => setFormData({...formData, ctps: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">PIS</label>
                                <input type="text" value={formData.pis} onChange={(e) => setFormData({...formData, pis: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Email</label>
                                <input type="email" value={formData.email} onChange={(e) => setFormData({...formData, email: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Telefone</label>
                                <input type="tel" value={formData.telefone} onChange={(e) => setFormData({...formData, telefone: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div className="lg:col-span-2">
                                <label className="block mb-2 font-medium">Endereço</label>
                                <input type="text" value={formData.endereco} onChange={(e) => setFormData({...formData, endereco: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Bairro</label>
                                <input type="text" value={formData.bairro} onChange={(e) => setFormData({...formData, bairro: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Cidade</label>
                                <input type="text" value={formData.cidade} onChange={(e) => setFormData({...formData, cidade: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Estado</label>
                                <select value={formData.estado} onChange={(e) => setFormData({...formData, estado: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {ESTADOS_BRASILEIROS.map(est => <option key={est.sigla} value={est.sigla}>{est.sigla} - {est.nome}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">País</label>
                                <input type="text" value={formData.pais} onChange={(e) => setFormData({...formData, pais: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div className="lg:col-span-3">
                                <label className="block mb-2 font-medium">Empresa</label>
                                <select value={formData.empresaId} onChange={(e) => setFormData({...formData, empresaId: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione uma empresa</option>
                                    {empresas.map(emp => <option key={emp.id} value={emp.id}>{emp.razaoSocial} - {emp.cnpj}</option>)}
                                </select>
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // RENDIMENTOS (NOVO - Com upload de arquivo e campos manuais)
        function Rendimentos({ dados, atualizar, usuarioLogado }) {
            const [funcionarioSelecionado, setFuncionarioSelecionado] = useState('');
            const [mes, setMes] = useState(new Date().getMonth() + 1);
            const [ano, setAno] = useState(new Date().getFullYear());
            const [mostrarForm, setMostrarForm] = useState(false);

            const funcionariosFiltrados = usuarioLogado.tipo === 'admin' ? dados.funcionarios : dados.funcionarios.filter(f => f.id === usuarioLogado.id);
            const holeriteFiltrado = dados.holerites.find(h => h.funcionarioId === parseInt(funcionarioSelecionado) && h.mes === parseInt(mes) && h.ano === parseInt(ano));

            const salvarHolerite = (holerite) => {
                const existe = dados.holerites.find(h => h.funcionarioId === holerite.funcionarioId && h.mes === holerite.mes && h.ano === holerite.ano);
                if (existe) {
                    atualizar('holerites', dados.holerites.map(h => h.id === existe.id ? { ...holerite, id: existe.id } : h));
                } else {
                    atualizar('holerites', [...dados.holerites, { ...holerite, id: Date.now() }]);
                }
                setMostrarForm(false);
            };

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Rendimentos / Holerites</h2>
                    <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label className="block mb-2 font-medium">Funcionário</label>
                                <select value={funcionarioSelecionado} onChange={(e) => setFuncionarioSelecionado(e.target.value)} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {funcionariosFiltrados.map(func => <option key={func.id} value={func.id}>{func.nome}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Mês</label>
                                <select value={mes} onChange={(e) => setMes(e.target.value)} className="w-full px-4 py-2 border rounded-lg">
                                    {[...Array(12)].map((_, i) => <option key={i+1} value={i+1}>{new Date(2000, i, 1).toLocaleString('pt-BR', {month: 'long'})}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Ano</label>
                                <input type="number" value={ano} onChange={(e) => setAno(e.target.value)} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            {usuarioLogado.tipo === 'admin' && funcionarioSelecionado && (
                                <div className="flex items-end">
                                    <button onClick={() => setMostrarForm(true)} className="w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                        {holeriteFiltrado ? 'Editar' : 'Cadastrar'} Holerite
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>

                    {mostrarForm && usuarioLogado.tipo === 'admin' && (
                        <FormHolerite 
                            funcionarioId={parseInt(funcionarioSelecionado)} 
                            mes={parseInt(mes)} 
                            ano={parseInt(ano)} 
                            holerite={holeriteFiltrado}
                            onSalvar={salvarHolerite}
                            onCancelar={() => setMostrarForm(false)}
                            funcionario={dados.funcionarios.find(f => f.id === parseInt(funcionarioSelecionado))}
                            empresa={dados.empresas.find(e => e.id === dados.funcionarios.find(f => f.id === parseInt(funcionarioSelecionado))?.empresaId)}
                        />
                    )}

                    {holeriteFiltrado && !mostrarForm && (
                        <VisualizarHolerite 
                            holerite={holeriteFiltrado} 
                            funcionario={dados.funcionarios.find(f => f.id === holeriteFiltrado.funcionarioId)}
                            empresa={dados.empresas.find(e => e.id === dados.funcionarios.find(f => f.id === holeriteFiltrado.funcionarioId)?.empresaId)}
                        />
                    )}

                    {!funcionarioSelecionado && (
                        <div className="bg-white p-8 rounded-lg shadow-lg text-center text-gray-500">
                            <i className="fas fa-file-invoice-dollar text-6xl mb-4"></i>
                            <p>Selecione um funcionário e período para visualizar o holerite</p>
                        </div>
                    )}
                </div>
            );
        }

        // Form Holerite - NOVO baseado no modelo real
        function FormHolerite({ funcionarioId, mes, ano, holerite, onSalvar, onCancelar, funcionario, empresa }) {
            const fileInputRef = useRef(null);
            const [formData, setFormData] = useState(holerite || {
                funcionarioId, mes, ano,
                salarioMensalista: '',
                auxilioCombustivel: '',
                premioMotivacional: '',
                arredondamentoProvento: '',
                inss: '',
                ir: '',
                arquivoBase64: null,
                arquivoNome: null
            });

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setFormData({
                            ...formData,
                            arquivoBase64: reader.result,
                            arquivoNome: file.name
                        });
                    };
                    reader.readAsDataURL(file);
                }
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const totalProventos = parseFloat(formData.salarioMensalista || 0) + parseFloat(formData.auxilioCombustivel || 0) + 
                    parseFloat(formData.premioMotivacional || 0) + parseFloat(formData.arredondamentoProvento || 0);
                const totalDescontos = parseFloat(formData.inss || 0) + parseFloat(formData.ir || 0);
                const salarioLiquido = totalProventos - totalDescontos;

                onSalvar({
                    ...formData,
                    totalProventos,
                    totalDescontos,
                    salarioLiquido
                });
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">Cadastrar Holerite - {funcionario?.nome} - {mes}/{ano}</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                            <div className="lg:col-span-3">
                                <h4 className="font-bold text-lg mb-3 text-green-700">Proventos</h4>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Salário Mensalista</label>
                                <input type="number" step="0.01" value={formData.salarioMensalista} 
                                    onChange={(e) => setFormData({...formData, salarioMensalista: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg" placeholder="0.00" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Auxílio Combustível</label>
                                <input type="number" step="0.01" value={formData.auxilioCombustivel}
                                    onChange={(e) => setFormData({...formData, auxilioCombustivel: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg" placeholder="0.00" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Prêmio Motivacional</label>
                                <input type="number" step="0.01" value={formData.premioMotivacional}
                                    onChange={(e) => setFormData({...formData, premioMotivacional: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg" placeholder="0.00" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Arredondamento Provento Folha</label>
                                <input type="number" step="0.01" value={formData.arredondamentoProvento}
                                    onChange={(e) => setFormData({...formData, arredondamentoProvento: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg" placeholder="0.00" />
                            </div>

                            <div className="lg:col-span-3 mt-4">
                                <h4 className="font-bold text-lg mb-3 text-red-700">Descontos</h4>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">INSS</label>
                                <input type="number" step="0.01" value={formData.inss}
                                    onChange={(e) => setFormData({...formData, inss: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg" placeholder="0.00" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">IR</label>
                                <input type="number" step="0.01" value={formData.ir}
                                    onChange={(e) => setFormData({...formData, ir: e.target.value})}
                                    className="w-full px-4 py-2 border rounded-lg" placeholder="0.00" />
                            </div>

                            <div className="lg:col-span-3 mt-4">
                                <h4 className="font-bold text-lg mb-3">Arquivo do Holerite</h4>
                                <input type="file" ref={fileInputRef} onChange={handleFileUpload} accept=".pdf,.png,.jpg,.jpeg" className="hidden" />
                                <button type="button" onClick={() => fileInputRef.current.click()} 
                                    className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2">
                                    <i className="fas fa-upload"></i>
                                    {formData.arquivoNome ? `Arquivo: ${formData.arquivoNome}` : 'Anexar Arquivo (PDF/Imagem)'}
                                </button>
                            </div>
                        </div>

                        <div className="flex gap-4">
                            <button type="submit" className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                <i className="fas fa-save mr-2"></i>Salvar Holerite
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // Visualizar Holerite
        function VisualizarHolerite({ holerite, funcionario, empresa }) {
            const baixarArquivo = () => {
                if (holerite.arquivoBase64) {
                    const link = document.createElement('a');
                    link.href = holerite.arquivoBase64;
                    link.download = holerite.arquivoNome || `holerite_${funcionario?.nome}_${holerite.mes}_${holerite.ano}.pdf`;
                    link.click();
                }
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg">
                    <div className="border-b pb-4 mb-4">
                        <div className="flex justify-between items-start">
                            <div>
                                <h3 className="text-2xl font-bold">{empresa?.razaoSocial || 'Empresa'}</h3>
                                <p className="text-sm text-gray-600">{empresa?.endereco}, {empresa?.cidade}/{empresa?.estado}</p>
                                <p className="text-sm text-gray-600">CNPJ: {empresa?.cnpj}</p>
                            </div>
                            <div className="text-right">
                                <p className="text-lg font-bold">RECIBO DE PAGAMENTO DE SALÁRIO</p>
                                <p className="text-sm">Referente ao mês de {new Date(2000, holerite.mes - 1, 1).toLocaleString('pt-BR', {month: 'long'})}/{holerite.ano}</p>
                            </div>
                        </div>
                    </div>

                    <div className="mb-6 grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded">
                        <div>
                            <p className="text-sm text-gray-600">Nome do Funcionário</p>
                            <p className="font-bold">{funcionario?.nome}</p>
                        </div>
                        <div>
                            <p className="text-sm text-gray-600">CPF</p>
                            <p className="font-bold">{funcionario?.cpf}</p>
                        </div>
                        <div>
                            <p className="text-sm text-gray-600">Cargo</p>
                            <p className="font-bold">{funcionario?.cargo}</p>
                        </div>
                        <div>
                            <p className="text-sm text-gray-600">Admissão</p>
                            <p className="font-bold">{formatarData(funcionario?.dataAdmissao)}</p>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h4 className="font-bold mb-3 text-green-700">PROVENTOS</h4>
                            <div className="space-y-2">
                                <div className="flex justify-between p-2 bg-green-50 rounded">
                                    <span>Salário Mensalista</span>
                                    <span className="font-bold">{formatarMoeda(holerite.salarioMensalista)}</span>
                                </div>
                                {holerite.auxilioCombustivel > 0 && (
                                    <div className="flex justify-between p-2 bg-green-50 rounded">
                                        <span>Auxílio Combustível</span>
                                        <span className="font-bold">{formatarMoeda(holerite.auxilioCombustivel)}</span>
                                    </div>
                                )}
                                {holerite.premioMotivacional > 0 && (
                                    <div className="flex justify-between p-2 bg-green-50 rounded">
                                        <span>Prêmio Motivacional</span>
                                        <span className="font-bold">{formatarMoeda(holerite.premioMotivacional)}</span>
                                    </div>
                                )}
                                {holerite.arredondamentoProvento > 0 && (
                                    <div className="flex justify-between p-2 bg-green-50 rounded">
                                        <span>Arredondamento Provento</span>
                                        <span className="font-bold">{formatarMoeda(holerite.arredondamentoProvento)}</span>
                                    </div>
                                )}
                                <div className="flex justify-between p-2 bg-green-100 rounded font-bold">
                                    <span>Total Proventos</span>
                                    <span>{formatarMoeda(holerite.totalProventos)}</span>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h4 className="font-bold mb-3 text-red-700">DESCONTOS</h4>
                            <div className="space-y-2">
                                {holerite.inss > 0 && (
                                    <div className="flex justify-between p-2 bg-red-50 rounded">
                                        <span>I.N.S.S.</span>
                                        <span className="font-bold">{formatarMoeda(holerite.inss)}</span>
                                    </div>
                                )}
                                {holerite.ir > 0 && (
                                    <div className="flex justify-between p-2 bg-red-50 rounded">
                                        <span>I.R.</span>
                                        <span className="font-bold">{formatarMoeda(holerite.ir)}</span>
                                    </div>
                                )}
                                <div className="flex justify-between p-2 bg-red-100 rounded font-bold">
                                    <span>Total Descontos</span>
                                    <span>{formatarMoeda(holerite.totalDescontos)}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="border-t-2 pt-4">
                        <div className="flex justify-between items-center p-4 bg-blue-50 rounded">
                            <span className="text-xl font-bold">SALÁRIO LÍQUIDO</span>
                            <span className="text-3xl font-bold text-blue-700">{formatarMoeda(holerite.salarioLiquido)}</span>
                        </div>
                    </div>

                    <div className="mt-6 flex justify-end gap-4">
                        {holerite.arquivoBase64 && (
                            <button onClick={baixarArquivo} className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-download mr-2"></i>Baixar Holerite
                            </button>
                        )}
                        <button onClick={() => window.print()} className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                            <i className="fas fa-print mr-2"></i>Imprimir
                        </button>
                    </div>
                </div>
            );
        }

        // Continua no próximo bloco...
        // REGISTRO DE JORNADA - Com edição, filtros e geração de PDF
        function RegistroJornada({ dados, atualizar, usuarioLogado }) {
            const [dataRegistro, setDataRegistro] = useState(new Date().toISOString().split('T')[0]);
            const [filtros, setFiltros] = useState({ funcionarioId: '', dataInicio: '', dataFim: '', empresaId: '' });
            const [editando, setEditando] = useState(null);
            const [mostrarForm, setMostrarForm] = useState(false);

            const registrarPonto = (tipo) => {
                const agora = new Date();
                const novoRegistro = {
                    id: Date.now(),
                    funcionarioId: usuarioLogado.tipo === 'admin' ? parseInt(filtros.funcionarioId) : usuarioLogado.id,
                    tipo,
                    data: dataRegistro,
                    hora: agora.toLocaleTimeString('pt-BR'),
                    timestamp: agora.getTime()
                };
                atualizar('registrosPonto', [...dados.registrosPonto, novoRegistro]);
            };

            const salvarEdicao = (registro) => {
                atualizar('registrosPonto', dados.registrosPonto.map(r => r.id === registro.id ? registro : r));
                setEditando(null);
            };

            const excluirRegistro = (id) => {
                if (confirm('Excluir este registro?')) {
                    atualizar('registrosPonto', dados.registrosPonto.filter(r => r.id !== id));
                }
            };

            const gerarPDF = () => {
                const registrosFiltrados = filtrarRegistros();
                if (registrosFiltrados.length === 0) {
                    alert('Nenhum registro para gerar PDF');
                    return;
                }

                const funcionario = dados.funcionarios.find(f => f.id === parseInt(filtros.funcionarioId));
                const empresa = dados.empresas.find(e => e.id === funcionario?.empresaId);

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                // Cabeçalho
                doc.setFontSize(16);
                doc.text(empresa?.razaoSocial || 'Empresa', 105, 20, { align: 'center' });
                doc.setFontSize(10);
                doc.text(`CNPJ: ${empresa?.cnpj || ''}`, 105, 27, { align: 'center' });
                doc.text(`${empresa?.endereco || ''}, ${empresa?.cidade || ''}/${empresa?.estado || ''}`, 105, 32, { align: 'center' });

                doc.setFontSize(14);
                doc.text('REGISTRO DE PONTO', 105, 45, { align: 'center' });

                // Dados do funcionário
                doc.setFontSize(10);
                doc.text(`Funcionário: ${funcionario?.nome || ''}`, 20, 55);
                doc.text(`CPF: ${funcionario?.cpf || ''}`, 20, 61);
                doc.text(`Cargo: ${funcionario?.cargo || ''}`, 20, 67);
                doc.text(`Período: ${filtros.dataInicio ? formatarData(filtros.dataInicio) : ''} a ${filtros.dataFim ? formatarData(filtros.dataFim) : ''}`, 20, 73);

                // Tabela de registros
                let y = 85;
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Data', 20, y);
                doc.text('Tipo', 60, y);
                doc.text('Hora', 120, y);

                doc.setFont(undefined, 'normal');
                registrosFiltrados.forEach((reg, i) => {
                    y += 7;
                    if (y > 270) {
                        doc.addPage();
                        y = 20;
                    }
                    doc.text(formatarData(reg.data), 20, y);
                    doc.text(reg.tipo, 60, y);
                    doc.text(reg.hora, 120, y);
                });

                doc.save(`ponto_${funcionario?.nome}_${new Date().toISOString().split('T')[0]}.pdf`);
            };

            const filtrarRegistros = () => {
                let registros = dados.registrosPonto;
                if (usuarioLogado.tipo !== 'admin') {
                    registros = registros.filter(r => r.funcionarioId === usuarioLogado.id);
                } else {
                    if (filtros.funcionarioId) registros = registros.filter(r => r.funcionarioId === parseInt(filtros.funcionarioId));
                    if (filtros.dataInicio) registros = registros.filter(r => r.data >= filtros.dataInicio);
                    if (filtros.dataFim) registros = registros.filter(r => r.data <= filtros.dataFim);
                }
                return registros.sort((a, b) => b.timestamp - a.timestamp);
            };

            const registrosFiltrados = filtrarRegistros();
            const registrosHoje = registrosFiltrados.filter(r => r.data === dataRegistro);

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Registro de Jornada</h2>

                    {usuarioLogado.tipo === 'admin' && (
                        <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                            <h3 className="text-lg font-bold mb-4">Filtros</h3>
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <label className="block mb-2 font-medium">Funcionário</label>
                                    <select value={filtros.funcionarioId} onChange={(e) => setFiltros({...filtros, funcionarioId: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                        <option value="">Todos</option>
                                        {dados.funcionarios.map(func => <option key={func.id} value={func.id}>{func.nome}</option>)}
                                    </select>
                                </div>
                                <div>
                                    <label className="block mb-2 font-medium">Data Início</label>
                                    <input type="date" value={filtros.dataInicio} onChange={(e) => setFiltros({...filtros, dataInicio: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                                <div>
                                    <label className="block mb-2 font-medium">Data Fim</label>
                                    <input type="date" value={filtros.dataFim} onChange={(e) => setFiltros({...filtros, dataFim: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                                <div className="flex items-end gap-2">
                                    <button onClick={gerarPDF} className="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                                        <i className="fas fa-file-pdf mr-2"></i>Gerar PDF
                                    </button>
                                    <button onClick={() => setMostrarForm(true)} className="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">
                                        <i className="fas fa-plus mr-2"></i>Novo
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {mostrarForm && usuarioLogado.tipo === 'admin' && (
                        <FormRegistroPonto 
                            funcionarios={dados.funcionarios}
                            onSalvar={(reg) => {
                                atualizar('registrosPonto', [...dados.registrosPonto, { ...reg, id: Date.now(), timestamp: new Date().getTime() }]);
                                setMostrarForm(false);
                            }}
                            onCancelar={() => setMostrarForm(false)}
                        />
                    )}

                    {usuarioLogado.tipo !== 'admin' && (
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Registrar Ponto</h3>
                                <div className="mb-4">
                                    <label className="block mb-2 font-medium">Data</label>
                                    <input type="date" value={dataRegistro} onChange={(e) => setDataRegistro(e.target.value)} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                                <div className="grid grid-cols-2 gap-4">
                                    <button onClick={() => registrarPonto('Entrada')} className="bg-green-600 text-white px-6 py-4 rounded-lg hover:bg-green-700">
                                        <i className="fas fa-sign-in-alt text-2xl mb-2 block"></i>Entrada
                                    </button>
                                    <button onClick={() => registrarPonto('Saída Intervalo')} className="bg-yellow-600 text-white px-6 py-4 rounded-lg hover:bg-yellow-700">
                                        <i className="fas fa-utensils text-2xl mb-2 block"></i>Saída Intervalo
                                    </button>
                                    <button onClick={() => registrarPonto('Retorno Intervalo')} className="bg-blue-600 text-white px-6 py-4 rounded-lg hover:bg-blue-700">
                                        <i className="fas fa-undo text-2xl mb-2 block"></i>Retorno
                                    </button>
                                    <button onClick={() => registrarPonto('Saída')} className="bg-red-600 text-white px-6 py-4 rounded-lg hover:bg-red-700">
                                        <i className="fas fa-sign-out-alt text-2xl mb-2 block"></i>Saída
                                    </button>
                                </div>
                            </div>

                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Registros de Hoje</h3>
                                <div className="space-y-2 max-h-64 overflow-y-auto">
                                    {registrosHoje.length === 0 ? (
                                        <p className="text-gray-500 text-center py-8">Nenhum registro hoje</p>
                                    ) : (
                                        registrosHoje.map(reg => (
                                            <div key={reg.id} className="flex justify-between items-center p-3 bg-gray-50 rounded">
                                                <span className={`px-2 py-1 rounded text-xs ${
                                                    reg.tipo === 'Entrada' ? 'bg-green-100 text-green-800' :
                                                    reg.tipo === 'Saída' ? 'bg-red-100 text-red-800' :
                                                    'bg-yellow-100 text-yellow-800'
                                                }`}>{reg.tipo}</span>
                                                <span className="font-bold text-lg">{reg.hora}</span>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h3 className="text-xl font-bold mb-4">Histórico de Registros</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead className="bg-gray-50"><tr>
                                    <th className="text-left p-3">Data</th>
                                    <th className="text-left p-3">Hora</th>
                                    <th className="text-left p-3">Tipo</th>
                                    {usuarioLogado.tipo === 'admin' && <th className="text-left p-3">Funcionário</th>}
                                    {usuarioLogado.tipo === 'admin' && <th className="text-center p-3">Ações</th>}
                                </tr></thead>
                                <tbody>
                                    {registrosFiltrados.map(reg => (
                                        <tr key={reg.id} className="border-b hover:bg-gray-50">
                                            {editando?.id === reg.id ? (
                                                <>
                                                    <td className="p-3"><input type="date" value={editando.data} onChange={(e) => setEditando({...editando, data: e.target.value})} className="border rounded px-2 py-1" /></td>
                                                    <td className="p-3"><input type="time" value={editando.hora} onChange={(e) => setEditando({...editando, hora: e.target.value})} className="border rounded px-2 py-1" /></td>
                                                    <td className="p-3">
                                                        <select value={editando.tipo} onChange={(e) => setEditando({...editando, tipo: e.target.value})} className="border rounded px-2 py-1">
                                                            <option value="Entrada">Entrada</option>
                                                            <option value="Saída Intervalo">Saída Intervalo</option>
                                                            <option value="Retorno Intervalo">Retorno Intervalo</option>
                                                            <option value="Saída">Saída</option>
                                                        </select>
                                                    </td>
                                                    {usuarioLogado.tipo === 'admin' && <td className="p-3">{dados.funcionarios.find(f => f.id === reg.funcionarioId)?.nome}</td>}
                                                    <td className="p-3">
                                                        <button onClick={() => salvarEdicao(editando)} className="text-green-600 hover:text-green-800 mr-2"><i className="fas fa-check"></i></button>
                                                        <button onClick={() => setEditando(null)} className="text-gray-600 hover:text-gray-800"><i className="fas fa-times"></i></button>
                                                    </td>
                                                </>
                                            ) : (
                                                <>
                                                    <td className="p-3">{formatarData(reg.data)}</td>
                                                    <td className="p-3 font-bold">{reg.hora}</td>
                                                    <td className="p-3">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            reg.tipo === 'Entrada' ? 'bg-green-100 text-green-800' :
                                                            reg.tipo === 'Saída' ? 'bg-red-100 text-red-800' :
                                                            'bg-yellow-100 text-yellow-800'
                                                        }`}>{reg.tipo}</span>
                                                    </td>
                                                    {usuarioLogado.tipo === 'admin' && <td className="p-3">{dados.funcionarios.find(f => f.id === reg.funcionarioId)?.nome}</td>}
                                                    {usuarioLogado.tipo === 'admin' && (
                                                        <td className="p-3 text-center">
                                                            <button onClick={() => setEditando(reg)} className="text-blue-600 hover:text-blue-800 mr-2"><i className="fas fa-edit"></i></button>
                                                            <button onClick={() => excluirRegistro(reg.id)} className="text-red-600 hover:text-red-800"><i className="fas fa-trash"></i></button>
                                                        </td>
                                                    )}
                                                </>
                                            )}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        // Form Registro Ponto (admin criar registro manualmente)
        function FormRegistroPonto({ funcionarios, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState({
                funcionarioId: '',
                tipo: 'Entrada',
                data: new Date().toISOString().split('T')[0],
                hora: new Date().toTimeString().slice(0, 5)
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.funcionarioId) {
                    alert('Selecione um funcionário');
                    return;
                }
                onSalvar(formData);
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">Novo Registro de Ponto</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label className="block mb-2 font-medium">Funcionário *</label>
                                <select value={formData.funcionarioId} onChange={(e) => setFormData({...formData, funcionarioId: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {funcionarios.map(func => <option key={func.id} value={func.id}>{func.nome}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Tipo *</label>
                                <select value={formData.tipo} onChange={(e) => setFormData({...formData, tipo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Entrada">Entrada</option>
                                    <option value="Saída Intervalo">Saída Intervalo</option>
                                    <option value="Retorno Intervalo">Retorno Intervalo</option>
                                    <option value="Saída">Saída</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data *</label>
                                <input type="date" value={formData.data} onChange={(e) => setFormData({...formData, data: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Hora *</label>
                                <input type="time" value={formData.hora} onChange={(e) => setFormData({...formData, hora: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // Continua próximo bloco...
        // FÉRIAS - Com solicitações e aprovações
        function Ferias({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);

            const solicitarFerias = (solicitacao) => {
                atualizar('solicitacoesFerias', [...dados.solicitacoesFerias, { ...solicitacao, id: Date.now(), status: 'Pendente' }]);
                setMostrarForm(false);
            };

            const aprovarRejeitar = (id, novoStatus) => {
                atualizar('solicitacoesFerias', dados.solicitacoesFerias.map(s => s.id === id ? {...s, status: novoStatus} : s));
            };

            const minhasSolicitacoes = dados.solicitacoesFerias.filter(s => s.funcionarioId === usuarioLogado.id);
            const todasSolicitacoes = dados.solicitacoesFerias;

            const meusDados = dados.funcionarios.find(f => f.id === usuarioLogado.id);
            const feriasInfo = meusDados ? calcularDiasFerias(meusDados.dataAdmissao) : null;

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Gestão de Férias</h2>

                    {usuarioLogado.tipo !== 'admin' && feriasInfo && (
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-blue-500">
                                <p className="text-gray-600 mb-2">Próximo Vencimento</p>
                                <p className="text-2xl font-bold text-gray-800">{formatarData(feriasInfo.dataVencimento)}</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-green-500">
                                <p className="text-gray-600 mb-2">Meses Restantes</p>
                                <p className="text-2xl font-bold text-gray-800">{feriasInfo.mesesRestantes} meses</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-purple-500">
                                <p className="text-gray-600 mb-2">Dias de Férias</p>
                                <p className="text-2xl font-bold text-gray-800">30 dias</p>
                            </div>
                        </div>
                    )}

                    <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6">
                        <div className="flex">
                            <i className="fas fa-info-circle text-yellow-500 mt-1 mr-3"></i>
                            <div>
                                <h4 className="font-bold">Férias Coletivas</h4>
                                <p className="text-sm">15 dias em dezembro (coletivo) + 15 dias de livre escolha dentro do ano</p>
                            </div>
                        </div>
                    </div>

                    {usuarioLogado.tipo !== 'admin' && (
                        <button onClick={() => setMostrarForm(true)} className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 mb-6">
                            <i className="fas fa-plus mr-2"></i>Nova Solicitação
                        </button>
                    )}

                    {mostrarForm && (
                        <FormFerias funcionarioId={usuarioLogado.id} onSalvar={solicitarFerias} onCancelar={() => setMostrarForm(false)} />
                    )}

                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h3 className="text-xl font-bold mb-4">{usuarioLogado.tipo === 'admin' ? 'Todas as Solicitações' : 'Minhas Solicitações'}</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead className="bg-gray-50"><tr>
                                    {usuarioLogado.tipo === 'admin' && <th className="text-left p-3">Funcionário</th>}
                                    <th className="text-left p-3">Período</th>
                                    <th className="text-left p-3">Data Início</th>
                                    <th className="text-left p-3">Data Fim</th>
                                    <th className="text-left p-3">Status</th>
                                    {usuarioLogado.tipo === 'admin' && <th className="text-center p-3">Ações</th>}
                                </tr></thead>
                                <tbody>
                                    {(usuarioLogado.tipo === 'admin' ? todasSolicitacoes : minhasSolicitacoes).map(sol => {
                                        const func = dados.funcionarios.find(f => f.id === sol.funcionarioId);
                                        return (
                                            <tr key={sol.id} className="border-b hover:bg-gray-50">
                                                {usuarioLogado.tipo === 'admin' && <td className="p-3">{func?.nome}</td>}
                                                <td className="p-3">{sol.periodo}</td>
                                                <td className="p-3">{formatarData(sol.dataInicio)}</td>
                                                <td className="p-3">{formatarData(sol.dataFim)}</td>
                                                <td className="p-3">
                                                    <span className={`px-2 py-1 rounded text-xs ${
                                                        sol.status === 'Aprovado' ? 'bg-green-100 text-green-800' :
                                                        sol.status === 'Rejeitado' ? 'bg-red-100 text-red-800' :
                                                        'bg-yellow-100 text-yellow-800'
                                                    }`}>{sol.status}</span>
                                                </td>
                                                {usuarioLogado.tipo === 'admin' && sol.status === 'Pendente' && (
                                                    <td className="p-3 text-center">
                                                        <button onClick={() => aprovarRejeitar(sol.id, 'Aprovado')} className="text-green-600 hover:text-green-800 mr-2">
                                                            <i className="fas fa-check"></i>
                                                        </button>
                                                        <button onClick={() => aprovarRejeitar(sol.id, 'Rejeitado')} className="text-red-600 hover:text-red-800">
                                                            <i className="fas fa-times"></i>
                                                        </button>
                                                    </td>
                                                )}
                                                {usuarioLogado.tipo === 'admin' && sol.status !== 'Pendente' && <td className="p-3 text-center">-</td>}
                                            </tr>
                                        );
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        function FormFerias({ funcionarioId, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState({ funcionarioId, periodo: '15 dias (livre escolha)', dataInicio: '', dataFim: '', observacao: '' });
            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">Solicit ar Férias</h3>
                    <form onSubmit={(e) => { e.preventDefault(); onSalvar(formData); }}>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label className="block mb-2 font-medium">Período</label>
                                <select value={formData.periodo} onChange={(e) => setFormData({...formData, periodo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="15 dias (livre escolha)">15 dias (livre escolha)</option>
                                    <option value="30 dias">30 dias (15 coletivo + 15 livre)</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data Início</label>
                                <input type="date" value={formData.dataInicio} onChange={(e) => setFormData({...formData, dataInicio: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data Fim</label>
                                <input type="date" value={formData.dataFim} onChange={(e) => setFormData({...formData, dataFim: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Observação</label>
                                <input type="text" value={formData.observacao} onChange={(e) => setFormData({...formData, observacao: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"><i className="fas fa-paper-plane mr-2"></i>Enviar Solicitação</button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // FERIADOS - Com pontos facultativos
        function Feriados({ dados, atualizar, usuarioLogado }) {
            const [ano, setAno] = useState(new Date().getFullYear());

            const marcarPontoFacultativo = (data) => {
                const existe = dados.feriadosPontoFacultativo.find(f => f.data === data);
                if (existe) {
                    atualizar('feriadosPontoFacultativo', dados.feriadosPontoFacultativo.filter(f => f.data !== data));
                } else {
                    atualizar('feriadosPontoFacultativo', [...dados.feriadosPontoFacultativo, { data, ano, id: Date.now() }]);
                }
            };

            const hoje = new Date().toISOString().split('T')[0];
            const feriadosDoAno = Object.entries(FERIADOS_NACIONAIS_2025).filter(([data]) => data.startsWith(ano.toString()));
            const diasSemExpediente = dados.feriadosPontoFacultativo.filter(f => f.ano === ano);

            // Verificar feriados próximos (5 dias)
            const dataLimite = new Date();
            dataLimite.setDate(dataLimite.getDate() + 5);
            const feriadosProximos = diasSemExpediente.filter(f => {
                const dataFeriado = new Date(f.data);
                return dataFeriado >= new Date() && dataFeriado <= dataLimite;
            });

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Feriados e Pontos Facultativos</h2>

                    {feriadosProximos.length > 0 && (
                        <div className="bg-red-50 border-l-4 border-red-500 p-4 mb-6">
                            <div className="flex">
                                <i className="fas fa-exclamation-triangle text-red-500 mt-1 mr-3"></i>
                                <div>
                                    <h4 className="font-bold">Atenção! Dias sem expediente próximos:</h4>
                                    {feriadosProximos.map(f => (
                                        <p key={f.id} className="text-sm">{formatarData(f.data)} - Sem expediente (emenda de feriado)</p>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-white p-4 rounded-lg shadow mb-6">
                        <label className="block mb-2 font-medium">Selecionar Ano</label>
                        <select value={ano} onChange={(e) => setAno(parseInt(e.target.value))} className="px-4 py-2 border rounded-lg">
                            <option value={2024}>2024</option>
                            <option value={2025}>2025</option>
                            <option value={2026}>2026</option>
                        </select>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Feriados Nacionais {ano}</h3>
                            <div className="space-y-2">
                                {feriadosDoAno.map(([data, nome]) => (
                                    <div key={data} className="flex items-center justify-between p-3 bg-blue-50 rounded">
                                        <div>
                                            <p className="font-medium">{nome}</p>
                                            <p className="text-sm text-gray-600">{formatarData(data)}</p>
                                        </div>
                                        <i className="fas fa-calendar-day text-blue-600"></i>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Pontos Facultativos / Sem Expediente</h3>
                            {usuarioLogado.tipo === 'admin' && (
                                <div className="mb-4">
                                    <label className="block mb-2 font-medium">Marcar data sem expediente</label>
                                    <input type="date" onChange={(e) => marcarPontoFacultativo(e.target.value)} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                            )}
                            <div className="space-y-2">
                                {diasSemExpediente.length === 0 ? (
                                    <p className="text-gray-500 text-center py-4">Nenhum ponto facultativo marcado</p>
                                ) : (
                                    diasSemExpediente.map(f => (
                                        <div key={f.id} className="flex items-center justify-between p-3 bg-yellow-50 rounded">
                                            <div>
                                                <p className="font-medium">Sem expediente (emenda)</p>
                                                <p className="text-sm text-gray-600">{formatarData(f.data)}</p>
                                            </div>
                                            {usuarioLogado.tipo === 'admin' && (
                                                <button onClick={() => marcarPontoFacultativo(f.data)} className="text-red-600 hover:text-red-800">
                                                    <i className="fas fa-times"></i>
                                                </button>
                                            )}
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // AVISOS - Com marcação de lido
        function Avisos({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [filtro, setFiltro] = useState('todos');

            const marcarComoLido = (avisoId) => {
                const aviso = dados.avisos.find(a => a.id === avisoId);
                if (aviso) {
                    const lidoPor = aviso.lidoPor || [];
                    if (!lidoPor.includes(usuarioLogado.id)) {
                        atualizar('avisos', dados.avisos.map(a => a.id === avisoId ? {...a, lidoPor: [...lidoPor, usuarioLogado.id]} : a));
                    }
                }
            };

            const salvarAviso = (aviso) => {
                atualizar('avisos', [...dados.avisos, { ...aviso, id: Date.now(), data: new Date().toISOString(), autor: usuarioLogado.nome, lidoPor: [] }]);
                setMostrarForm(false);
            };

            const avisosFiltrados = dados.avisos.filter(a => {
                if (filtro === 'naoLidos') return !a.lidoPor?.includes(usuarioLogado.id);
                if (filtro === 'lidos') return a.lidoPor?.includes(usuarioLogado.id);
                return true;
            }).sort((a, b) => new Date(b.data) - new Date(a.data));

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Avisos e Comunicados</h2>
                        {usuarioLogado.tipo === 'admin' && (
                            <button onClick={() => setMostrarForm(true)} className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">
                                <i className="fas fa-plus mr-2"></i>Novo Aviso
                            </button>
                        )}
                    </div>

                    <div className="bg-white p-4 rounded-lg shadow mb-4">
                        <select value={filtro} onChange={(e) => setFiltro(e.target.value)} className="px-4 py-2 border rounded-lg">
                            <option value="todos">Todos os Avisos</option>
                            <option value="naoLidos">Não Lidos</option>
                            <option value="lidos">Lidos</option>
                        </select>
                    </div>

                    {mostrarForm && (
                        <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                            <h3 className="text-xl font-bold mb-4">Criar Novo Aviso</h3>
                            <form onSubmit={(e) => {
                                e.preventDefault();
                                const formData = new FormData(e.target);
                                salvarAviso({ titulo: formData.get('titulo'), tipo: formData.get('tipo'), conteudo: formData.get('conteudo') });
                            }}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block mb-2 font-medium">Título</label>
                                        <input type="text" name="titulo" className="w-full px-4 py-2 border rounded-lg" required />
                                    </div>
                                    <div>
                                        <label className="block mb-2 font-medium">Tipo</label>
                                        <select name="tipo" className="w-full px-4 py-2 border rounded-lg">
                                            <option value="info">Informação</option>
                                            <option value="warning">Atenção</option>
                                            <option value="success">Sucesso</option>
                                            <option value="error">Urgente</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block mb-2 font-medium">Conteúdo</label>
                                        <textarea name="conteudo" className="w-full px-4 py-2 border rounded-lg h-32" required></textarea>
                                    </div>
                                    <div className="flex gap-4">
                                        <button type="submit" className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">Publicar</button>
                                        <button type="button" onClick={() => setMostrarForm(false)} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    )}

                    <div className="space-y-4">
                        {avisosFiltrados.length === 0 ? (
                            <div className="bg-white p-8 rounded-lg shadow-lg text-center text-gray-500">
                                <i className="fas fa-inbox text-6xl mb-4"></i>
                                <p>Nenhum aviso {filtro === 'naoLidos' ? 'não lido' : filtro === 'lidos' ? 'lido' : ''}</p>
                            </div>
                        ) : (
                            avisosFiltrados.map(aviso => {
                                const lido = aviso.lidoPor?.includes(usuarioLogado.id);
                                return (
                                    <div key={aviso.id} className={`bg-white p-6 rounded-lg shadow-lg border-l-4 ${
                                        aviso.tipo === 'info' ? 'border-blue-500' :
                                        aviso.tipo === 'warning' ? 'border-yellow-500' :
                                        aviso.tipo === 'success' ? 'border-green-500' :
                                        'border-red-500'
                                    } ${!lido ? 'bg-blue-50' : ''}`}>
                                        <div className="flex justify-between items-start mb-3">
                                            <div className="flex-1">
                                                <div className="flex items-center gap-2">
                                                    <h3 className="text-xl font-bold">{aviso.titulo}</h3>
                                                    {!lido && <span className="bg-red-500 text-white text-xs px-2 py-1 rounded">NOVO</span>}
                                                </div>
                                                <p className="text-sm text-gray-500">{aviso.autor} • {new Date(aviso.data).toLocaleDateString('pt-BR')}</p>
                                            </div>
                                            <div className="flex gap-2">
                                                {!lido && usuarioLogado.tipo !== 'admin' && (
                                                    <button onClick={() => marcarComoLido(aviso.id)} className="text-green-600 hover:text-green-800">
                                                        <i className="fas fa-check-circle"></i> Marcar como Lido
                                                    </button>
                                                )}
                                                {usuarioLogado.tipo === 'admin' && (
                                                    <button onClick={() => atualizar('avisos', dados.avisos.filter(a => a.id !== aviso.id))} className="text-red-600 hover:text-red-800">
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                        <p className="text-gray-700">{aviso.conteudo}</p>
                                    </div>
                                );
                            })
                        )}
                    </div>
                </div>
            );
        }

        // DOCUMENTOS - Upload e visualização
        function Documentos({ dados, atualizar, usuarioLogado }) {
            const fileInputRef = useRef(null);
            const [uploadando, setUploadando] = useState(false);

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    setUploadando(true);
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        const novoDoc = {
                            id: Date.now(),
                            funcionarioId: usuarioLogado.tipo === 'admin' ? null : usuarioLogado.id,
                            nome: file.name,
                            tipo: file.type,
                            tamanho: file.size,
                            data: new Date().toISOString(),
                            arquivo: reader.result
                        };
                        atualizar('documentos', [...dados.documentos, novoDoc]);
                        setUploadando(false);
                        e.target.value = '';
                    };
                    reader.readAsDataURL(file);
                }
            };

            const baixarDocumento = (doc) => {
                const link = document.createElement('a');
                link.href = doc.arquivo;
                link.download = doc.nome;
                link.click();
            };

            const meusDocumentos = dados.documentos.filter(d => d.funcionarioId === usuarioLogado.id || d.funcionarioId === null);

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Documentos</h2>
                        <div>
                            <input type="file" ref={fileInputRef} onChange={handleFileUpload} className="hidden" />
                            <button onClick={() => fileInputRef.current.click()} 
                                className="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700"
                                disabled={uploadando}>
                                <i className="fas fa-upload mr-2"></i>{uploadando ? 'Enviando...' : 'Enviar Documento'}
                            </button>
                        </div>
                    </div>

                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h3 className="text-xl font-bold mb-4">Meus Documentos</h3>
                        {meusDocumentos.length === 0 ? (
                            <div className="text-center py-8 text-gray-500">
                                <i className="fas fa-folder-open text-6xl mb-4"></i>
                                <p>Nenhum documento enviado</p>
                            </div>
                        ) : (
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {meusDocumentos.map(doc => (
                                    <div key={doc.id} className="border rounded-lg p-4 hover:shadow-md transition">
                                        <div className="flex items-center mb-2">
                                            <i className={`fas fa-${
                                                doc.tipo.includes('pdf') ? 'file-pdf text-red-500' :
                                                doc.tipo.includes('image') ? 'file-image text-blue-500' :
                                                doc.tipo.includes('word') ? 'file-word text-blue-700' :
                                                'file text-gray-500'
                                            } text-3xl mr-3`}></i>
                                            <div className="flex-1 min-w-0">
                                                <p className="font-medium truncate">{doc.nome}</p>
                                                <p className="text-xs text-gray-500">{(doc.tamanho / 1024).toFixed(2)} KB</p>
                                                <p className="text-xs text-gray-500">{new Date(doc.data).toLocaleDateString('pt-BR')}</p>
                                            </div>
                                        </div>
                                        <div className="flex gap-2">
                                            <button onClick={() => baixarDocumento(doc)} className="flex-1 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700">
                                                <i className="fas fa-download mr-1"></i>Baixar
                                            </button>
                                            <button onClick={() => atualizar('documentos', dados.documentos.filter(d => d.id !== doc.id))} className="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700">
                                                <i className="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // INFORMAÇÕES
        function Informacoes() {
            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Informações do Sistema</h2>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4 flex items-center">
                                <i className="fas fa-info-circle text-blue-600 mr-2"></i>Sobre o Sistema
                            </h3>
                            <div className="space-y-3 text-gray-700">
                                <p><strong>Nome:</strong> Sistema de Gestão de Funcionários</p>
                                <p><strong>Versão:</strong> 2.0.0</p>
                                <p><strong>Última Atualização:</strong> Dezembro 2024</p>
                                <p><strong>Funcionalidades:</strong></p>
                                <ul className="list-disc pl-6 space-y-1 text-sm">
                                    <li>Cadastro de Empresas e Funcionários</li>
                                    <li>Gestão de Holerites com Upload</li>
                                    <li>Registro de Ponto Eletrônico</li>
                                    <li>Gestão de Férias</li>
                                    <li>Controle de Feriados</li>
                                    <li>Sistema de Avisos</li>
                                    <li>Gerenciamento de Documentos</li>
                                </ul>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4 flex items-center">
                                <i className="fas fa-headset text-green-600 mr-2"></i>Suporte
                            </h3>
                            <div className="space-y-3 text-gray-700">
                                <p><strong>Email:</strong> suporte@empresa.com.br</p>
                                <p><strong>Telefone:</strong> (67) 3333-4444</p>
                                <p><strong>Horário:</strong> Segunda a Sexta, 8h às 18h</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Renderizar aplicação
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
