<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o de Funcion√°rios - InstaSolutions</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script>
        // Configura√ß√£o do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDKf9setpNeq7R1oxLHbDmoEOOk63lCyvw",
            authDomain: "sistema-rh-instasolutions.firebaseapp.com",
            projectId: "sistema-rh-instasolutions",
            storageBucket: "sistema-rh-instasolutions.firebasestorage.app",
            messagingSenderId: "753715004038",
            appId: "1:753715004038:web:d6645e27b1d6f78b65c707",
            measurementId: "G-7BV46ML4Y4"
        };
        
        // Inicializa Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3B82F6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1E2A5E'
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        :root {
            --color-primary: #3B82F6;
            --color-primary-dark: #1E2A5E;
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3B82F6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Estados brasileiros completos
        const ESTADOS_BRASILEIROS = [
            { sigla: 'AC', nome: 'Acre' },
            { sigla: 'AL', nome: 'Alagoas' },
            { sigla: 'AP', nome: 'Amap√°' },
            { sigla: 'AM', nome: 'Amazonas' },
            { sigla: 'BA', nome: 'Bahia' },
            { sigla: 'CE', nome: 'Cear√°' },
            { sigla: 'DF', nome: 'Distrito Federal' },
            { sigla: 'ES', nome: 'Esp√≠rito Santo' },
            { sigla: 'GO', nome: 'Goi√°s' },
            { sigla: 'MA', nome: 'Maranh√£o' },
            { sigla: 'MT', nome: 'Mato Grosso' },
            { sigla: 'MS', nome: 'Mato Grosso do Sul' },
            { sigla: 'MG', nome: 'Minas Gerais' },
            { sigla: 'PA', nome: 'Par√°' },
            { sigla: 'PB', nome: 'Para√≠ba' },
            { sigla: 'PR', nome: 'Paran√°' },
            { sigla: 'PE', nome: 'Pernambuco' },
            { sigla: 'PI', nome: 'Piau√≠' },
            { sigla: 'RJ', nome: 'Rio de Janeiro' },
            { sigla: 'RN', nome: 'Rio Grande do Norte' },
            { sigla: 'RS', nome: 'Rio Grande do Sul' },
            { sigla: 'RO', nome: 'Rond√¥nia' },
            { sigla: 'RR', nome: 'Roraima' },
            { sigla: 'SC', nome: 'Santa Catarina' },
            { sigla: 'SP', nome: 'S√£o Paulo' },
            { sigla: 'SE', nome: 'Sergipe' },
            { sigla: 'TO', nome: 'Tocantins' }
        ];

        // Feriados nacionais
        const FERIADOS_NACIONAIS_2025 = {
            '2025-01-01': 'Confraterniza√ß√£o Universal',
            '2025-03-03': 'Carnaval',
            '2025-03-04': 'Carnaval',
            '2025-04-18': 'Sexta-feira Santa',
            '2025-04-21': 'Tiradentes',
            '2025-05-01': 'Dia do Trabalho',
            '2025-06-19': 'Corpus Christi',
            '2025-09-07': 'Independ√™ncia do Brasil',
            '2025-10-12': 'Nossa Senhora Aparecida',
            '2025-11-02': 'Finados',
            '2025-11-15': 'Proclama√ß√£o da Rep√∫blica',
            '2025-11-20': 'Consci√™ncia Negra',
            '2025-12-25': 'Natal'
        };

        const FERIADOS_NACIONAIS_2026 = {
            '2026-01-01': 'Confraterniza√ß√£o Universal',
            '2026-02-16': 'Carnaval',
            '2026-02-17': 'Carnaval',
            '2026-04-03': 'Sexta-feira Santa',
            '2026-04-21': 'Tiradentes',
            '2026-05-01': 'Dia do Trabalho',
            '2026-06-04': 'Corpus Christi',
            '2026-09-07': 'Independ√™ncia do Brasil',
            '2026-10-12': 'Nossa Senhora Aparecida',
            '2026-11-02': 'Finados',
            '2026-11-15': 'Proclama√ß√£o da Rep√∫blica',
            '2026-11-20': 'Consci√™ncia Negra',
            '2026-12-25': 'Natal'
        };

        // Tipos de documentos
        const TIPOS_DOCUMENTOS = [
            { id: 'cpf_rg_cnh', nome: 'CPF / RG / CNH', icon: 'id-card', cor: 'blue' },
            { id: 'comprovante_endereco', nome: 'Comprovante de Endere√ßo', icon: 'home', cor: 'green' },
            { id: 'carteira_trabalho', nome: 'Carteira de Trabalho', icon: 'briefcase', cor: 'purple' },
            { id: 'pis', nome: 'PIS', icon: 'file-alt', cor: 'orange' },
            { id: 'certidao_casamento', nome: 'Certid√£o de Casamento', icon: 'heart', cor: 'pink' },
            { id: 'certidao_nascimento', nome: 'Certid√£o de Nascimento', icon: 'baby', cor: 'cyan' },
            { id: 'foto', nome: 'Foto do Funcion√°rio', icon: 'camera', cor: 'indigo' },
            { id: 'outros', nome: 'Outros Documentos', icon: 'folder', cor: 'gray' }
        ];

        // Componente Logo InstaSolutions
        function LogoInstaSolutions({ size = 'md', showText = true, textColor = 'dark', variant = 'vertical' }) {
            const sizes = {
                sm: { width: 32, height: 32 },
                md: { width: 48, height: 48 },
                lg: { width: 120, height: 100 },
                xl: { width: 180, height: 150 }
            };
            const s = sizes[size] || sizes.md;
            
            // Variantes de logo dispon√≠veis
            const logos = {
                vertical: 'assets/InstaSolutions-LockupVertical-Cores.png',
                horizontal: 'assets/InstaSolutions-LockupAlternativo-Cores (1).jpg',
                symbol: 'assets/InstaSolutions-S√≠mbolo-Cores.jpg'
            };
            
            return (
                <div className="flex items-center justify-center">
                    <img 
                        src={logos[variant] || logos.vertical} 
                        alt="InstaSolutions" 
                        style={{ width: s.width, height: 'auto', maxHeight: s.height * 1.5 }}
                        className="object-contain"
                    />
                </div>
            );
        }

        // Fun√ß√µes auxiliares
        const validarCPF = (cpf) => {
            cpf = cpf.replace(/[^\d]/g, '');
            if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;
            let soma = 0;
            for (let i = 0; i < 9; i++) soma += parseInt(cpf.charAt(i)) * (10 - i);
            let resto = (soma * 10) % 11;
            if (resto === 10 || resto === 11) resto = 0;
            if (resto !== parseInt(cpf.charAt(9))) return false;
            soma = 0;
            for (let i = 0; i < 10; i++) soma += parseInt(cpf.charAt(i)) * (11 - i);
            resto = (soma * 10) % 11;
            if (resto === 10 || resto === 11) resto = 0;
            return resto === parseInt(cpf.charAt(10));
        };

        const validarCNPJ = (cnpj) => {
            cnpj = cnpj.replace(/[^\d]/g, '');
            if (cnpj.length !== 14 || /^(\d)\1+$/.test(cnpj)) return false;
            let tamanho = 12, numeros = cnpj.substring(0, tamanho), digitos = cnpj.substring(tamanho);
            let soma = 0, pos = tamanho - 7;
            for (let i = tamanho; i >= 1; i--) {
                soma += numeros.charAt(tamanho - i) * pos--;
                if (pos < 2) pos = 9;
            }
            let resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
            if (resultado !== parseInt(digitos.charAt(0))) return false;
            tamanho = 13;
            numeros = cnpj.substring(0, tamanho);
            soma = 0;
            pos = tamanho - 7;
            for (let i = tamanho; i >= 1; i--) {
                soma += numeros.charAt(tamanho - i) * pos--;
                if (pos < 2) pos = 9;
            }
            resultado = soma % 11 < 2 ? 0 : 11 - soma % 11;
            return resultado === parseInt(digitos.charAt(1));
        };

        const formatarCPF = (cpf) => cpf.replace(/[^\d]/g, '').replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
        const formatarCNPJ = (cnpj) => cnpj.replace(/[^\d]/g, '').replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/, '$1.$2.$3/$4-$5');
        const formatarMoeda = (valor) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valor || 0);
        const formatarData = (data) => data ? new Date(data + 'T00:00:00').toLocaleDateString('pt-BR') : '';

        // Fun√ß√µes para formata√ß√£o de moeda em inputs
        const formatarMoedaInput = (valor) => {
            if (!valor) return '';
            const numero = String(valor).replace(/\D/g, '');
            if (!numero) return '';
            const valorNumerico = parseInt(numero) / 100;
            return valorNumerico.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        };

        const parseMoedaInput = (valor) => {
            if (!valor) return 0;
            const limpo = String(valor).replace(/\./g, '').replace(',', '.');
            return parseFloat(limpo) || 0;
        };

        // Componente de Input de Moeda
        function InputMoeda({ value, onChange, placeholder, className }) {
            const [displayValue, setDisplayValue] = useState('');

            useEffect(() => {
                if (value !== undefined && value !== null && value !== '') {
                    const valorNumerico = parseFloat(value) || 0;
                    if (valorNumerico > 0) {
                        setDisplayValue(valorNumerico.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 }));
                    }
                }
            }, []);

            const handleChange = (e) => {
                let inputValue = e.target.value;
                // Remove tudo exceto n√∫meros
                const apenasNumeros = inputValue.replace(/\D/g, '');
                if (!apenasNumeros) {
                    setDisplayValue('');
                    onChange(0);
                    return;
                }
                // Converte para valor decimal (divide por 100)
                const valorNumerico = parseInt(apenasNumeros) / 100;
                // Formata para exibi√ß√£o
                const valorFormatado = valorNumerico.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                setDisplayValue(valorFormatado);
                onChange(valorNumerico);
            };

            return (
                <div className="relative">
                    <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">R$</span>
                    <input
                        type="text"
                        value={displayValue}
                        onChange={handleChange}
                        placeholder={placeholder || '0,00'}
                        className={`${className} pl-10`}
                    />
                </div>
            );
        }

        const calcularDiasFerias = (dataAdmissao) => {
            const hoje = new Date();
            const admissao = new Date(dataAdmissao);
            const diffTime = Math.abs(hoje - admissao);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            const mesesTrabalhados = Math.floor(diffDays / 30);
            const periodoAquisitivo = Math.floor(mesesTrabalhados / 12);
            const mesesRestantes = 12 - (mesesTrabalhados % 12);
            const dataVencimento = new Date(admissao);
            dataVencimento.setMonth(dataVencimento.getMonth() + ((periodoAquisitivo + 1) * 12));
            
            return {
                periodoAquisitivo,
                mesesRestantes,
                dataVencimento: dataVencimento.toISOString().split('T')[0],
                diasFerias: 30
            };
        };

        // Sistema de armazenamento Firebase Firestore
        const FirebaseStorage = {
            // Salva dados em uma cole√ß√£o do Firestore
            saveCollection: async (collection, data) => {
                try {
                    const docRef = db.collection('sistemaRH').doc(collection);
                    await docRef.set({ data, updatedAt: firebase.firestore.FieldValue.serverTimestamp() });
                    return true;
                } catch (e) {
                    console.error('Erro ao salvar no Firebase:', e);
                    return false;
                }
            },
            // Carrega dados de uma cole√ß√£o do Firestore
            loadCollection: async (collection, defaultValue = null) => {
                try {
                    const docRef = db.collection('sistemaRH').doc(collection);
                    const doc = await docRef.get();
                    if (doc.exists) {
                        return doc.data().data || defaultValue;
                    }
                    return defaultValue;
                } catch (e) {
                    console.error('Erro ao carregar do Firebase:', e);
                    return defaultValue;
                }
            },
            // Salva todos os dados do sistema
            saveAll: async (dados) => {
                try {
                    const docRef = db.collection('sistemaRH').doc('dados');
                    await docRef.set({ 
                        ...dados, 
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp() 
                    });
                    return true;
                } catch (e) {
                    console.error('Erro ao salvar dados:', e);
                    return false;
                }
            },
            // Carrega todos os dados do sistema
            loadAll: async (defaultValue) => {
                try {
                    const docRef = db.collection('sistemaRH').doc('dados');
                    const doc = await docRef.get();
                    if (doc.exists) {
                        const data = doc.data();
                        delete data.updatedAt;
                        return data;
                    }
                    return defaultValue;
                } catch (e) {
                    console.error('Erro ao carregar dados:', e);
                    return defaultValue;
                }
            }
        };

        // Sistema de armazenamento local (fallback)
        const Storage = {
            save: (key, data) => {
                try {
                    // Cria backup antes de salvar
                    this.createBackup(key, data);
                    localStorage.setItem(key, JSON.stringify(data));
                    return true;
                } catch (e) {
                    console.error('Erro ao salvar:', e);
                    return false;
                }
            },
            load: (key, defaultValue = null) => {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : defaultValue;
                } catch (e) {
                    console.error('Erro ao carregar:', e);
                    return defaultValue;
                }
            },
            createBackup: (key, data) => {
                try {
                    const timestamp = new Date().toISOString();
                    const backupKey = `${key}_backup_${timestamp}`;
                    localStorage.setItem(backupKey, JSON.stringify(data));
                    
                    // Mant√©m apenas os √∫ltimos 10 backups
                    const backups = Object.keys(localStorage).filter(k => k.startsWith(`${key}_backup_`));
                    if (backups.length > 10) {
                        backups.sort().slice(0, backups.length - 10).forEach(k => localStorage.removeItem(k));
                    }
                } catch (e) {
                    console.warn('Erro ao criar backup:', e);
                }
            },
            listBackups: (key) => {
                try {
                    return Object.keys(localStorage)
                        .filter(k => k.startsWith(`${key}_backup_`))
                        .sort()
                        .reverse()
                        .map(k => ({
                            key: k,
                            timestamp: k.replace(`${key}_backup_`, ''),
                            data: JSON.parse(localStorage.getItem(k))
                        }));
                } catch (e) {
                    console.error('Erro ao listar backups:', e);
                    return [];
                }
            },
            restoreBackup: (backupKey) => {
                try {
                    const data = localStorage.getItem(backupKey);
                    return data ? JSON.parse(data) : null;
                } catch (e) {
                    console.error('Erro ao restaurar backup:', e);
                    return null;
                }
            }
        };

        // Componente Principal
        function App() {
            const [usuarioLogado, setUsuarioLogado] = useState(() => {
                // Recupera sess√£o salva ao carregar
                return Storage.load('sistemaRH_sessao', null);
            });
            const [paginaAtual, setPaginaAtual] = useState('dashboard');
            const [carregando, setCarregando] = useState(true);
            const [dados, setDados] = useState({
                empresas: [],
                funcionarios: [],
                avisos: [],
                registrosPonto: [],
                holerites: [],
                solicitacoesFerias: [],
                historicoFerias: [],
                feriadosPontoFacultativo: [],
                documentos: [],
                planosSaude: []
            });

            // Salva sess√£o quando usu√°rio faz login/logout
            const handleLogin = (usuario) => {
                setUsuarioLogado(usuario);
                Storage.save('sistemaRH_sessao', usuario);

                // Se for primeiro acesso do funcion√°rio, for√ßa defini√ß√£o de senha
                if (usuario?.tipo === 'funcionario' && usuario?.precisaDefinirSenha) {
                    setPaginaAtual('definir-senha');
                } else {
                    setPaginaAtual('dashboard');
                }
            };

            const handleLogout = () => {
                setUsuarioLogado(null);
                Storage.save('sistemaRH_sessao', null);
            };

            // Carrega dados do Firebase ao iniciar
            useEffect(() => {
                const carregarDados = async () => {
                    setCarregando(true);
                    try {
                        // Primeiro tenta carregar do localStorage (mais r√°pido)
                        const dadosLocal = Storage.load('sistemaRH_v2', null);
                        console.log('üìÇ Dados do localStorage:', dadosLocal ? 'Encontrados' : 'N√£o encontrados');
                        
                        const dadosFirebase = await FirebaseStorage.loadAll({
                            empresas: [],
                            funcionarios: [],
                            avisos: [],
                            registrosPonto: [],
                            holerites: [],
                            solicitacoesFerias: [],
                            historicoFerias: [],
                            feriadosPontoFacultativo: [],
                            documentos: [],
                            planosSaude: []
                        });
                        
                        console.log('‚òÅÔ∏è Dados do Firebase:', dadosFirebase);
                        
                        // Verifica se Firebase tem dados v√°lidos
                        const firebaseTemDados = dadosFirebase && 
                            typeof dadosFirebase === 'object' && 
                            (dadosFirebase.funcionarios?.length > 0 || 
                             dadosFirebase.empresas?.length > 0 ||
                             dadosFirebase.holerites?.length > 0);
                        
                        // Verifica se localStorage tem dados
                        const localTemDados = dadosLocal &&
                            typeof dadosLocal === 'object' &&
                            (dadosLocal.funcionarios?.length > 0 || 
                             dadosLocal.empresas?.length > 0 ||
                             dadosLocal.holerites?.length > 0);
                        
                        console.log('üîç Firebase tem dados:', firebaseTemDados);
                        console.log('üîç Local tem dados:', localTemDados);
                        
                        // Decide qual fonte usar
                        let dadosParaCarregar;
                        
                        if (firebaseTemDados) {
                            console.log('‚úÖ Usando dados do Firebase');
                            dadosParaCarregar = dadosFirebase;
                        } else if (localTemDados) {
                            console.log('‚ö†Ô∏è Firebase vazio, usando dados do localStorage');
                            dadosParaCarregar = dadosLocal;
                            // Sincroniza dados locais para o Firebase
                            FirebaseStorage.saveAll(dadosLocal);
                        } else {
                            console.log('üì≠ Nenhum dado encontrado, iniciando vazio');
                            dadosParaCarregar = dadosFirebase;
                        }
                        
                        setDados(dadosParaCarregar);
                        // Salva no localStorage como backup
                        Storage.save('sistemaRH_v2', dadosParaCarregar);
                        
                    } catch (error) {
                        console.error('‚ùå Erro ao carregar dados do Firebase:', error);
                        // Fallback para localStorage se Firebase falhar
                        const dadosSalvos = Storage.load('sistemaRH_v2', {
                            empresas: [],
                            funcionarios: [],
                            avisos: [],
                            registrosPonto: [],
                            holerites: [],
                            solicitacoesFerias: [],
                            historicoFerias: [],
                            feriadosPontoFacultativo: [],
                            documentos: [],
                            planosSaude: []
                        });
                        setDados(dadosSalvos);
                    }
                    setCarregando(false);
                };
                carregarDados();
            }, []);

            // Salva dados no Firebase quando alterados
            useEffect(() => {
                if (usuarioLogado && !carregando) {
                    // Adiciona debounce para n√£o salvar excessivamente
                    const timeoutId = setTimeout(() => {
                        FirebaseStorage.saveAll(dados)
                            .then(() => {
                                // Mant√©m backup local tamb√©m
                                Storage.save('sistemaRH_v2', dados);
                                console.log('Dados salvos com sucesso:', new Date().toISOString());
                            })
                            .catch(error => {
                                console.error('Erro ao salvar dados:', error);
                                // Salva no localStorage como fallback
                                Storage.save('sistemaRH_v2', dados);
                            });
                    }, 1000); // Aguarda 1 segundo antes de salvar

                    return () => clearTimeout(timeoutId);
                }
            }, [dados, usuarioLogado, carregando]);

            const atualizarDados = (campo, valor) => {
                setDados(prev => ({ ...prev, [campo]: valor }));
            };

            const avisosNaoLidos = dados.avisos.filter(a => 
                !a.lidoPor?.includes(usuarioLogado?.id)
            ).length;

            // Tela de carregamento enquanto busca dados do Firebase
            if (carregando) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-primary-900 via-primary-800 to-primary-700 flex items-center justify-center">
                        <div className="text-center">
                            <div className="loading-spinner mx-auto mb-4"></div>
                            <p className="text-white text-lg">Carregando dados...</p>
                            <p className="text-primary-200 text-sm mt-2">Sistema RH - InstaSolutions</p>
                        </div>
                    </div>
                );
            }

            if (!usuarioLogado) {
                return <Login onLogin={handleLogin} funcionarios={dados.funcionarios} />;
            }

            // For√ßa o funcion√°rio a definir senha pessoal no primeiro acesso
            const funcionarioLogado = usuarioLogado.tipo === 'funcionario'
                ? dados.funcionarios.find(f => f.id === usuarioLogado.id)
                : null;

            const precisaDefinirSenha = usuarioLogado.tipo === 'funcionario'
                && funcionarioLogado
                && funcionarioLogado.senhaPersonalizada !== true;

            if (precisaDefinirSenha) {
                return (
                    <DefinirSenhaPrimeiroAcesso
                        usuarioLogado={usuarioLogado}
                        funcionario={funcionarioLogado}
                        atualizar={atualizarDados}
                        dados={dados}
                        onLogout={handleLogout}
                        onDone={() => setPaginaAtual('dashboard')}
                    />
                );
            }

            return (
                <div className="flex h-screen bg-gray-100">
                    <Sidebar 
                        usuario={usuarioLogado} 
                        paginaAtual={paginaAtual}
                        setPagina={setPaginaAtual}
                        onLogout={handleLogout}
                        avisosNaoLidos={avisosNaoLidos}
                    />
                    <div className="flex-1 overflow-auto">
                        <Header usuario={usuarioLogado} />
                        <main className="p-6">
                            {paginaAtual === 'dashboard' && (
                                <Dashboard dados={dados} usuarioLogado={usuarioLogado} onNavigate={setPaginaAtual} />
                            )}
                            {paginaAtual === 'empresas' && (
                                <GestaoEmpresas dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'funcionarios' && (
                                <GestaoFuncionarios dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'rendimentos' && (
                                <Rendimentos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'jornada' && (
                                <RegistroJornada dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'ferias' && (
                                <Ferias dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'feriados' && (
                                <Feriados dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'avisos' && (
                                <Avisos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'documentos' && (
                                <Documentos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'plano-saude' && (
                                <PlanoSaude dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                            {paginaAtual === 'recuperacao' && usuarioLogado.tipo === 'admin' && (
                                <RecuperacaoDados dados={dados} setDados={setDados} />
                            )}
                            {paginaAtual === 'informacoes' && (
                                <Informacoes />
                            )}
                            {paginaAtual === 'acessos' && (
                                <GestaoAcessos dados={dados} atualizar={atualizarDados} usuarioLogado={usuarioLogado} />
                            )}
                        </main>
                    </div>
                </div>
            );
        }

        // Login
        function Login({ onLogin, funcionarios }) {
            const [usuario, setUsuario] = useState('');
            const [senha, setSenha] = useState('');
            const [erro, setErro] = useState('');

            const handleLogin = (e) => {
                e.preventDefault();
                setErro('');
                
                // Login Admin
                if (usuario === 'admin' && senha === 'admin123') {
                    onLogin({ nome: 'Administrador', tipo: 'admin', id: 'admin' });
                    return;
                }
                
                // Login com funcion√°rio cadastrado
                const cpfLimpo = usuario.replace(/[^\d]/g, '');
                const func = funcionarios.find(f => f.cpf?.replace(/[^\d]/g, '') === cpfLimpo);
                
                if (func) {
                    // Verifica se o acesso est√° bloqueado
                    if (func.acessoAtivo === false) {
                        setErro('Seu acesso est√° bloqueado. Contate o RH.');
                        return;
                    }
                    
                    // Verifica senha (personalizada ou CPF)
                    const senhaCorreta = func.senhaPersonalizada ? func.senha : cpfLimpo;
                    
                    if (senha === senhaCorreta) {
                        onLogin({ 
                            nome: func.nome, 
                            tipo: 'funcionario', 
                            id: func.id, 
                            cpf: func.cpf,
                            precisaDefinirSenha: func.senhaPersonalizada !== true
                        });
                        return;
                    }
                }
                
                setErro('Usu√°rio ou senha inv√°lidos.');
            };

            return (
                <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-primary-500 to-primary-900">
                    <div className="bg-white p-8 rounded-lg shadow-2xl w-96">
                        <div className="text-center mb-8">
                            <LogoInstaSolutions size="xl" variant="vertical" />
                            <p className="text-gray-600 mt-3">Sistema de Gest√£o de RH</p>
                        </div>
                        <form onSubmit={handleLogin}>
                            <div className="mb-4">
                                <label className="block text-gray-700 mb-2">Usu√°rio / CPF</label>
                                <input type="text" value={usuario} onChange={(e) => setUsuario(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    placeholder="Digite admin ou CPF" />
                            </div>
                            <div className="mb-6">
                                <label className="block text-gray-700 mb-2">Senha</label>
                                <input type="password" value={senha} onChange={(e) => setSenha(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    placeholder="Digite sua senha" />
                            </div>
                            {erro && <div className="mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm">{erro}</div>}
                            <button type="submit" className="w-full bg-primary-500 text-white py-2 rounded-lg hover:bg-primary-600 transition">
                                Entrar
                            </button>
                        </form>
                        
                        <div className="mt-6 p-4 bg-gray-50 rounded-lg text-center">
                            <p className="text-sm text-gray-600">
                                <i className="fas fa-info-circle mr-2"></i>
                                Primeiro acesso: use seu CPF como usu√°rio e senha. Depois, defina uma senha pessoal.
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        // Primeiro acesso - funcion√°rio deve definir senha pessoal
        function DefinirSenhaPrimeiroAcesso({ usuarioLogado, funcionario, dados, atualizar, onLogout, onDone }) {
            const [senha, setSenha] = useState('');
            const [confirmarSenha, setConfirmarSenha] = useState('');
            const [erro, setErro] = useState('');
            const [salvando, setSalvando] = useState(false);

            const cpfLimpo = (funcionario?.cpf || usuarioLogado?.cpf || '').replace(/\D/g, '');

            const salvar = async (e) => {
                e.preventDefault();
                setErro('');

                const senhaTrim = senha.trim();
                if (senhaTrim.length < 4) {
                    setErro('A senha deve ter no m√≠nimo 4 caracteres.');
                    return;
                }
                if (senhaTrim !== confirmarSenha.trim()) {
                    setErro('As senhas n√£o conferem.');
                    return;
                }
                if (cpfLimpo && senhaTrim.replace(/\D/g, '') === cpfLimpo) {
                    setErro('A senha pessoal n√£o pode ser igual ao CPF.');
                    return;
                }

                setSalvando(true);
                try {
                    atualizar('funcionarios', (dados.funcionarios || []).map(f =>
                        f.id === usuarioLogado.id
                            ? { ...f, senhaPersonalizada: true, senha: senhaTrim }
                            : f
                    ));
                    onDone && onDone();
                } finally {
                    setSalvando(false);
                }
            };

            if (!funcionario) {
                return (
                    <div className="min-h-screen bg-gray-100 flex items-center justify-center p-6">
                        <div className="bg-white p-8 rounded-lg shadow-xl w-full max-w-md text-center">
                            <h2 className="text-2xl font-bold mb-2">Primeiro acesso</h2>
                            <p className="text-gray-600 mb-6">N√£o foi poss√≠vel localizar seus dados. Fa√ßa login novamente.</p>
                            <button onClick={onLogout} className="w-full bg-red-600 text-white py-2 rounded-lg hover:bg-red-700">Sair</button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-primary-500 to-primary-900 flex items-center justify-center p-6">
                    <div className="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md">
                        <div className="text-center mb-6">
                            <LogoInstaSolutions size="lg" variant="vertical" />
                            <h2 className="text-2xl font-bold text-gray-800 mt-4">Defina sua senha</h2>
                            <p className="text-gray-600 text-sm mt-2">
                                Primeiro acesso obrigat√≥rio. Crie uma senha pessoal para continuar.
                            </p>
                        </div>

                        <form onSubmit={salvar}>
                            <div className="mb-4">
                                <label className="block text-gray-700 mb-2">Nova senha</label>
                                <input
                                    type="password"
                                    value={senha}
                                    onChange={(e) => setSenha(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    placeholder="Digite sua nova senha"
                                    autoFocus
                                />
                            </div>
                            <div className="mb-6">
                                <label className="block text-gray-700 mb-2">Confirmar senha</label>
                                <input
                                    type="password"
                                    value={confirmarSenha}
                                    onChange={(e) => setConfirmarSenha(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500"
                                    placeholder="Repita a senha"
                                />
                            </div>

                            {erro && <div className="mb-4 p-3 bg-red-100 text-red-700 rounded-lg text-sm">{erro}</div>}

                            <button
                                type="submit"
                                disabled={salvando}
                                className={`w-full text-white py-2 rounded-lg transition ${salvando ? 'bg-gray-400' : 'bg-primary-600 hover:bg-primary-700'}`}
                            >
                                {salvando ? 'Salvando...' : 'Salvar e continuar'}
                            </button>

                            <button
                                type="button"
                                onClick={onLogout}
                                className="w-full mt-3 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700"
                            >
                                Sair
                            </button>
                        </form>

                        <div className="mt-6 text-xs text-gray-500">
                            Dica: use uma senha diferente do seu CPF.
                        </div>
                    </div>
                </div>
            );
        }

        // Continua...
        // Sidebar
        function Sidebar({ usuario, paginaAtual, setPagina, onLogout, avisosNaoLidos }) {
            const menuItems = usuario.tipo === 'admin' ? [
                { id: 'dashboard', icon: 'chart-line', label: 'Dashboard' },
                { id: 'empresas', icon: 'building', label: 'Empresas' },
                { id: 'funcionarios', icon: 'users', label: 'Funcion√°rios' },
                { id: 'rendimentos', icon: 'money-bill-wave', label: 'Rendimentos' },
                { id: 'jornada', icon: 'clock', label: 'Jornada' },
                { id: 'ferias', icon: 'umbrella-beach', label: 'F√©rias' },
                { id: 'feriados', icon: 'calendar-alt', label: 'Feriados' },
                { id: 'plano-saude', icon: 'medkit', label: 'Plano de Sa√∫de' },
                { id: 'avisos', icon: 'bullhorn', label: 'Avisos', badge: avisosNaoLidos },
                { id: 'documentos', icon: 'file-alt', label: 'Documentos' },
                { id: 'acessos', icon: 'user-lock', label: 'Gest√£o de Acessos' },
                { id: 'recuperacao', icon: 'database', label: 'Recupera√ß√£o de Dados' },
                { id: 'informacoes', icon: 'info-circle', label: 'Informa√ß√µes' },
            ] : [
                { id: 'dashboard', icon: 'chart-line', label: 'In√≠cio' },
                { id: 'rendimentos', icon: 'money-bill-wave', label: 'Holerites' },
                { id: 'jornada', icon: 'clock', label: 'Meu Ponto' },
                { id: 'ferias', icon: 'umbrella-beach', label: 'F√©rias' },
                { id: 'feriados', icon: 'calendar-alt', label: 'Feriados' },
                { id: 'plano-saude', icon: 'medkit', label: 'Plano de Sa√∫de' },
                { id: 'avisos', icon: 'bullhorn', label: 'Avisos', badge: avisosNaoLidos },
                { id: 'documentos', icon: 'file-alt', label: 'Documentos' },
            ];

            return (
                <div className="w-64 bg-primary-900 text-white flex flex-col">
                    <div className="p-5 border-b border-primary-800">
                        <div className="flex items-center gap-3 mb-3">
                            <LogoInstaSolutions size="sm" variant="symbol" />
                            <span className="text-lg font-bold text-white">InstaSolutions</span>
                        </div>
                        <p className="text-sm text-gray-300 truncate">{usuario.nome}</p>
                        <span className={`inline-block px-2 py-1 text-xs rounded mt-2 ${usuario.tipo === 'admin' ? 'bg-red-500' : 'bg-primary-500'}`}>
                            {usuario.tipo === 'admin' ? 'Administrador' : 'Funcion√°rio'}
                        </span>
                    </div>
                    <nav className="flex-1 p-4 overflow-y-auto scrollbar-hide">
                        {menuItems.map(item => (
                            <button key={item.id} onClick={() => setPagina(item.id)}
                                className={`w-full text-left px-4 py-3 rounded-lg mb-2 flex items-center justify-between transition ${
                                    paginaAtual === item.id ? 'bg-primary-500 text-white' : 'text-gray-300 hover:bg-primary-800'
                                }`}>
                                <div className="flex items-center">
                                    <i className={`fas fa-${item.icon} mr-3`}></i>
                                    <span className="text-sm">{item.label}</span>
                                </div>
                                {item.badge > 0 && <span className="bg-red-500 text-white text-xs rounded-full px-2 py-1">{item.badge}</span>}
                            </button>
                        ))}
                    </nav>
                    <div className="p-4 border-t border-gray-800">
                        <button onClick={onLogout} className="w-full px-4 py-3 bg-red-600 rounded-lg hover:bg-red-700 transition flex items-center justify-center">
                            <i className="fas fa-sign-out-alt mr-2"></i>Sair
                        </button>
                    </div>
                </div>
            );
        }

        // Header
        function Header({ usuario }) {
            const [dataHora, setDataHora] = useState(new Date());
            useEffect(() => {
                const timer = setInterval(() => setDataHora(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            return (
                <header className="bg-white shadow-sm p-4 flex justify-between items-center">
                    <h2 className="text-2xl font-bold text-gray-800">Bem-vindo, {usuario.nome}!</h2>
                    <div className="text-right">
                        <div className="text-gray-600 text-sm">
                            {dataHora.toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                        </div>
                        <div className="text-gray-500 text-xs">{dataHora.toLocaleTimeString('pt-BR')}</div>
                    </div>
                </header>
            );
        }

        // Dashboard
        function Dashboard({ dados, usuarioLogado, onNavigate }) {
            if (usuarioLogado.tipo === 'funcionario') {
                const meusDados = dados.funcionarios.find(f => f.id === usuarioLogado.id);
                if (!meusDados) return <div className="text-center p-8">Dados n√£o encontrados</div>;

                const feriasInfo = calcularDiasFerias(meusDados.dataAdmissao);
                const meusHolerites = dados.holerites.filter(h => h.funcionarioId === usuarioLogado.id);
                const meusRegistros = dados.registrosPonto.filter(r => r.funcionarioId === usuarioLogado.id);

                return (
                    <div>
                        <h2 className="text-3xl font-bold mb-6">Meu Painel</h2>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-primary-500">
                                <p className="text-gray-600 mb-2">Cargo</p>
                                <p className="text-xl font-bold text-gray-800">{meusDados.cargo}</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-green-500">
                                <p className="text-gray-600 mb-2">Admiss√£o</p>
                                <p className="text-xl font-bold text-gray-800">{formatarData(meusDados.dataAdmissao)}</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-purple-500">
                                <p className="text-gray-600 mb-2">Pr√≥ximas F√©rias</p>
                                <p className="text-xl font-bold text-gray-800">{feriasInfo.mesesRestantes} meses</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg border-l-4 border-orange-500">
                                <p className="text-gray-600 mb-2">Status</p>
                                <p className="text-xl font-bold text-gray-800">{meusDados.status}</p>
                            </div>
                        </div>
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">√öltimos Holerites</h3>
                                {meusHolerites.length === 0 ? (
                                    <p className="text-gray-500 text-center py-4">Nenhum holerite cadastrado</p>
                                ) : (
                                    <div className="space-y-2">
                                        {meusHolerites.slice(-3).reverse().map((h, i) => (
                                            <div key={i} className="p-3 bg-gray-50 rounded flex justify-between">
                                                <span>{h.mes}/{h.ano}</span>
                                                <span className="font-bold text-green-600">{formatarMoeda(h.salarioLiquido)}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Registros de Hoje</h3>
                                {meusRegistros.filter(r => r.data === new Date().toISOString().split('T')[0]).length === 0 ? (
                                    <p className="text-gray-500 text-center py-4">Nenhum registro hoje</p>
                                ) : (
                                    <div className="space-y-2">
                                        {meusRegistros.filter(r => r.data === new Date().toISOString().split('T')[0]).map((r, i) => (
                                            <div key={i} className="p-3 bg-gray-50 rounded flex justify-between">
                                                <span className={`px-2 py-1 rounded text-xs ${
                                                    r.tipo === 'Entrada' ? 'bg-green-100 text-green-800' :
                                                    r.tipo === 'Sa√≠da' ? 'bg-red-100 text-red-800' :
                                                    'bg-yellow-100 text-yellow-800'
                                                }`}>{r.tipo}</span>
                                                <span className="font-bold">{r.hora}</span>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            // Dashboard Admin
            const funcionariosAtivos = dados.funcionarios.filter(f => f.status === 'Ativo').length;
            const funcionariosFerias = dados.funcionarios.filter(f => f.status === 'F√©rias').length;
            const funcionariosAfastados = dados.funcionarios.filter(f => f.status === 'Afastado').length;
            const totalHolerites = dados.holerites.length;
            const avisosAtivos = dados.avisos.length;
            const solicitacoesPendentes = dados.solicitacoesFerias.filter(s => s.status === 'Pendente').length;

            // Pr√≥ximos anivers√°rios de empresa (baseado na data de admiss√£o)
            const hoje = new Date();
            const proximosAniversariosEmpresa = dados.funcionarios
                .filter(f => f.dataAdmissao)
                .map(f => {
                    const admissao = new Date(f.dataAdmissao);
                    const proximoAniversario = new Date(hoje.getFullYear(), admissao.getMonth(), admissao.getDate());
                    if (proximoAniversario < hoje) {
                        proximoAniversario.setFullYear(hoje.getFullYear() + 1);
                    }
                    const diasRestantes = Math.ceil((proximoAniversario - hoje) / (1000 * 60 * 60 * 24));
                    return { ...f, diasRestantes, proximoAniversario, tipo: 'empresa' };
                })
                .filter(f => f.diasRestantes <= 30)
                .sort((a, b) => a.diasRestantes - b.diasRestantes)
                .slice(0, 5);

            // Pr√≥ximos anivers√°rios de nascimento
            const proximosAniversariosNascimento = dados.funcionarios
                .filter(f => f.dataNascimento)
                .map(f => {
                    const nascimento = new Date(f.dataNascimento);
                    const proximoAniversario = new Date(hoje.getFullYear(), nascimento.getMonth(), nascimento.getDate());
                    if (proximoAniversario < hoje) {
                        proximoAniversario.setFullYear(hoje.getFullYear() + 1);
                    }
                    const diasRestantes = Math.ceil((proximoAniversario - hoje) / (1000 * 60 * 60 * 24));
                    return { ...f, diasRestantes, proximoAniversario, tipo: 'nascimento' };
                })
                .filter(f => f.diasRestantes <= 30)
                .sort((a, b) => a.diasRestantes - b.diasRestantes)
                .slice(0, 5);

            return (
                <div>
                    <div className="flex items-center justify-between mb-6">
                        <h2 className="text-3xl font-bold text-primary-900">Dashboard</h2>
                        <div className="text-sm text-gray-500">
                            <i className="fas fa-clock mr-1"></i>
                            {hoje.toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' })}
                        </div>
                    </div>

                    {/* Cards Principais */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div className="bg-gradient-to-r from-primary-500 to-primary-600 p-6 rounded-xl shadow-lg text-white">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-primary-100 text-sm">Total Funcion√°rios</p>
                                    <p className="text-4xl font-bold">{dados.funcionarios.length}</p>
                                </div>
                                <div className="w-14 h-14 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                    <i className="fas fa-users text-2xl"></i>
                                </div>
                            </div>
                            <div className="mt-4 flex items-center text-primary-100 text-sm">
                                <span className="bg-white bg-opacity-20 px-2 py-1 rounded">{funcionariosAtivos} ativos</span>
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-green-500 to-green-600 p-6 rounded-xl shadow-lg text-white">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-green-100 text-sm">Empresas</p>
                                    <p className="text-4xl font-bold">{dados.empresas.length}</p>
                                </div>
                                <div className="w-14 h-14 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                    <i className="fas fa-building text-2xl"></i>
                                </div>
                            </div>
                            <div className="mt-4 text-green-100 text-sm">
                                <i className="fas fa-check-circle mr-1"></i>Cadastradas
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-orange-500 to-orange-600 p-6 rounded-xl shadow-lg text-white">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-orange-100 text-sm">Holerites</p>
                                    <p className="text-4xl font-bold">{totalHolerites}</p>
                                </div>
                                <div className="w-14 h-14 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                    <i className="fas fa-file-invoice-dollar text-2xl"></i>
                                </div>
                            </div>
                            <div className="mt-4 text-orange-100 text-sm">
                                <i className="fas fa-calendar mr-1"></i>Cadastrados
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-purple-500 to-purple-600 p-6 rounded-xl shadow-lg text-white">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-purple-100 text-sm">Solicita√ß√µes</p>
                                    <p className="text-4xl font-bold">{solicitacoesPendentes}</p>
                                </div>
                                <div className="w-14 h-14 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                                    <i className="fas fa-clock text-2xl"></i>
                                </div>
                            </div>
                            <div className="mt-4 text-purple-100 text-sm">
                                <i className="fas fa-hourglass-half mr-1"></i>Pendentes
                            </div>
                        </div>
                    </div>

                    {/* Segunda linha de cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        {/* Status dos Funcion√°rios */}
                        <div className="bg-white p-6 rounded-xl shadow-lg">
                            <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center">
                                <i className="fas fa-chart-pie text-primary-500 mr-2"></i>
                                Status dos Funcion√°rios
                            </h3>
                            <div className="space-y-3">
                                <div className="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                                    <div className="flex items-center">
                                        <div className="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                        <span>Ativos</span>
                                    </div>
                                    <span className="font-bold text-green-600">{funcionariosAtivos}</span>
                                </div>
                                <div className="flex items-center justify-between p-3 bg-yellow-50 rounded-lg">
                                    <div className="flex items-center">
                                        <div className="w-3 h-3 bg-yellow-500 rounded-full mr-3"></div>
                                        <span>F√©rias</span>
                                    </div>
                                    <span className="font-bold text-yellow-600">{funcionariosFerias}</span>
                                </div>
                                <div className="flex items-center justify-between p-3 bg-red-50 rounded-lg">
                                    <div className="flex items-center">
                                        <div className="w-3 h-3 bg-red-500 rounded-full mr-3"></div>
                                        <span>Afastados</span>
                                    </div>
                                    <span className="font-bold text-red-600">{funcionariosAfastados}</span>
                                </div>
                            </div>
                        </div>

                        {/* Anivers√°rios de Nascimento */}
                        <div className="bg-white p-6 rounded-xl shadow-lg">
                            <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center">
                                <i className="fas fa-gift text-purple-500 mr-2"></i>
                                Anivers√°rios (30 dias)
                            </h3>
                            {proximosAniversariosNascimento.length === 0 ? (
                                <p className="text-gray-500 text-center py-4">Nenhum anivers√°rio pr√≥ximo</p>
                            ) : (
                                <div className="space-y-2">
                                    {proximosAniversariosNascimento.map((f, i) => (
                                        <div key={i} className="flex items-center justify-between p-3 bg-purple-50 rounded-lg">
                                            <div>
                                                <p className="font-medium text-sm">{f.nome}</p>
                                                <p className="text-xs text-gray-500">{formatarData(f.dataNascimento)}</p>
                                            </div>
                                            <span className={`text-white text-xs px-2 py-1 rounded-full ${f.diasRestantes === 0 ? 'bg-green-500 animate-pulse' : 'bg-purple-500'}`}>
                                                {f.diasRestantes === 0 ? 'üéÇ Hoje!' : `${f.diasRestantes} dias`}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* Anivers√°rios de Empresa */}
                        <div className="bg-white p-6 rounded-xl shadow-lg">
                            <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center">
                                <i className="fas fa-briefcase text-pink-500 mr-2"></i>
                                Aniv. de Empresa (30 dias)
                            </h3>
                            {proximosAniversariosEmpresa.length === 0 ? (
                                <p className="text-gray-500 text-center py-4">Nenhum anivers√°rio pr√≥ximo</p>
                            ) : (
                                <div className="space-y-2">
                                    {proximosAniversariosEmpresa.map((f, i) => (
                                        <div key={i} className="flex items-center justify-between p-3 bg-pink-50 rounded-lg">
                                            <div>
                                                <p className="font-medium text-sm">{f.nome}</p>
                                                <p className="text-xs text-gray-500">{formatarData(f.dataAdmissao)}</p>
                                            </div>
                                            <span className="bg-pink-500 text-white text-xs px-2 py-1 rounded-full">
                                                {f.diasRestantes === 0 ? 'Hoje!' : `${f.diasRestantes} dias`}
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        {/* A√ß√µes R√°pidas */}
                        <div className="bg-white p-6 rounded-xl shadow-lg">
                            <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center">
                                <i className="fas fa-bolt text-yellow-500 mr-2"></i>
                                A√ß√µes R√°pidas
                            </h3>
                            <div className="grid grid-cols-2 gap-3">
                                <button onClick={() => onNavigate && onNavigate('funcionarios')}
                                    className="p-4 bg-primary-50 hover:bg-primary-100 rounded-lg text-center transition w-full aspect-square flex flex-col items-center justify-center">
                                    <i className="fas fa-user-plus text-primary-500 text-xl mb-2"></i>
                                    <p className="text-sm font-medium text-primary-700">Novo Funcion√°rio</p>
                                </button>
                                <button onClick={() => onNavigate && onNavigate('empresas')}
                                    className="p-4 bg-green-50 hover:bg-green-100 rounded-lg text-center transition w-full aspect-square flex flex-col items-center justify-center">
                                    <i className="fas fa-building text-green-500 text-xl mb-2"></i>
                                    <p className="text-sm font-medium text-green-700">Nova Empresa</p>
                                </button>
                                <button onClick={() => onNavigate && onNavigate('rendimentos')}
                                    className="p-4 bg-orange-50 hover:bg-orange-100 rounded-lg text-center transition w-full aspect-square flex flex-col items-center justify-center">
                                    <i className="fas fa-file-invoice text-orange-500 text-xl mb-2"></i>
                                    <p className="text-sm font-medium text-orange-700">Novo Holerite</p>
                                </button>
                                <button onClick={() => onNavigate && onNavigate('avisos')}
                                    className="p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-center transition w-full aspect-square flex flex-col items-center justify-center">
                                    <i className="fas fa-bullhorn text-purple-500 text-xl mb-2"></i>
                                    <p className="text-sm font-medium text-purple-700">Novo Aviso</p>
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* √öltimos Cadastros */}
                    {dados.funcionarios.length > 0 && (
                        <div className="bg-white p-6 rounded-xl shadow-lg">
                            <h3 className="text-lg font-bold text-gray-800 mb-4 flex items-center">
                                <i className="fas fa-history text-primary-500 mr-2"></i>
                                √öltimos Funcion√°rios Cadastrados
                            </h3>
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead>
                                        <tr className="text-left text-gray-500 text-sm border-b">
                                            <th className="pb-3">Nome</th>
                                            <th className="pb-3">Cargo</th>
                                            <th className="pb-3">Admiss√£o</th>
                                            <th className="pb-3">V√≠nculo</th>
                                            <th className="pb-3">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {dados.funcionarios.slice(-5).reverse().map((func, i) => (
                                            <tr key={i} className="border-b hover:bg-gray-50">
                                                <td className="py-3 font-medium">{func.nome}</td>
                                                <td className="py-3 text-gray-600">{func.cargo}</td>
                                                <td className="py-3 text-gray-600">{formatarData(func.dataAdmissao)}</td>
                                                <td className="py-3">
                                                    <span className={`px-2 py-1 rounded text-xs ${func.tipoVinculo === 'CLT' ? 'bg-primary-100 text-primary-700' : 'bg-purple-100 text-purple-700'}`}>
                                                        {func.tipoVinculo}
                                                    </span>
                                                </td>
                                                <td className="py-3">
                                                    <span className={`px-2 py-1 rounded text-xs ${func.status === 'Ativo' ? 'bg-green-100 text-green-700' : func.status === 'F√©rias' ? 'bg-yellow-100 text-yellow-700' : 'bg-red-100 text-red-700'}`}>
                                                        {func.status}
                                                    </span>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Gest√£o de Empresas
        function GestaoEmpresas({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [empresaEditando, setEmpresaEditando] = useState(null);
            const [busca, setBusca] = useState('');

            const empresasFiltradas = dados.empresas.filter(emp =>
                emp.razaoSocial.toLowerCase().includes(busca.toLowerCase()) || emp.cnpj.includes(busca)
            );

            const salvarEmpresa = (empresa) => {
                if (empresaEditando) {
                    atualizar('empresas', dados.empresas.map(e => e.id === empresa.id ? empresa : e));
                } else {
                    atualizar('empresas', [...dados.empresas, { ...empresa, id: Date.now() }]);
                }
                setMostrarForm(false);
                setEmpresaEditando(null);
            };

            if (usuarioLogado.tipo !== 'admin') {
                return (
                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h2 className="text-2xl font-bold mb-4">Empresas Cadastradas</h2>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead><tr className="border-b">
                                    <th className="text-left p-3">Raz√£o Social</th>
                                    <th className="text-left p-3">CNPJ</th>
                                    <th className="text-left p-3">Cidade/UF</th>
                                </tr></thead>
                                <tbody>
                                    {dados.empresas.map((emp, i) => (
                                        <tr key={i} className="border-b hover:bg-gray-50">
                                            <td className="p-3">{emp.razaoSocial}</td>
                                            <td className="p-3">{emp.cnpj}</td>
                                            <td className="p-3">{emp.cidade}/{emp.estado}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                );
            }

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Gest√£o de Empresas</h2>
                        <button onClick={() => { setMostrarForm(true); setEmpresaEditando(null); }}
                            className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                            <i className="fas fa-plus mr-2"></i>Nova Empresa
                        </button>
                    </div>
                    <div className="bg-white p-4 rounded-lg shadow mb-4">
                        <input type="text" placeholder="Buscar empresa..." value={busca} onChange={(e) => setBusca(e.target.value)}
                            className="w-full px-4 py-2 border rounded-lg" />
                    </div>
                    {mostrarForm && (
                        <FormEmpresa empresa={empresaEditando} onSalvar={salvarEmpresa} onCancelar={() => { setMostrarForm(false); setEmpresaEditando(null); }} />
                    )}
                    <div className="bg-white rounded-lg shadow-lg overflow-x-auto">
                        <table className="w-full">
                            <thead className="bg-gray-50"><tr>
                                <th className="text-left p-4">Raz√£o Social</th>
                                <th className="text-left p-4">CNPJ</th>
                                <th className="text-left p-4">Cidade/UF</th>
                                <th className="text-center p-4">A√ß√µes</th>
                            </tr></thead>
                            <tbody>
                                {empresasFiltradas.map((emp, i) => (
                                    <tr key={i} className="border-b hover:bg-gray-50">
                                        <td className="p-4 font-medium">{emp.razaoSocial}</td>
                                        <td className="p-4">{emp.cnpj}</td>
                                        <td className="p-4">{emp.cidade}/{emp.estado}</td>
                                        <td className="p-4">
                                            <div className="flex justify-center gap-2">
                                                <button onClick={() => { setEmpresaEditando(emp); setMostrarForm(true); }} className="text-primary-500 hover:text-primary-700">
                                                    <i className="fas fa-edit"></i>
                                                </button>
                                                <button onClick={() => confirm('Excluir?') && atualizar('empresas', dados.empresas.filter(e => e.id !== emp.id))} className="text-red-600 hover:text-red-800">
                                                    <i className="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // Form Empresa
        function FormEmpresa({ empresa, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState(empresa || {
                razaoSocial: '', cnpj: '', endereco: '', bairro: '', cidade: '', estado: ''
            });
            const [erros, setErros] = useState({});

            const handleSubmit = (e) => {
                e.preventDefault();
                const novosErros = {};
                if (!formData.razaoSocial) novosErros.razaoSocial = 'Obrigat√≥rio';
                if (!formData.cnpj) novosErros.cnpj = 'Obrigat√≥rio';
                else if (!validarCNPJ(formData.cnpj)) novosErros.cnpj = 'CNPJ inv√°lido';
                if (Object.keys(novosErros).length > 0) {
                    setErros(novosErros);
                    return;
                }
                onSalvar({ ...formData, cnpj: formatarCNPJ(formData.cnpj) });
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">{empresa ? 'Editar' : 'Nova'} Empresa</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="md:col-span-2">
                                <label className="block mb-2 font-medium">Raz√£o Social *</label>
                                <input type="text" value={formData.razaoSocial} onChange={(e) => setFormData({...formData, razaoSocial: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.razaoSocial ? 'border-red-500' : ''}`} />
                                {erros.razaoSocial && <p className="text-red-500 text-sm mt-1">{erros.razaoSocial}</p>}
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CNPJ *</label>
                                <input type="text" value={formData.cnpj} onChange={(e) => setFormData({...formData, cnpj: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.cnpj ? 'border-red-500' : ''}`} placeholder="00.000.000/0000-00" />
                                {erros.cnpj && <p className="text-red-500 text-sm mt-1">{erros.cnpj}</p>}
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Endere√ßo</label>
                                <input type="text" value={formData.endereco} onChange={(e) => setFormData({...formData, endereco: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Bairro</label>
                                <input type="text" value={formData.bairro} onChange={(e) => setFormData({...formData, bairro: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Cidade</label>
                                <input type="text" value={formData.cidade} onChange={(e) => setFormData({...formData, cidade: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Estado</label>
                                <select value={formData.estado} onChange={(e) => setFormData({...formData, estado: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {ESTADOS_BRASILEIROS.map(est => <option key={est.sigla} value={est.sigla}>{est.sigla} - {est.nome}</option>)}
                                </select>
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // CONTINUA PR√ìXIMO BLOCO...
        // Gest√£o de Funcion√°rios
        function GestaoFuncionarios({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [funcionarioEditando, setFuncionarioEditando] = useState(null);
            const [busca, setBusca] = useState('');
            const [filtroStatus, setFiltroStatus] = useState('Todos');

            let funcionariosFiltrados = dados.funcionarios.filter(func => {
                const matchBusca = func.nome.toLowerCase().includes(busca.toLowerCase()) || func.cpf.includes(busca) || func.cargo.toLowerCase().includes(busca.toLowerCase());
                const matchStatus = filtroStatus === 'Todos' || func.status === filtroStatus;
                return matchBusca && matchStatus;
            });

            if (usuarioLogado.tipo !== 'admin') {
                funcionariosFiltrados = dados.funcionarios.filter(f => f.id === usuarioLogado.id);
            }

            const salvarFuncionario = (funcionario) => {
                if (funcionarioEditando) {
                    atualizar('funcionarios', dados.funcionarios.map(f => f.id === funcionario.id ? funcionario : f));
                } else {
                    atualizar('funcionarios', [...dados.funcionarios, { ...funcionario, id: Date.now() }]);
                }
                setMostrarForm(false);
                setFuncionarioEditando(null);
            };

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Gest√£o de Funcion√°rios</h2>
                        {usuarioLogado.tipo === 'admin' && (
                            <button onClick={() => { setMostrarForm(true); setFuncionarioEditando(null); }}
                                className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-user-plus mr-2"></i>Novo Funcion√°rio
                            </button>
                        )}
                    </div>
                    {usuarioLogado.tipo === 'admin' && (
                        <div className="bg-white p-4 rounded-lg shadow mb-4 grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="text" placeholder="Buscar por nome, CPF ou cargo..." value={busca} onChange={(e) => setBusca(e.target.value)}
                                className="px-4 py-2 border rounded-lg" />
                            <select value={filtroStatus} onChange={(e) => setFiltroStatus(e.target.value)} className="px-4 py-2 border rounded-lg">
                                <option value="Todos">Todos os Status</option>
                                <option value="Ativo">Ativo</option>
                                <option value="Inativo">Inativo</option>
                                <option value="F√©rias">F√©rias</option>
                                <option value="Afastado">Afastado</option>
                            </select>
                        </div>
                    )}
                    {mostrarForm && (
                        <FormFuncionario funcionario={funcionarioEditando} empresas={dados.empresas} onSalvar={salvarFuncionario} 
                            onCancelar={() => { setMostrarForm(false); setFuncionarioEditando(null); }} />
                    )}
                    <div className="bg-white rounded-lg shadow-lg overflow-x-auto">
                        <table className="w-full">
                            <thead className="bg-gray-50"><tr>
                                <th className="text-left p-4">Nome</th>
                                <th className="text-left p-4">CPF</th>
                                <th className="text-left p-4">Cargo</th>
                                <th className="text-left p-4">Admiss√£o</th>
                                <th className="text-left p-4">Status</th>
                                {usuarioLogado.tipo === 'admin' && <th className="text-center p-4">A√ß√µes</th>}
                            </tr></thead>
                            <tbody>
                                {funcionariosFiltrados.map((func, i) => (
                                    <tr key={i} className="border-b hover:bg-gray-50">
                                        <td className="p-4 font-medium">{func.nome}</td>
                                        <td className="p-4">{func.cpf}</td>
                                        <td className="p-4">{func.cargo}</td>
                                        <td className="p-4">{formatarData(func.dataAdmissao)}</td>
                                        <td className="p-4">
                                            <span className={`px-2 py-1 rounded text-xs ${
                                                func.status === 'Ativo' ? 'bg-green-100 text-green-800' :
                                                func.status === 'Inativo' ? 'bg-red-100 text-red-800' :
                                                func.status === 'F√©rias' ? 'bg-yellow-100 text-yellow-800' :
                                                'bg-gray-100 text-gray-800'
                                            }`}>{func.status}</span>
                                        </td>
                                        {usuarioLogado.tipo === 'admin' && (
                                            <td className="p-4">
                                                <div className="flex justify-center gap-2">
                                                    <button onClick={() => { setFuncionarioEditando(func); setMostrarForm(true); }} className="text-primary-500 hover:text-primary-700">
                                                        <i className="fas fa-edit"></i>
                                                    </button>
                                                    <button onClick={() => confirm('Excluir?') && atualizar('funcionarios', dados.funcionarios.filter(f => f.id !== func.id))} className="text-red-600 hover:text-red-800">
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        )}
                                    </tr>
                                ))}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // Form Funcion√°rio
        function FormFuncionario({ funcionario, empresas, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState(funcionario || {
                nome: '', cbo: '', cpf: '', rg: '', endereco: '', bairro: '', cidade: '', estado: '', pais: 'Brasil',
                ctps: '', pis: '', dataAdmissao: '', dataNascimento: '', cargo: '', salarioBase: '', empresaId: '', tipoVinculo: 'CLT',
                status: 'Ativo', departamento: '', email: '', telefone: '', foto: ''
            });
            const [erros, setErros] = useState({});
            const fotoInputRef = useRef(null);

            const handleFotoUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 2 * 1024 * 1024) {
                        alert('A foto deve ter no m√°ximo 2MB');
                        return;
                    }
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setFormData({...formData, foto: reader.result});
                    };
                    reader.readAsDataURL(file);
                }
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const novosErros = {};
                if (!formData.nome) novosErros.nome = 'Obrigat√≥rio';
                if (!formData.cpf) novosErros.cpf = 'Obrigat√≥rio';
                else if (!validarCPF(formData.cpf)) novosErros.cpf = 'CPF inv√°lido';
                if (!formData.cargo) novosErros.cargo = 'Obrigat√≥rio';
                if (!formData.dataAdmissao) novosErros.dataAdmissao = 'Obrigat√≥rio';
                if (!formData.empresaId) novosErros.empresaId = 'Recomendado vincular a uma empresa';
                if (Object.keys(novosErros).length > 0) {
                    setErros(novosErros);
                    // Se o √∫nico erro √© a empresa, permitir continuar com confirma√ß√£o
                    if (Object.keys(novosErros).length === 1 && novosErros.empresaId) {
                        if (!confirm('Funcion√°rio sem empresa vinculada. Continuar mesmo assim?\n\nNota: O holerite n√£o ter√° os dados da empresa no cabe√ßalho.')) {
                            return;
                        }
                    } else {
                        return;
                    }
                }
                onSalvar({ ...formData, cpf: formatarCPF(formData.cpf) });
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">{funcionario ? 'Editar' : 'Novo'} Funcion√°rio</h3>
                    <form onSubmit={handleSubmit}>
                        {/* Se√ß√£o de Foto */}
                        <div className="flex justify-center mb-6">
                            <div className="text-center">
                                <div className="relative inline-block">
                                    <div className="w-32 h-32 rounded-full border-4 border-primary-200 overflow-hidden bg-gray-100 flex items-center justify-center">
                                        {formData.foto ? (
                                            <img src={formData.foto} alt="Foto" className="w-full h-full object-cover" />
                                        ) : (
                                            <i className="fas fa-user text-4xl text-gray-300"></i>
                                        )}
                                    </div>
                                    <button 
                                        type="button"
                                        onClick={() => fotoInputRef.current?.click()}
                                        className="absolute bottom-0 right-0 w-10 h-10 bg-primary-500 text-white rounded-full flex items-center justify-center hover:bg-primary-600 shadow-lg"
                                    >
                                        <i className="fas fa-camera"></i>
                                    </button>
                                </div>
                                <input 
                                    type="file" 
                                    ref={fotoInputRef} 
                                    onChange={handleFotoUpload} 
                                    accept="image/*" 
                                    className="hidden" 
                                />
                                <p className="text-sm text-gray-500 mt-2">Clique para adicionar foto</p>
                                {formData.foto && (
                                    <button 
                                        type="button" 
                                        onClick={() => setFormData({...formData, foto: ''})}
                                        className="text-red-500 text-sm mt-1 hover:underline"
                                    >
                                        <i className="fas fa-trash mr-1"></i>Remover foto
                                    </button>
                                )}
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div className="lg:col-span-3">
                                <label className="block mb-2 font-medium">Nome Completo *</label>
                                <input type="text" value={formData.nome} onChange={(e) => setFormData({...formData, nome: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.nome ? 'border-red-500' : ''}`} />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CPF *</label>
                                <input type="text" value={formData.cpf} onChange={(e) => setFormData({...formData, cpf: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.cpf ? 'border-red-500' : ''}`} placeholder="000.000.000-00" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">RG</label>
                                <input type="text" value={formData.rg} onChange={(e) => setFormData({...formData, rg: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data de Nascimento</label>
                                <input type="date" value={formData.dataNascimento} onChange={(e) => setFormData({...formData, dataNascimento: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CBO</label>
                                <input type="text" value={formData.cbo} onChange={(e) => setFormData({...formData, cbo: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Cargo *</label>
                                <input type="text" value={formData.cargo} onChange={(e) => setFormData({...formData, cargo: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.cargo ? 'border-red-500' : ''}`} />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Departamento</label>
                                <input type="text" value={formData.departamento} onChange={(e) => setFormData({...formData, departamento: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Tipo de V√≠nculo *</label>
                                <select value={formData.tipoVinculo} onChange={(e) => setFormData({...formData, tipoVinculo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="CLT">CLT</option>
                                    <option value="Terceiro">Terceiro</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Status *</label>
                                <select value={formData.status} onChange={(e) => setFormData({...formData, status: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Ativo">Ativo</option>
                                    <option value="Inativo">Inativo</option>
                                    <option value="F√©rias">F√©rias</option>
                                    <option value="Afastado">Afastado</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data de Admiss√£o *</label>
                                <input type="date" value={formData.dataAdmissao} onChange={(e) => setFormData({...formData, dataAdmissao: e.target.value})}
                                    className={`w-full px-4 py-2 border rounded-lg ${erros.dataAdmissao ? 'border-red-500' : ''}`} />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Sal√°rio Base</label>
                                <InputMoeda value={formData.salarioBase} onChange={(valor) => setFormData({...formData, salarioBase: valor})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">CTPS</label>
                                <input type="text" value={formData.ctps} onChange={(e) => setFormData({...formData, ctps: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">PIS</label>
                                <input type="text" value={formData.pis} onChange={(e) => setFormData({...formData, pis: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Email</label>
                                <input type="email" value={formData.email} onChange={(e) => setFormData({...formData, email: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Telefone</label>
                                <input type="tel" value={formData.telefone} onChange={(e) => setFormData({...formData, telefone: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div className="lg:col-span-2">
                                <label className="block mb-2 font-medium">Endere√ßo</label>
                                <input type="text" value={formData.endereco} onChange={(e) => setFormData({...formData, endereco: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Bairro</label>
                                <input type="text" value={formData.bairro} onChange={(e) => setFormData({...formData, bairro: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Cidade</label>
                                <input type="text" value={formData.cidade} onChange={(e) => setFormData({...formData, cidade: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Estado</label>
                                <select value={formData.estado} onChange={(e) => setFormData({...formData, estado: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {ESTADOS_BRASILEIROS.map(est => <option key={est.sigla} value={est.sigla}>{est.sigla} - {est.nome}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Pa√≠s</label>
                                <input type="text" value={formData.pais} onChange={(e) => setFormData({...formData, pais: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div className="lg:col-span-3">
                                <label className="block mb-2 font-medium">Empresa {erros.empresaId && <span className="text-yellow-600 text-sm ml-2">(Recomendado)</span>}</label>
                                <select value={formData.empresaId} onChange={(e) => setFormData({...formData, empresaId: parseInt(e.target.value) || ''})} className={`w-full px-4 py-2 border rounded-lg ${erros.empresaId ? 'border-yellow-400 bg-yellow-50' : ''}`}>
                                    <option value="">Selecione uma empresa</option>
                                    {empresas.map(emp => <option key={emp.id} value={emp.id}>{emp.razaoSocial} - {emp.cnpj}</option>)}
                                </select>
                                {erros.empresaId && <p className="text-yellow-600 text-sm mt-1">{erros.empresaId}</p>}
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // RENDIMENTOS (NOVO - Com upload de arquivo e campos manuais)
        function Rendimentos({ dados, atualizar, usuarioLogado }) {
            const [funcionarioSelecionado, setFuncionarioSelecionado] = useState('');
            const [mes, setMes] = useState(new Date().getMonth() + 1);
            const [ano, setAno] = useState(new Date().getFullYear());
            const [mostrarForm, setMostrarForm] = useState(false);

            const funcionariosFiltrados = usuarioLogado.tipo === 'admin' ? dados.funcionarios : dados.funcionarios.filter(f => f.id === usuarioLogado.id);
            const holeriteFiltrado = dados.holerites.find(h => h.funcionarioId === parseInt(funcionarioSelecionado) && h.mes === parseInt(mes) && h.ano === parseInt(ano));

            const salvarHolerite = (holerite) => {
                const existe = dados.holerites.find(h => h.funcionarioId === holerite.funcionarioId && h.mes === holerite.mes && h.ano === holerite.ano);
                if (existe) {
                    atualizar('holerites', dados.holerites.map(h => h.id === existe.id ? { ...holerite, id: existe.id } : h));
                } else {
                    atualizar('holerites', [...dados.holerites, { ...holerite, id: Date.now() }]);
                }
                setMostrarForm(false);
            };

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Rendimentos / Holerites</h2>
                    <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label className="block mb-2 font-medium">Funcion√°rio</label>
                                <select value={funcionarioSelecionado} onChange={(e) => setFuncionarioSelecionado(e.target.value)} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {funcionariosFiltrados.map(func => <option key={func.id} value={func.id}>{func.nome}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">M√™s</label>
                                <select value={mes} onChange={(e) => setMes(e.target.value)} className="w-full px-4 py-2 border rounded-lg">
                                    {[...Array(12)].map((_, i) => <option key={i+1} value={i+1}>{new Date(2000, i, 1).toLocaleString('pt-BR', {month: 'long'})}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Ano</label>
                                <input type="number" value={ano} onChange={(e) => setAno(e.target.value)} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            {usuarioLogado.tipo === 'admin' && funcionarioSelecionado && (
                                <div className="flex items-end">
                                    <button onClick={() => setMostrarForm(true)} className="w-full bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600">
                                        {holeriteFiltrado ? 'Editar' : 'Cadastrar'} Holerite
                                    </button>
                                </div>
                            )}
                        </div>
                    </div>

                    {mostrarForm && usuarioLogado.tipo === 'admin' && (() => {
                        const func = dados.funcionarios.find(f => f.id === parseInt(funcionarioSelecionado));
                        const emp = func ? dados.empresas.find(e => e.id === parseInt(func.empresaId)) : null;
                        return (
                            <FormHolerite 
                                funcionarioId={parseInt(funcionarioSelecionado)} 
                                mes={parseInt(mes)} 
                                ano={parseInt(ano)} 
                                holerite={holeriteFiltrado}
                                onSalvar={salvarHolerite}
                                onCancelar={() => setMostrarForm(false)}
                                funcionario={func}
                                empresa={emp}
                            />
                        );
                    })()}

                    {holeriteFiltrado && !mostrarForm && (() => {
                        const func = dados.funcionarios.find(f => f.id === holeriteFiltrado.funcionarioId);
                        const emp = func ? dados.empresas.find(e => e.id === parseInt(func.empresaId)) : null;
                        return (
                            <VisualizarHolerite 
                                holerite={holeriteFiltrado} 
                                funcionario={func}
                                empresa={emp}
                            />
                        );
                    })()}

                    {!funcionarioSelecionado && (
                        <div className="bg-white p-8 rounded-lg shadow-lg text-center text-gray-500">
                            <i className="fas fa-file-invoice-dollar text-6xl mb-4"></i>
                            <p>Selecione um funcion√°rio e per√≠odo para visualizar o holerite</p>
                        </div>
                    )}

                    {/* Lista de todos os holerites cadastrados */}
                    {dados.holerites.length > 0 && (
                        <div className="bg-white p-6 rounded-lg shadow-lg mt-6">
                            <h3 className="text-xl font-bold mb-4 flex items-center">
                                <i className="fas fa-list text-primary-500 mr-2"></i>
                                Todos os Holerites Cadastrados
                            </h3>
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="text-left p-3">Funcion√°rio</th>
                                            <th className="text-left p-3">M√™s/Ano</th>
                                            <th className="text-right p-3">Total Proventos</th>
                                            <th className="text-right p-3">Total Descontos</th>
                                            <th className="text-right p-3">L√≠quido</th>
                                            <th className="text-center p-3">A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {dados.holerites
                                            .filter(h => usuarioLogado.tipo === 'admin' || h.funcionarioId === usuarioLogado.id)
                                            .sort((a, b) => {
                                                if (b.ano !== a.ano) return b.ano - a.ano;
                                                return b.mes - a.mes;
                                            })
                                            .map(h => {
                                                const func = dados.funcionarios.find(f => f.id === h.funcionarioId);
                                                const nomeMes = new Date(2000, h.mes - 1, 1).toLocaleString('pt-BR', { month: 'long' });
                                                return (
                                                    <tr key={h.id} className="border-b hover:bg-gray-50">
                                                        <td className="p-3">{func?.nome || '-'}</td>
                                                        <td className="p-3 capitalize">{nomeMes} / {h.ano}</td>
                                                        <td className="p-3 text-right text-green-600 font-medium">
                                                            {formatarMoeda(h.totalProventos || 0)}
                                                        </td>
                                                        <td className="p-3 text-right text-red-600 font-medium">
                                                            {formatarMoeda(h.totalDescontos || 0)}
                                                        </td>
                                                        <td className="p-3 text-right font-bold text-primary-600">
                                                            {formatarMoeda(h.salarioLiquido || 0)}
                                                        </td>
                                                        <td className="p-3 text-center">
                                                            <button 
                                                                onClick={() => {
                                                                    setFuncionarioSelecionado(h.funcionarioId.toString());
                                                                    setMes(h.mes);
                                                                    setAno(h.ano);
                                                                }} 
                                                                className="text-primary-600 hover:text-primary-800 mr-2"
                                                                title="Visualizar"
                                                            >
                                                                <i className="fas fa-eye"></i>
                                                            </button>
                                                            {usuarioLogado.tipo === 'admin' && (
                                                                <button 
                                                                    onClick={() => {
                                                                        if (confirm('Tem certeza que deseja excluir este holerite?')) {
                                                                            atualizar('holerites', dados.holerites.filter(hol => hol.id !== h.id));
                                                                        }
                                                                    }} 
                                                                    className="text-red-600 hover:text-red-800"
                                                                    title="Excluir"
                                                                >
                                                                    <i className="fas fa-trash"></i>
                                                                </button>
                                                            )}
                                                        </td>
                                                    </tr>
                                                );
                                            })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Form Holerite - NOVO baseado no modelo real
        function FormHolerite({ funcionarioId, mes, ano, holerite, onSalvar, onCancelar, funcionario, empresa }) {
            const fileInputRef = useRef(null);
            const [formData, setFormData] = useState(holerite || {
                funcionarioId, mes, ano,
                salarioMensalista: '',
                auxilioCombustivel: '',
                premioMotivacional: '',
                arredondamentoProvento: '',
                inss: '',
                ir: '',
                arquivoBase64: null,
                arquivoNome: null
            });

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        setFormData({
                            ...formData,
                            arquivoBase64: reader.result,
                            arquivoNome: file.name
                        });
                    };
                    reader.readAsDataURL(file);
                }
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                const totalProventos = parseFloat(formData.salarioMensalista || 0) + parseFloat(formData.auxilioCombustivel || 0) + 
                    parseFloat(formData.premioMotivacional || 0) + parseFloat(formData.arredondamentoProvento || 0);
                const totalDescontos = parseFloat(formData.inss || 0) + parseFloat(formData.ir || 0);
                const salarioLiquido = totalProventos - totalDescontos;

                onSalvar({
                    ...formData,
                    totalProventos,
                    totalDescontos,
                    salarioLiquido
                });
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">Cadastrar Holerite - {funcionario?.nome} - {mes}/{ano}</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                            <div className="lg:col-span-3">
                                <h4 className="font-bold text-lg mb-3 text-green-700">Proventos</h4>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Sal√°rio Mensalista</label>
                                <InputMoeda value={formData.salarioMensalista} 
                                    onChange={(valor) => setFormData({...formData, salarioMensalista: valor})}
                                    className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Aux√≠lio Combust√≠vel</label>
                                <InputMoeda value={formData.auxilioCombustivel}
                                    onChange={(valor) => setFormData({...formData, auxilioCombustivel: valor})}
                                    className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Pr√™mio Motivacional</label>
                                <InputMoeda value={formData.premioMotivacional}
                                    onChange={(valor) => setFormData({...formData, premioMotivacional: valor})}
                                    className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Arredondamento Provento Folha</label>
                                <InputMoeda value={formData.arredondamentoProvento}
                                    onChange={(valor) => setFormData({...formData, arredondamentoProvento: valor})}
                                    className="w-full px-4 py-2 border rounded-lg" />
                            </div>

                            <div className="lg:col-span-3 mt-4">
                                <h4 className="font-bold text-lg mb-3 text-red-700">Descontos</h4>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">INSS</label>
                                <InputMoeda value={formData.inss}
                                    onChange={(valor) => setFormData({...formData, inss: valor})}
                                    className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">IR</label>
                                <InputMoeda value={formData.ir}
                                    onChange={(valor) => setFormData({...formData, ir: valor})}
                                    className="w-full px-4 py-2 border rounded-lg" />
                            </div>

                            <div className="lg:col-span-3 mt-4">
                                <h4 className="font-bold text-lg mb-3">Arquivo do Holerite</h4>
                                <input type="file" ref={fileInputRef} onChange={handleFileUpload} accept=".pdf,.png,.jpg,.jpeg" className="hidden" />
                                <button type="button" onClick={() => fileInputRef.current.click()} 
                                    className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 flex items-center gap-2">
                                    <i className="fas fa-upload"></i>
                                    {formData.arquivoNome ? `Arquivo: ${formData.arquivoNome}` : 'Anexar Arquivo (PDF/Imagem)'}
                                </button>
                            </div>
                        </div>

                        <div className="flex gap-4">
                            <button type="submit" className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                                <i className="fas fa-save mr-2"></i>Salvar Holerite
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // Visualizar Holerite
        function VisualizarHolerite({ holerite, funcionario, empresa }) {
            const baixarArquivo = () => {
                if (holerite.arquivoBase64) {
                    const link = document.createElement('a');
                    link.href = holerite.arquivoBase64;
                    link.download = holerite.arquivoNome || `holerite_${funcionario?.nome}_${holerite.mes}_${holerite.ano}.pdf`;
                    link.click();
                }
            };

            // Log para debug - pode remover depois
            console.log('VisualizarHolerite - Empresa:', empresa);
            console.log('VisualizarHolerite - Funcion√°rio:', funcionario);

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg">
                    {!empresa && (
                        <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4">
                            <div className="flex">
                                <div className="flex-shrink-0">
                                    <i className="fas fa-exclamation-triangle text-yellow-400"></i>
                                </div>
                                <div className="ml-3">
                                    <p className="text-sm text-yellow-700">
                                        <strong>Aten√ß√£o:</strong> Empresa n√£o encontrada. Por favor, vincule o funcion√°rio a uma empresa.
                                    </p>
                                </div>
                            </div>
                        </div>
                    )}
                    <div className="border-b pb-4 mb-4">
                        <div className="flex justify-between items-start">
                            <div>
                                <h3 className="text-2xl font-bold">{empresa?.razaoSocial || '-'}</h3>
                                {empresa?.endereco && empresa?.cidade && empresa?.estado && (
                                    <p className="text-sm text-gray-600">{empresa.endereco}, {empresa.cidade}/{empresa.estado}</p>
                                )}
                                <p className="text-sm text-gray-600">CNPJ: {empresa?.cnpj || '-'}</p>
                            </div>
                            <div className="text-right">
                                <p className="text-lg font-bold">RECIBO DE PAGAMENTO DE SAL√ÅRIO</p>
                                <p className="text-sm">Referente ao m√™s de {new Date(2000, holerite.mes - 1, 1).toLocaleString('pt-BR', {month: 'long'})}/{holerite.ano}</p>
                            </div>
                        </div>
                    </div>

                    <div className="mb-6 grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded">
                        <div>
                            <p className="text-sm text-gray-600">Nome do Funcion√°rio</p>
                            <p className="font-bold">{funcionario?.nome}</p>
                        </div>
                        <div>
                            <p className="text-sm text-gray-600">CPF</p>
                            <p className="font-bold">{funcionario?.cpf}</p>
                        </div>
                        <div>
                            <p className="text-sm text-gray-600">Cargo</p>
                            <p className="font-bold">{funcionario?.cargo}</p>
                        </div>
                        <div>
                            <p className="text-sm text-gray-600">Admiss√£o</p>
                            <p className="font-bold">{formatarData(funcionario?.dataAdmissao)}</p>
                        </div>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <h4 className="font-bold mb-3 text-green-700">PROVENTOS</h4>
                            <div className="space-y-2">
                                <div className="flex justify-between p-2 bg-green-50 rounded">
                                    <span>Sal√°rio Mensalista</span>
                                    <span className="font-bold">{formatarMoeda(holerite.salarioMensalista)}</span>
                                </div>
                                {holerite.auxilioCombustivel > 0 && (
                                    <div className="flex justify-between p-2 bg-green-50 rounded">
                                        <span>Aux√≠lio Combust√≠vel</span>
                                        <span className="font-bold">{formatarMoeda(holerite.auxilioCombustivel)}</span>
                                    </div>
                                )}
                                {holerite.premioMotivacional > 0 && (
                                    <div className="flex justify-between p-2 bg-green-50 rounded">
                                        <span>Pr√™mio Motivacional</span>
                                        <span className="font-bold">{formatarMoeda(holerite.premioMotivacional)}</span>
                                    </div>
                                )}
                                {holerite.arredondamentoProvento > 0 && (
                                    <div className="flex justify-between p-2 bg-green-50 rounded">
                                        <span>Arredondamento Provento</span>
                                        <span className="font-bold">{formatarMoeda(holerite.arredondamentoProvento)}</span>
                                    </div>
                                )}
                                <div className="flex justify-between p-2 bg-green-100 rounded font-bold">
                                    <span>Total Proventos</span>
                                    <span>{formatarMoeda(holerite.totalProventos)}</span>
                                </div>
                            </div>
                        </div>

                        <div>
                            <h4 className="font-bold mb-3 text-red-700">DESCONTOS</h4>
                            <div className="space-y-2">
                                {holerite.inss > 0 && (
                                    <div className="flex justify-between p-2 bg-red-50 rounded">
                                        <span>I.N.S.S.</span>
                                        <span className="font-bold">{formatarMoeda(holerite.inss)}</span>
                                    </div>
                                )}
                                {holerite.ir > 0 && (
                                    <div className="flex justify-between p-2 bg-red-50 rounded">
                                        <span>I.R.</span>
                                        <span className="font-bold">{formatarMoeda(holerite.ir)}</span>
                                    </div>
                                )}
                                <div className="flex justify-between p-2 bg-red-100 rounded font-bold">
                                    <span>Total Descontos</span>
                                    <span>{formatarMoeda(holerite.totalDescontos)}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div className="border-t-2 pt-4">
                        <div className="flex justify-between items-center p-4 bg-primary-50 rounded">
                            <span className="text-xl font-bold">SAL√ÅRIO L√çQUIDO</span>
                            <span className="text-3xl font-bold text-primary-600">{formatarMoeda(holerite.salarioLiquido)}</span>
                        </div>
                    </div>

                    <div className="mt-6 flex justify-end gap-4">
                        {holerite.arquivoBase64 && (
                            <button onClick={baixarArquivo} className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-download mr-2"></i>Baixar Holerite
                            </button>
                        )}
                        <button onClick={() => window.print()} className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                            <i className="fas fa-print mr-2"></i>Imprimir
                        </button>
                    </div>
                </div>
            );
        }

        // Continua no pr√≥ximo bloco...
        // REGISTRO DE JORNADA - Com edi√ß√£o, filtros e gera√ß√£o de PDF
        function RegistroJornada({ dados, atualizar, usuarioLogado }) {
            const [dataRegistro, setDataRegistro] = useState(new Date().toISOString().split('T')[0]);
            const [filtros, setFiltros] = useState({ funcionarioId: '', dataInicio: '', dataFim: '', empresaId: '' });
            const [editando, setEditando] = useState(null);
            const [mostrarForm, setMostrarForm] = useState(false);
            const [registrando, setRegistrando] = useState(false);

            const registrarPonto = (tipo) => {
                // Previne m√∫ltiplos cliques
                if (registrando) {
                    alert('Aguarde, processando registro...');
                    return;
                }

                const agora = new Date();
                const funcionarioId = usuarioLogado.tipo === 'admin' ? parseInt(filtros.funcionarioId) : usuarioLogado.id;
                
                // Valida√ß√£o: verifica se h√° registro duplicado nos √∫ltimos 2 minutos
                const doisMinutosAtras = agora.getTime() - (2 * 60 * 1000);
                const registroDuplicado = dados.registrosPonto.find(r => 
                    r.funcionarioId === funcionarioId &&
                    r.tipo === tipo &&
                    r.data === dataRegistro &&
                    r.timestamp > doisMinutosAtras
                );

                if (registroDuplicado) {
                    alert(`J√° existe um registro de "${tipo}" recente (${registroDuplicado.hora}). Aguarde alguns minutos para registrar novamente.`);
                    return;
                }

                // Confirma√ß√£o antes de registrar
                const confirmar = confirm(`Confirmar registro de ponto?\n\nTipo: ${tipo}\nData: ${formatarData(dataRegistro)}\nHora: ${agora.toLocaleTimeString('pt-BR')}`);
                
                if (!confirmar) {
                    return;
                }

                setRegistrando(true);

                // Gera ID √∫nico usando timestamp + random para evitar duplicatas
                const idUnico = `${agora.getTime()}_${Math.random().toString(36).substr(2, 9)}`;
                
                const novoRegistro = {
                    id: idUnico,
                    funcionarioId,
                    tipo,
                    data: dataRegistro,
                    hora: agora.toLocaleTimeString('pt-BR'),
                    timestamp: agora.getTime()
                };
                
                atualizar('registrosPonto', [...dados.registrosPonto, novoRegistro]);
                
                // Libera bot√£o ap√≥s 1 segundo
                setTimeout(() => {
                    setRegistrando(false);
                    alert('Ponto registrado com sucesso!');
                }, 1000);
            };

            const salvarEdicao = (registro) => {
                atualizar('registrosPonto', dados.registrosPonto.map(r => r.id === registro.id ? registro : r));
                setEditando(null);
            };

            const excluirRegistro = (id) => {
                if (confirm('Excluir este registro?')) {
                    atualizar('registrosPonto', dados.registrosPonto.filter(r => r.id !== id));
                }
            };

            const gerarPDF = () => {
                const registrosFiltrados = filtrarRegistros();
                if (registrosFiltrados.length === 0) {
                    alert('Nenhum registro para gerar PDF');
                    return;
                }

                const funcionario = dados.funcionarios.find(f => f.id === parseInt(filtros.funcionarioId));
                const empresa = dados.empresas.find(e => e.id === funcionario?.empresaId);

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                // Cabe√ßalho
                doc.setFontSize(16);
                doc.text(empresa?.razaoSocial || 'Empresa', 105, 20, { align: 'center' });
                doc.setFontSize(10);
                doc.text(`CNPJ: ${empresa?.cnpj || ''}`, 105, 27, { align: 'center' });
                doc.text(`${empresa?.endereco || ''}, ${empresa?.cidade || ''}/${empresa?.estado || ''}`, 105, 32, { align: 'center' });

                doc.setFontSize(14);
                doc.text('REGISTRO DE PONTO', 105, 45, { align: 'center' });

                // Dados do funcion√°rio
                doc.setFontSize(10);
                doc.text(`Funcion√°rio: ${funcionario?.nome || ''}`, 20, 55);
                doc.text(`CPF: ${funcionario?.cpf || ''}`, 20, 61);
                doc.text(`Cargo: ${funcionario?.cargo || ''}`, 20, 67);
                doc.text(`Per√≠odo: ${filtros.dataInicio ? formatarData(filtros.dataInicio) : ''} a ${filtros.dataFim ? formatarData(filtros.dataFim) : ''}`, 20, 73);

                // Tabela de registros
                let y = 85;
                doc.setFontSize(9);
                doc.setFont(undefined, 'bold');
                doc.text('Data', 20, y);
                doc.text('Tipo', 60, y);
                doc.text('Hora', 120, y);

                doc.setFont(undefined, 'normal');
                registrosFiltrados.forEach((reg, i) => {
                    y += 7;
                    if (y > 270) {
                        doc.addPage();
                        y = 20;
                    }
                    doc.text(formatarData(reg.data), 20, y);
                    doc.text(reg.tipo, 60, y);
                    doc.text(reg.hora, 120, y);
                });

                doc.save(`ponto_${funcionario?.nome}_${new Date().toISOString().split('T')[0]}.pdf`);
            };

            const filtrarRegistros = () => {
                let registros = dados.registrosPonto;
                if (usuarioLogado.tipo !== 'admin') {
                    registros = registros.filter(r => r.funcionarioId === usuarioLogado.id);
                } else {
                    if (filtros.funcionarioId) registros = registros.filter(r => r.funcionarioId === parseInt(filtros.funcionarioId));
                    if (filtros.dataInicio) registros = registros.filter(r => r.data >= filtros.dataInicio);
                    if (filtros.dataFim) registros = registros.filter(r => r.data <= filtros.dataFim);
                }
                return registros.sort((a, b) => b.timestamp - a.timestamp);
            };

            const registrosFiltrados = filtrarRegistros();
            const registrosHoje = registrosFiltrados.filter(r => r.data === dataRegistro);

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Registro de Jornada</h2>
                        <div className="text-sm text-gray-500">
                            <i className="fas fa-sync-alt mr-2"></i>
                            Sincroniza√ß√£o autom√°tica ativa
                        </div>
                    </div>

                    {usuarioLogado.tipo === 'admin' && (
                        <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                            <h3 className="text-lg font-bold mb-4">Filtros</h3>
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div>
                                    <label className="block mb-2 font-medium">Funcion√°rio</label>
                                    <select value={filtros.funcionarioId} onChange={(e) => setFiltros({...filtros, funcionarioId: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                        <option value="">Todos</option>
                                        {dados.funcionarios.map(func => <option key={func.id} value={func.id}>{func.nome}</option>)}
                                    </select>
                                </div>
                                <div>
                                    <label className="block mb-2 font-medium">Data In√≠cio</label>
                                    <input type="date" value={filtros.dataInicio} onChange={(e) => setFiltros({...filtros, dataInicio: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                                <div>
                                    <label className="block mb-2 font-medium">Data Fim</label>
                                    <input type="date" value={filtros.dataFim} onChange={(e) => setFiltros({...filtros, dataFim: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                                <div className="flex items-end gap-2">
                                    <button onClick={gerarPDF} className="flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">
                                        <i className="fas fa-file-pdf mr-2"></i>Gerar PDF
                                    </button>
                                    <button onClick={() => setMostrarForm(true)} className="flex-1 bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600">
                                        <i className="fas fa-plus mr-2"></i>Novo
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {mostrarForm && usuarioLogado.tipo === 'admin' && (
                        <FormRegistroPonto 
                            funcionarios={dados.funcionarios}
                            onSalvar={(reg) => {
                                const timestamp = new Date().getTime();
                                const idUnico = `${timestamp}_${Math.random().toString(36).substr(2, 9)}`;
                                atualizar('registrosPonto', [...dados.registrosPonto, { 
                                    ...reg, 
                                    id: idUnico, 
                                    timestamp 
                                }]);
                                setMostrarForm(false);
                            }}
                            onCancelar={() => setMostrarForm(false)}
                        />
                    )}

                    {usuarioLogado.tipo !== 'admin' && (
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Registrar Ponto</h3>
                                <div className="mb-4">
                                    <label className="block mb-2 font-medium">Data</label>
                                    <input type="date" value={dataRegistro} onChange={(e) => setDataRegistro(e.target.value)} className="w-full px-4 py-2 border rounded-lg" disabled={registrando} />
                                </div>
                                {registrando && (
                                    <div className="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-800 text-center">
                                        <i className="fas fa-spinner fa-spin mr-2"></i>
                                        Processando registro...
                                    </div>
                                )}
                                <div className="grid grid-cols-2 gap-4">
                                    <button onClick={() => registrarPonto('Entrada')} disabled={registrando} className={`px-6 py-4 rounded-lg ${registrando ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700'} text-white`}>
                                        <i className="fas fa-sign-in-alt text-2xl mb-2 block"></i>Entrada
                                    </button>
                                    <button onClick={() => registrarPonto('Sa√≠da Intervalo')} disabled={registrando} className={`px-6 py-4 rounded-lg ${registrando ? 'bg-gray-400 cursor-not-allowed' : 'bg-yellow-600 hover:bg-yellow-700'} text-white`}>
                                        <i className="fas fa-utensils text-2xl mb-2 block"></i>Sa√≠da Intervalo
                                    </button>
                                    <button onClick={() => registrarPonto('Retorno Intervalo')} disabled={registrando} className={`px-6 py-4 rounded-lg ${registrando ? 'bg-gray-400 cursor-not-allowed' : 'bg-primary-500 hover:bg-primary-600'} text-white`}>
                                        <i className="fas fa-undo text-2xl mb-2 block"></i>Retorno
                                    </button>
                                    <button onClick={() => registrarPonto('Sa√≠da')} disabled={registrando} className={`px-6 py-4 rounded-lg ${registrando ? 'bg-gray-400 cursor-not-allowed' : 'bg-red-600 hover:bg-red-700'} text-white`}>
                                        <i className="fas fa-sign-out-alt text-2xl mb-2 block"></i>Sa√≠da
                                    </button>
                                </div>
                            </div>

                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <h3 className="text-xl font-bold mb-4">Registros de Hoje</h3>
                                <div className="space-y-2 max-h-64 overflow-y-auto">
                                    {registrosHoje.length === 0 ? (
                                        <p className="text-gray-500 text-center py-8">Nenhum registro hoje</p>
                                    ) : (
                                        registrosHoje.map(reg => (
                                            <div key={reg.id} className="flex justify-between items-center p-3 bg-gray-50 rounded">
                                                <span className={`px-2 py-1 rounded text-xs ${
                                                    reg.tipo === 'Entrada' ? 'bg-green-100 text-green-800' :
                                                    reg.tipo === 'Sa√≠da' ? 'bg-red-100 text-red-800' :
                                                    'bg-yellow-100 text-yellow-800'
                                                }`}>{reg.tipo}</span>
                                                <span className="font-bold text-lg">{reg.hora}</span>
                                            </div>
                                        ))
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h3 className="text-xl font-bold mb-4">Hist√≥rico de Registros</h3>
                        <div className="overflow-x-auto">
                            <table className="w-full">
                                <thead className="bg-gray-50"><tr>
                                    <th className="text-left p-3">Data</th>
                                    <th className="text-left p-3">Hora</th>
                                    <th className="text-left p-3">Tipo</th>
                                    {usuarioLogado.tipo === 'admin' && <th className="text-left p-3">Funcion√°rio</th>}
                                    {usuarioLogado.tipo === 'admin' && <th className="text-center p-3">A√ß√µes</th>}
                                </tr></thead>
                                <tbody>
                                    {registrosFiltrados.map(reg => (
                                        <tr key={reg.id} className="border-b hover:bg-gray-50">
                                            {editando?.id === reg.id ? (
                                                <>
                                                    <td className="p-3"><input type="date" value={editando.data} onChange={(e) => setEditando({...editando, data: e.target.value})} className="border rounded px-2 py-1" /></td>
                                                    <td className="p-3"><input type="time" value={editando.hora} onChange={(e) => setEditando({...editando, hora: e.target.value})} className="border rounded px-2 py-1" /></td>
                                                    <td className="p-3">
                                                        <select value={editando.tipo} onChange={(e) => setEditando({...editando, tipo: e.target.value})} className="border rounded px-2 py-1">
                                                            <option value="Entrada">Entrada</option>
                                                            <option value="Sa√≠da Intervalo">Sa√≠da Intervalo</option>
                                                            <option value="Retorno Intervalo">Retorno Intervalo</option>
                                                            <option value="Sa√≠da">Sa√≠da</option>
                                                        </select>
                                                    </td>
                                                    {usuarioLogado.tipo === 'admin' && <td className="p-3">{dados.funcionarios.find(f => f.id === reg.funcionarioId)?.nome}</td>}
                                                    <td className="p-3">
                                                        <button onClick={() => salvarEdicao(editando)} className="text-green-600 hover:text-green-800 mr-2"><i className="fas fa-check"></i></button>
                                                        <button onClick={() => setEditando(null)} className="text-gray-600 hover:text-gray-800"><i className="fas fa-times"></i></button>
                                                    </td>
                                                </>
                                            ) : (
                                                <>
                                                    <td className="p-3">{formatarData(reg.data)}</td>
                                                    <td className="p-3 font-bold">{reg.hora}</td>
                                                    <td className="p-3">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            reg.tipo === 'Entrada' ? 'bg-green-100 text-green-800' :
                                                            reg.tipo === 'Sa√≠da' ? 'bg-red-100 text-red-800' :
                                                            'bg-yellow-100 text-yellow-800'
                                                        }`}>{reg.tipo}</span>
                                                    </td>
                                                    {usuarioLogado.tipo === 'admin' && <td className="p-3">{dados.funcionarios.find(f => f.id === reg.funcionarioId)?.nome}</td>}
                                                    {usuarioLogado.tipo === 'admin' && (
                                                        <td className="p-3 text-center">
                                                            <button onClick={() => setEditando(reg)} className="text-primary-500 hover:text-primary-700 mr-2"><i className="fas fa-edit"></i></button>
                                                            <button onClick={() => excluirRegistro(reg.id)} className="text-red-600 hover:text-red-800"><i className="fas fa-trash"></i></button>
                                                        </td>
                                                    )}
                                                </>
                                            )}
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        // Form Registro Ponto (admin criar registro manualmente)
        function FormRegistroPonto({ funcionarios, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState({
                funcionarioId: '',
                tipo: 'Entrada',
                data: new Date().toISOString().split('T')[0],
                hora: new Date().toTimeString().slice(0, 5)
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.funcionarioId) {
                    alert('Selecione um funcion√°rio');
                    return;
                }
                onSalvar(formData);
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">Novo Registro de Ponto</h3>
                    <form onSubmit={handleSubmit}>
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div>
                                <label className="block mb-2 font-medium">Funcion√°rio *</label>
                                <select value={formData.funcionarioId} onChange={(e) => setFormData({...formData, funcionarioId: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="">Selecione</option>
                                    {funcionarios.map(func => <option key={func.id} value={func.id}>{func.nome}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Tipo *</label>
                                <select value={formData.tipo} onChange={(e) => setFormData({...formData, tipo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Entrada">Entrada</option>
                                    <option value="Sa√≠da Intervalo">Sa√≠da Intervalo</option>
                                    <option value="Retorno Intervalo">Retorno Intervalo</option>
                                    <option value="Sa√≠da">Sa√≠da</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data *</label>
                                <input type="date" value={formData.data} onChange={(e) => setFormData({...formData, data: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Hora *</label>
                                <input type="time" value={formData.hora} onChange={(e) => setFormData({...formData, hora: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // Continua pr√≥ximo bloco...
        // F√âRIAS - Com solicita√ß√µes, aprova√ß√µes, hist√≥rico e fluxo de modifica√ß√£o
        function Ferias({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [mostrarFormHistorico, setMostrarFormHistorico] = useState(false);
            const [mostrarModalModificar, setMostrarModalModificar] = useState(false);
            const [solicitacaoModificar, setSolicitacaoModificar] = useState(null);
            const [abaAtiva, setAbaAtiva] = useState('solicitacoes');

            const solicitarFerias = (solicitacao) => {
                atualizar('solicitacoesFerias', [...dados.solicitacoesFerias, { 
                    ...solicitacao, 
                    id: Date.now(), 
                    status: 'Pendente',
                    dataSolicitacao: new Date().toISOString()
                }]);
                setMostrarForm(false);
            };

            const salvarHistorico = (registro) => {
                const historico = dados.historicoFerias || [];
                atualizar('historicoFerias', [...historico, { ...registro, id: Date.now() }]);
                setMostrarFormHistorico(false);
            };

            const aprovarRejeitar = (id, novoStatus) => {
                const solicitacaoAtual = dados.solicitacoesFerias.find(s => s.id === id);
                atualizar('solicitacoesFerias', dados.solicitacoesFerias.map(s => s.id === id ? {...s, status: novoStatus} : s));
                
                // Se aprovado, adicionar ao hist√≥rico automaticamente
                if (novoStatus === 'Aprovado' && solicitacaoAtual) {
                    const historico = dados.historicoFerias || [];
                    atualizar('historicoFerias', [...historico, {
                        id: Date.now(),
                        funcionarioId: solicitacaoAtual.funcionarioId,
                        dataInicio: solicitacaoAtual.dataInicio,
                        dataFim: solicitacaoAtual.dataFim,
                        periodo: solicitacaoAtual.periodo,
                        formaPagamento: solicitacaoAtual.formaPagamento,
                        observacao: 'Aprovado via solicita√ß√£o',
                        dataRegistro: new Date().toISOString()
                    }]);
                }
            };

            const abrirModalModificar = (solicitacao) => {
                setSolicitacaoModificar({ ...solicitacao });
                setMostrarModalModificar(true);
            };

            const enviarModificacao = () => {
                if (solicitacaoModificar) {
                    atualizar('solicitacoesFerias', dados.solicitacoesFerias.map(s => 
                        s.id === solicitacaoModificar.id 
                            ? {...solicitacaoModificar, status: 'Aguardando Aceite', dataModificacao: new Date().toISOString()} 
                            : s
                    ));
                    setMostrarModalModificar(false);
                    setSolicitacaoModificar(null);
                }
            };

            const aceitarModificacao = (id) => {
                const solicitacaoAtual = dados.solicitacoesFerias.find(s => s.id === id);
                atualizar('solicitacoesFerias', dados.solicitacoesFerias.map(s => s.id === id ? {...s, status: 'Aprovado', aceiteEm: new Date().toISOString()} : s));
                
                // Adicionar ao hist√≥rico
                if (solicitacaoAtual) {
                    const historico = dados.historicoFerias || [];
                    atualizar('historicoFerias', [...historico, {
                        id: Date.now(),
                        funcionarioId: solicitacaoAtual.funcionarioId,
                        dataInicio: solicitacaoAtual.dataInicio,
                        dataFim: solicitacaoAtual.dataFim,
                        periodo: solicitacaoAtual.periodo,
                        formaPagamento: solicitacaoAtual.formaPagamento,
                        observacao: 'Datas modificadas pelo admin e aceitas',
                        dataRegistro: new Date().toISOString()
                    }]);
                }
            };

            const rejeitarModificacao = (id) => {
                atualizar('solicitacoesFerias', dados.solicitacoesFerias.map(s => s.id === id ? {...s, status: 'Pendente', dataModificacao: null} : s));
            };

            const minhasSolicitacoes = dados.solicitacoesFerias.filter(s => s.funcionarioId === usuarioLogado.id);
            const todasSolicitacoes = dados.solicitacoesFerias;
            const historicoFerias = dados.historicoFerias || [];

            const meusDados = dados.funcionarios.find(f => f.id === usuarioLogado.id);
            const feriasInfo = meusDados ? calcularDiasFerias(meusDados.dataAdmissao) : null;

            // Calcular f√©rias j√° tiradas
            const meuHistorico = historicoFerias.filter(h => h.funcionarioId === usuarioLogado.id);
            const diasUsados = meuHistorico.reduce((acc, h) => {
                const inicio = new Date(h.dataInicio);
                const fim = new Date(h.dataFim);
                const dias = Math.ceil((fim - inicio) / (1000 * 60 * 60 * 24)) + 1;
                return acc + dias;
            }, 0);

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Gest√£o de F√©rias</h2>
                        <div className="flex gap-2">
                            {usuarioLogado.tipo !== 'admin' && (
                                <button onClick={() => setMostrarForm(true)} className="bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600">
                                    <i className="fas fa-plus mr-2"></i>Nova Solicita√ß√£o
                                </button>
                            )}
                            {usuarioLogado.tipo === 'admin' && (
                                <button onClick={() => setMostrarFormHistorico(true)} className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">
                                    <i className="fas fa-history mr-2"></i>Registrar Hist√≥rico
                                </button>
                            )}
                        </div>
                    </div>

                    {usuarioLogado.tipo !== 'admin' && feriasInfo && (
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-primary-500">
                                <p className="text-gray-600 text-sm">Pr√≥ximo Vencimento</p>
                                <p className="text-xl font-bold text-gray-800">{formatarData(feriasInfo.dataVencimento)}</p>
                            </div>
                            <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-green-500">
                                <p className="text-gray-600 text-sm">Meses Restantes</p>
                                <p className="text-xl font-bold text-gray-800">{feriasInfo.mesesRestantes} meses</p>
                            </div>
                            <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-purple-500">
                                <p className="text-gray-600 text-sm">Direito Total</p>
                                <p className="text-xl font-bold text-gray-800">30 dias</p>
                            </div>
                            <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-orange-500">
                                <p className="text-gray-600 text-sm">Dias Usados</p>
                                <p className="text-xl font-bold text-gray-800">{diasUsados} dias</p>
                            </div>
                        </div>
                    )}

                    <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-6">
                        <div className="flex">
                            <i className="fas fa-info-circle text-yellow-500 mt-1 mr-3"></i>
                            <div>
                                <h4 className="font-bold">F√©rias Coletivas</h4>
                                <p className="text-sm">15 dias em dezembro (coletivo) + 15 dias de livre escolha dentro do ano</p>
                            </div>
                        </div>
                    </div>

                    {mostrarForm && (
                        <FormFerias funcionarioId={usuarioLogado.id} onSalvar={solicitarFerias} onCancelar={() => setMostrarForm(false)} />
                    )}

                    {mostrarFormHistorico && (
                        <FormHistoricoFerias funcionarios={dados.funcionarios} onSalvar={salvarHistorico} onCancelar={() => setMostrarFormHistorico(false)} />
                    )}

                    {/* Modal Modificar Datas */}
                    {mostrarModalModificar && solicitacaoModificar && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-xl p-6 w-full max-w-lg mx-4">
                                <h3 className="text-xl font-bold mb-4">Modificar Datas da Solicita√ß√£o</h3>
                                <p className="text-gray-600 mb-4">As novas datas ser√£o enviadas ao funcion√°rio para aceite.</p>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block mb-2 font-medium">Nova Data In√≠cio</label>
                                        <input type="date" value={solicitacaoModificar.dataInicio} 
                                            onChange={(e) => setSolicitacaoModificar({...solicitacaoModificar, dataInicio: e.target.value})} 
                                            className="w-full px-4 py-2 border rounded-lg" />
                                    </div>
                                    <div>
                                        <label className="block mb-2 font-medium">Nova Data Fim</label>
                                        <input type="date" value={solicitacaoModificar.dataFim} 
                                            onChange={(e) => setSolicitacaoModificar({...solicitacaoModificar, dataFim: e.target.value})} 
                                            className="w-full px-4 py-2 border rounded-lg" />
                                    </div>
                                    <div>
                                        <label className="block mb-2 font-medium">Motivo da Altera√ß√£o</label>
                                        <textarea 
                                            value={solicitacaoModificar.motivoAlteracao || ''} 
                                            onChange={(e) => setSolicitacaoModificar({...solicitacaoModificar, motivoAlteracao: e.target.value})} 
                                            className="w-full px-4 py-2 border rounded-lg" 
                                            rows="3"
                                            placeholder="Explique o motivo da altera√ß√£o..."
                                        />
                                    </div>
                                </div>
                                <div className="flex gap-4 mt-6">
                                    <button onClick={enviarModificacao} className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                                        <i className="fas fa-paper-plane mr-2"></i>Enviar para Aceite
                                    </button>
                                    <button onClick={() => { setMostrarModalModificar(false); setSolicitacaoModificar(null); }} 
                                        className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Abas */}
                    <div className="flex gap-2 mb-4">
                        <button 
                            onClick={() => setAbaAtiva('solicitacoes')} 
                            className={`px-4 py-2 rounded-lg font-medium ${abaAtiva === 'solicitacoes' ? 'bg-primary-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                        >
                            <i className="fas fa-clipboard-list mr-2"></i>Solicita√ß√µes
                        </button>
                        <button 
                            onClick={() => setAbaAtiva('historico')} 
                            className={`px-4 py-2 rounded-lg font-medium ${abaAtiva === 'historico' ? 'bg-primary-500 text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}
                        >
                            <i className="fas fa-history mr-2"></i>Hist√≥rico de F√©rias
                        </button>
                    </div>

                    {/* Aba Solicita√ß√µes */}
                    {abaAtiva === 'solicitacoes' && (
                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4">{usuarioLogado.tipo === 'admin' ? 'Todas as Solicita√ß√µes' : 'Minhas Solicita√ß√µes'}</h3>
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-gray-50"><tr>
                                        {usuarioLogado.tipo === 'admin' && <th className="text-left p-3">Funcion√°rio</th>}
                                        <th className="text-left p-3">Per√≠odo</th>
                                        <th className="text-left p-3">Data In√≠cio</th>
                                        <th className="text-left p-3">Data Fim</th>
                                        <th className="text-left p-3">Pagamento</th>
                                        <th className="text-left p-3">Status</th>
                                        <th className="text-center p-3">A√ß√µes</th>
                                    </tr></thead>
                                    <tbody>
                                        {(usuarioLogado.tipo === 'admin' ? todasSolicitacoes : minhasSolicitacoes).map(sol => {
                                            const func = dados.funcionarios.find(f => f.id === sol.funcionarioId);
                                            return (
                                                <tr key={sol.id} className="border-b hover:bg-gray-50">
                                                    {usuarioLogado.tipo === 'admin' && <td className="p-3">{func?.nome}</td>}
                                                    <td className="p-3">{sol.periodo}</td>
                                                    <td className="p-3">{formatarData(sol.dataInicio)}</td>
                                                    <td className="p-3">{formatarData(sol.dataFim)}</td>
                                                    <td className="p-3">
                                                        <span className="text-xs">{sol.formaPagamento || 'N√£o informado'}</span>
                                                    </td>
                                                    <td className="p-3">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            sol.status === 'Aprovado' ? 'bg-green-100 text-green-800' :
                                                            sol.status === 'Rejeitado' ? 'bg-red-100 text-red-800' :
                                                            sol.status === 'Aguardando Aceite' ? 'bg-blue-100 text-blue-800' :
                                                            'bg-yellow-100 text-yellow-800'
                                                        }`}>{sol.status}</span>
                                                        {sol.motivoAlteracao && sol.status === 'Aguardando Aceite' && (
                                                            <p className="text-xs text-gray-500 mt-1">Motivo: {sol.motivoAlteracao}</p>
                                                        )}
                                                    </td>
                                                    <td className="p-3 text-center">
                                                        {/* A√ß√µes do Admin */}
                                                        {usuarioLogado.tipo === 'admin' && sol.status === 'Pendente' && (
                                                            <div className="flex justify-center gap-1">
                                                                <button onClick={() => aprovarRejeitar(sol.id, 'Aprovado')} className="text-green-600 hover:text-green-800 p-1" title="Aprovar">
                                                                    <i className="fas fa-check"></i>
                                                                </button>
                                                                <button onClick={() => abrirModalModificar(sol)} className="text-blue-600 hover:text-blue-800 p-1" title="Modificar Datas">
                                                                    <i className="fas fa-edit"></i>
                                                                </button>
                                                                <button onClick={() => aprovarRejeitar(sol.id, 'Rejeitado')} className="text-red-600 hover:text-red-800 p-1" title="Rejeitar">
                                                                    <i className="fas fa-times"></i>
                                                                </button>
                                                            </div>
                                                        )}
                                                        {/* A√ß√µes do Funcion√°rio quando admin modifica */}
                                                        {usuarioLogado.tipo !== 'admin' && sol.status === 'Aguardando Aceite' && (
                                                            <div className="flex justify-center gap-1">
                                                                <button onClick={() => aceitarModificacao(sol.id)} className="bg-green-500 text-white px-2 py-1 rounded text-xs hover:bg-green-600">
                                                                    <i className="fas fa-check mr-1"></i>Aceitar
                                                                </button>
                                                                <button onClick={() => rejeitarModificacao(sol.id)} className="bg-red-500 text-white px-2 py-1 rounded text-xs hover:bg-red-600">
                                                                    <i className="fas fa-times mr-1"></i>Recusar
                                                                </button>
                                                            </div>
                                                        )}
                                                        {(sol.status === 'Aprovado' || sol.status === 'Rejeitado') && '-'}
                                                        {usuarioLogado.tipo === 'admin' && sol.status === 'Aguardando Aceite' && (
                                                            <span className="text-xs text-blue-600">Aguardando funcion√°rio</span>
                                                        )}
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                        {(usuarioLogado.tipo === 'admin' ? todasSolicitacoes : minhasSolicitacoes).length === 0 && (
                                            <tr><td colSpan="7" className="p-4 text-center text-gray-500">Nenhuma solicita√ß√£o encontrada</td></tr>
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}

                    {/* Aba Hist√≥rico */}
                    {abaAtiva === 'historico' && (
                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Hist√≥rico de F√©rias</h3>
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-gray-50"><tr>
                                        {usuarioLogado.tipo === 'admin' && <th className="text-left p-3">Funcion√°rio</th>}
                                        <th className="text-left p-3">Per√≠odo</th>
                                        <th className="text-left p-3">Data In√≠cio</th>
                                        <th className="text-left p-3">Data Fim</th>
                                        <th className="text-left p-3">Dias</th>
                                        <th className="text-left p-3">Pagamento</th>
                                        <th className="text-left p-3">Observa√ß√£o</th>
                                    </tr></thead>
                                    <tbody>
                                        {(usuarioLogado.tipo === 'admin' ? historicoFerias : meuHistorico).map(h => {
                                            const func = dados.funcionarios.find(f => f.id === h.funcionarioId);
                                            const inicio = new Date(h.dataInicio);
                                            const fim = new Date(h.dataFim);
                                            const dias = Math.ceil((fim - inicio) / (1000 * 60 * 60 * 24)) + 1;
                                            return (
                                                <tr key={h.id} className="border-b hover:bg-gray-50">
                                                    {usuarioLogado.tipo === 'admin' && <td className="p-3">{func?.nome}</td>}
                                                    <td className="p-3">{h.periodo || '-'}</td>
                                                    <td className="p-3">{formatarData(h.dataInicio)}</td>
                                                    <td className="p-3">{formatarData(h.dataFim)}</td>
                                                    <td className="p-3"><span className="bg-primary-100 text-primary-700 px-2 py-1 rounded text-xs">{dias} dias</span></td>
                                                    <td className="p-3 text-xs">{h.formaPagamento || '-'}</td>
                                                    <td className="p-3 text-sm text-gray-600">{h.observacao || '-'}</td>
                                                </tr>
                                            );
                                        })}
                                        {(usuarioLogado.tipo === 'admin' ? historicoFerias : meuHistorico).length === 0 && (
                                            <tr><td colSpan="7" className="p-4 text-center text-gray-500">Nenhum hist√≥rico encontrado</td></tr>
                                        )}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Formul√°rio de Solicita√ß√£o de F√©rias
        function FormFerias({ funcionarioId, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState({ 
                funcionarioId, 
                periodo: '15 dias (livre escolha)', 
                dataInicio: '', 
                dataFim: '', 
                observacao: '',
                formaPagamento: 'integral_primeira'
            });

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">Solicitar F√©rias</h3>
                    <form onSubmit={(e) => { e.preventDefault(); onSalvar(formData); }}>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label className="block mb-2 font-medium">Per√≠odo</label>
                                <select value={formData.periodo} onChange={(e) => setFormData({...formData, periodo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="15 dias (livre escolha)">15 dias (livre escolha)</option>
                                    <option value="30 dias">30 dias (15 coletivo + 15 livre)</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data In√≠cio</label>
                                <input type="date" value={formData.dataInicio} onChange={(e) => setFormData({...formData, dataInicio: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data Fim</label>
                                <input type="date" value={formData.dataFim} onChange={(e) => setFormData({...formData, dataFim: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Observa√ß√£o</label>
                                <input type="text" value={formData.observacao} onChange={(e) => setFormData({...formData, observacao: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div className="md:col-span-2">
                                <label className="block mb-2 font-medium">Forma de Recebimento das F√©rias</label>
                                <div className="space-y-2">
                                    <label className="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                                        <input 
                                            type="radio" 
                                            name="formaPagamento" 
                                            value="integral_primeira" 
                                            checked={formData.formaPagamento === 'integral_primeira'}
                                            onChange={(e) => setFormData({...formData, formaPagamento: e.target.value})}
                                            className="mr-3"
                                        />
                                        <div>
                                            <p className="font-medium">Integral na 1¬™ Quinzena de F√©rias</p>
                                            <p className="text-sm text-gray-500">Receber o valor total das f√©rias na primeira quinzena das f√©rias</p>
                                        </div>
                                    </label>
                                    <label className="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                                        <input 
                                            type="radio" 
                                            name="formaPagamento" 
                                            value="integral_segunda" 
                                            checked={formData.formaPagamento === 'integral_segunda'}
                                            onChange={(e) => setFormData({...formData, formaPagamento: e.target.value})}
                                            className="mr-3"
                                        />
                                        <div>
                                            <p className="font-medium">Integral na 2¬™ Quinzena de F√©rias</p>
                                            <p className="text-sm text-gray-500">Receber o valor total das f√©rias na segunda quinzena das f√©rias</p>
                                        </div>
                                    </label>
                                    <label className="flex items-center p-3 border rounded-lg hover:bg-gray-50 cursor-pointer">
                                        <input 
                                            type="radio" 
                                            name="formaPagamento" 
                                            value="dividido" 
                                            checked={formData.formaPagamento === 'dividido'}
                                            onChange={(e) => setFormData({...formData, formaPagamento: e.target.value})}
                                            className="mr-3"
                                        />
                                        <div>
                                            <p className="font-medium">Dividido nas Quinzenas</p>
                                            <p className="text-sm text-gray-500">Receber 50% na primeira e 50% na segunda quinzena</p>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600"><i className="fas fa-paper-plane mr-2"></i>Enviar Solicita√ß√£o</button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // Formul√°rio para Admin registrar hist√≥rico de f√©rias
        function FormHistoricoFerias({ funcionarios, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState({
                funcionarioId: '',
                periodo: 'Registro anterior',
                dataInicio: '',
                dataFim: '',
                formaPagamento: 'N√£o informado',
                observacao: ''
            });

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4"><i className="fas fa-history mr-2 text-green-600"></i>Registrar F√©rias Anteriores</h3>
                    <p className="text-gray-600 mb-4">Use este formul√°rio para registrar f√©rias que o funcion√°rio j√° tirou antes do sistema.</p>
                    <form onSubmit={(e) => { e.preventDefault(); if (!formData.funcionarioId) { alert('Selecione um funcion√°rio'); return; } onSalvar(formData); }}>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div className="md:col-span-2">
                                <label className="block mb-2 font-medium">Funcion√°rio *</label>
                                <select value={formData.funcionarioId} onChange={(e) => setFormData({...formData, funcionarioId: parseInt(e.target.value)})} className="w-full px-4 py-2 border rounded-lg" required>
                                    <option value="">Selecione um funcion√°rio</option>
                                    {funcionarios.map(f => <option key={f.id} value={f.id}>{f.nome} - {f.cpf}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data In√≠cio *</label>
                                <input type="date" value={formData.dataInicio} onChange={(e) => setFormData({...formData, dataInicio: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Data Fim *</label>
                                <input type="date" value={formData.dataFim} onChange={(e) => setFormData({...formData, dataFim: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Tipo de Per√≠odo</label>
                                <select value={formData.periodo} onChange={(e) => setFormData({...formData, periodo: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Registro anterior">Registro anterior</option>
                                    <option value="15 dias (livre escolha)">15 dias (livre escolha)</option>
                                    <option value="15 dias (coletivo)">15 dias (coletivo)</option>
                                    <option value="30 dias">30 dias</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Forma de Pagamento</label>
                                <select value={formData.formaPagamento} onChange={(e) => setFormData({...formData, formaPagamento: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="N√£o informado">N√£o informado</option>
                                    <option value="Integral na 1¬™ Quinzena">Integral na 1¬™ Quinzena</option>
                                    <option value="Integral na 2¬™ Quinzena">Integral na 2¬™ Quinzena</option>
                                    <option value="Dividido nas Quinzenas">Dividido nas Quinzenas</option>
                                </select>
                            </div>
                            <div className="md:col-span-2">
                                <label className="block mb-2 font-medium">Observa√ß√£o</label>
                                <textarea value={formData.observacao} onChange={(e) => setFormData({...formData, observacao: e.target.value})} className="w-full px-4 py-2 border rounded-lg" rows="2" placeholder="Ex: F√©rias referentes ao per√≠odo 2023/2024" />
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"><i className="fas fa-save mr-2"></i>Salvar Hist√≥rico</button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // FERIADOS - Com pontos facultativos
        function Feriados({ dados, atualizar, usuarioLogado }) {
            const [ano, setAno] = useState(new Date().getFullYear());

            const marcarPontoFacultativo = (data) => {
                const existe = dados.feriadosPontoFacultativo.find(f => f.data === data);
                if (existe) {
                    atualizar('feriadosPontoFacultativo', dados.feriadosPontoFacultativo.filter(f => f.data !== data));
                } else {
                    atualizar('feriadosPontoFacultativo', [...dados.feriadosPontoFacultativo, { data, ano, id: Date.now() }]);
                }
            };

            const hoje = new Date().toISOString().split('T')[0];
            const feriados = { ...FERIADOS_NACIONAIS_2025, ...FERIADOS_NACIONAIS_2026 };
            const feriadosDoAno = Object.entries(feriados).filter(([data]) => data.startsWith(ano.toString()));
            const diasSemExpediente = dados.feriadosPontoFacultativo.filter(f => f.ano === ano);

            // Verificar feriados pr√≥ximos (5 dias)
            const dataLimite = new Date();
            dataLimite.setDate(dataLimite.getDate() + 5);
            const feriadosProximos = diasSemExpediente.filter(f => {
                const dataFeriado = new Date(f.data);
                return dataFeriado >= new Date() && dataFeriado <= dataLimite;
            });

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Feriados e Pontos Facultativos</h2>

                    {feriadosProximos.length > 0 && (
                        <div className="bg-red-50 border-l-4 border-red-500 p-4 mb-6">
                            <div className="flex">
                                <i className="fas fa-exclamation-triangle text-red-500 mt-1 mr-3"></i>
                                <div>
                                    <h4 className="font-bold">Aten√ß√£o! Dias sem expediente pr√≥ximos:</h4>
                                    {feriadosProximos.map(f => (
                                        <p key={f.id} className="text-sm">{formatarData(f.data)} - Sem expediente (emenda de feriado)</p>
                                    ))}
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-white p-4 rounded-lg shadow mb-6">
                        <label className="block mb-2 font-medium">Selecionar Ano</label>
                        <select value={ano} onChange={(e) => setAno(parseInt(e.target.value))} className="px-4 py-2 border rounded-lg">
                            <option value={2024}>2024</option>
                            <option value={2025}>2025</option>
                            <option value={2026}>2026</option>
                        </select>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Feriados Nacionais {ano}</h3>
                            <div className="space-y-2">
                                {feriadosDoAno.map(([data, nome]) => (
                                    <div key={data} className="flex items-center justify-between p-3 bg-primary-50 rounded">
                                        <div>
                                            <p className="font-medium">{nome}</p>
                                            <p className="text-sm text-gray-600">{formatarData(data)}</p>
                                        </div>
                                        <i className="fas fa-calendar-day text-primary-500"></i>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4">Pontos Facultativos / Sem Expediente</h3>
                            {usuarioLogado.tipo === 'admin' && (
                                <div className="mb-4">
                                    <label className="block mb-2 font-medium">Marcar data sem expediente</label>
                                    <input type="date" onChange={(e) => marcarPontoFacultativo(e.target.value)} className="w-full px-4 py-2 border rounded-lg" />
                                </div>
                            )}
                            <div className="space-y-2">
                                {diasSemExpediente.length === 0 ? (
                                    <p className="text-gray-500 text-center py-4">Nenhum ponto facultativo marcado</p>
                                ) : (
                                    diasSemExpediente.map(f => (
                                        <div key={f.id} className="flex items-center justify-between p-3 bg-yellow-50 rounded">
                                            <div>
                                                <p className="font-medium">Sem expediente (emenda)</p>
                                                <p className="text-sm text-gray-600">{formatarData(f.data)}</p>
                                            </div>
                                            {usuarioLogado.tipo === 'admin' && (
                                                <button onClick={() => marcarPontoFacultativo(f.data)} className="text-red-600 hover:text-red-800">
                                                    <i className="fas fa-times"></i>
                                                </button>
                                            )}
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // AVISOS - Com marca√ß√£o de lido
        function Avisos({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [filtro, setFiltro] = useState('todos');

            const marcarComoLido = (avisoId) => {
                const aviso = dados.avisos.find(a => a.id === avisoId);
                if (aviso) {
                    const lidoPor = aviso.lidoPor || [];
                    if (!lidoPor.includes(usuarioLogado.id)) {
                        atualizar('avisos', dados.avisos.map(a => a.id === avisoId ? {...a, lidoPor: [...lidoPor, usuarioLogado.id]} : a));
                    }
                }
            };

            const salvarAviso = (aviso) => {
                atualizar('avisos', [...dados.avisos, { ...aviso, id: Date.now(), data: new Date().toISOString(), autor: usuarioLogado.nome, lidoPor: [] }]);
                setMostrarForm(false);
            };

            const avisosFiltrados = dados.avisos.filter(a => {
                if (filtro === 'naoLidos') return !a.lidoPor?.includes(usuarioLogado.id);
                if (filtro === 'lidos') return a.lidoPor?.includes(usuarioLogado.id);
                return true;
            }).sort((a, b) => new Date(b.data) - new Date(a.data));

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Avisos e Comunicados</h2>
                        {usuarioLogado.tipo === 'admin' && (
                            <button onClick={() => setMostrarForm(true)} className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">
                                <i className="fas fa-plus mr-2"></i>Novo Aviso
                            </button>
                        )}
                    </div>

                    <div className="bg-white p-4 rounded-lg shadow mb-4">
                        <select value={filtro} onChange={(e) => setFiltro(e.target.value)} className="px-4 py-2 border rounded-lg">
                            <option value="todos">Todos os Avisos</option>
                            <option value="naoLidos">N√£o Lidos</option>
                            <option value="lidos">Lidos</option>
                        </select>
                    </div>

                    {mostrarForm && (
                        <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                            <h3 className="text-xl font-bold mb-4">Criar Novo Aviso</h3>
                            <form onSubmit={(e) => {
                                e.preventDefault();
                                const formData = new FormData(e.target);
                                salvarAviso({ titulo: formData.get('titulo'), tipo: formData.get('tipo'), conteudo: formData.get('conteudo') });
                            }}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block mb-2 font-medium">T√≠tulo</label>
                                        <input type="text" name="titulo" className="w-full px-4 py-2 border rounded-lg" required />
                                    </div>
                                    <div>
                                        <label className="block mb-2 font-medium">Tipo</label>
                                        <select name="tipo" className="w-full px-4 py-2 border rounded-lg">
                                            <option value="info">Informa√ß√£o</option>
                                            <option value="warning">Aten√ß√£o</option>
                                            <option value="success">Sucesso</option>
                                            <option value="error">Urgente</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block mb-2 font-medium">Conte√∫do</label>
                                        <textarea name="conteudo" className="w-full px-4 py-2 border rounded-lg h-32" required></textarea>
                                    </div>
                                    <div className="flex gap-4">
                                        <button type="submit" className="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700">Publicar</button>
                                        <button type="button" onClick={() => setMostrarForm(false)} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    )}

                    <div className="space-y-4">
                        {avisosFiltrados.length === 0 ? (
                            <div className="bg-white p-8 rounded-lg shadow-lg text-center text-gray-500">
                                <i className="fas fa-inbox text-6xl mb-4"></i>
                                <p>Nenhum aviso {filtro === 'naoLidos' ? 'n√£o lido' : filtro === 'lidos' ? 'lido' : ''}</p>
                            </div>
                        ) : (
                            avisosFiltrados.map(aviso => {
                                const lido = aviso.lidoPor?.includes(usuarioLogado.id);
                                return (
                                    <div key={aviso.id} className={`bg-white p-6 rounded-lg shadow-lg border-l-4 ${
                                        aviso.tipo === 'info' ? 'border-primary-500' :
                                        aviso.tipo === 'warning' ? 'border-yellow-500' :
                                        aviso.tipo === 'success' ? 'border-green-500' :
                                        'border-red-500'
                                    } ${!lido ? 'bg-primary-50' : ''}`}>
                                        <div className="flex justify-between items-start mb-3">
                                            <div className="flex-1">
                                                <div className="flex items-center gap-2">
                                                    <h3 className="text-xl font-bold">{aviso.titulo}</h3>
                                                    {!lido && <span className="bg-red-500 text-white text-xs px-2 py-1 rounded">NOVO</span>}
                                                </div>
                                                <p className="text-sm text-gray-500">{aviso.autor} ‚Ä¢ {new Date(aviso.data).toLocaleDateString('pt-BR')}</p>
                                            </div>
                                            <div className="flex gap-2">
                                                {!lido && usuarioLogado.tipo !== 'admin' && (
                                                    <button onClick={() => marcarComoLido(aviso.id)} className="text-green-600 hover:text-green-800">
                                                        <i className="fas fa-check-circle"></i> Marcar como Lido
                                                    </button>
                                                )}
                                                {usuarioLogado.tipo === 'admin' && (
                                                    <button onClick={() => atualizar('avisos', dados.avisos.filter(a => a.id !== aviso.id))} className="text-red-600 hover:text-red-800">
                                                        <i className="fas fa-trash"></i>
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                        <p className="text-gray-700">{aviso.conteudo}</p>
                                    </div>
                                );
                            })
                        )}
                    </div>
                </div>
            );
        }

        // DOCUMENTOS - Upload e visualiza√ß√£o com categorias
        function Documentos({ dados, atualizar, usuarioLogado }) {
            const [mostrarModal, setMostrarModal] = useState(false);
            const [tipoSelecionado, setTipoSelecionado] = useState(null);
            const [uploadando, setUploadando] = useState(false);
            const fileInputRef = useRef(null);

            const handleTipoClick = (tipo) => {
                setTipoSelecionado(tipo);
                setTimeout(() => fileInputRef.current?.click(), 100);
            };

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (file && tipoSelecionado) {
                    setUploadando(true);
                    const reader = new FileReader();
                    reader.onloadend = () => {
                        const novoDoc = {
                            id: Date.now(),
                            funcionarioId: usuarioLogado.tipo === 'admin' ? null : usuarioLogado.id,
                            categoria: tipoSelecionado.id,
                            categoriaNome: tipoSelecionado.nome,
                            nome: file.name,
                            tipo: file.type,
                            tamanho: file.size,
                            data: new Date().toISOString(),
                            arquivo: reader.result
                        };
                        atualizar('documentos', [...dados.documentos, novoDoc]);
                        setUploadando(false);
                        setMostrarModal(false);
                        setTipoSelecionado(null);
                        e.target.value = '';
                    };
                    reader.readAsDataURL(file);
                }
            };

            const baixarDocumento = (doc) => {
                const link = document.createElement('a');
                link.href = doc.arquivo;
                link.download = doc.nome;
                link.click();
            };

            const meusDocumentos = dados.documentos.filter(d => 
                usuarioLogado.tipo === 'admin' || d.funcionarioId === usuarioLogado.id || d.funcionarioId === null
            );

            // Agrupar documentos por categoria
            const documentosPorCategoria = TIPOS_DOCUMENTOS.map(tipo => ({
                ...tipo,
                documentos: meusDocumentos.filter(d => d.categoria === tipo.id)
            }));

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Documentos</h2>
                        <button onClick={() => setMostrarModal(true)} 
                            className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                            <i className="fas fa-plus mr-2"></i>Adicionar Documento
                        </button>
                    </div>

                    <input 
                        type="file" 
                        ref={fileInputRef} 
                        onChange={handleFileUpload} 
                        className="hidden" 
                        accept={tipoSelecionado?.id === 'foto' ? 'image/*' : '*/*'}
                    />

                    {/* Modal de Sele√ß√£o de Tipo */}
                    {mostrarModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-xl p-6 w-full max-w-2xl mx-4">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-xl font-bold">Selecione o tipo de documento</h3>
                                    <button onClick={() => setMostrarModal(false)} className="text-gray-500 hover:text-gray-700">
                                        <i className="fas fa-times text-xl"></i>
                                    </button>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    {TIPOS_DOCUMENTOS.map(tipo => (
                                        <button
                                            key={tipo.id}
                                            onClick={() => handleTipoClick(tipo)}
                                            disabled={uploadando}
                                            className={`p-4 rounded-xl border-2 hover:border-${tipo.cor}-500 hover:bg-${tipo.cor}-50 transition flex flex-col items-center gap-2 ${uploadando ? 'opacity-50' : ''}`}
                                        >
                                            <div className={`w-12 h-12 bg-${tipo.cor}-100 rounded-full flex items-center justify-center`}>
                                                <i className={`fas fa-${tipo.icon} text-${tipo.cor}-500 text-xl`}></i>
                                            </div>
                                            <span className="text-sm font-medium text-center">{tipo.nome}</span>
                                        </button>
                                    ))}
                                </div>
                                {uploadando && (
                                    <div className="mt-4 text-center text-primary-500">
                                        <i className="fas fa-spinner fa-spin mr-2"></i>Enviando documento...
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Lista de Documentos por Categoria */}
                    <div className="space-y-6">
                        {documentosPorCategoria.map(categoria => (
                            <div key={categoria.id} className="bg-white rounded-xl shadow-lg overflow-hidden">
                                <div className={`bg-${categoria.cor}-500 text-white px-6 py-3 flex items-center gap-3`}>
                                    <i className={`fas fa-${categoria.icon}`}></i>
                                    <span className="font-medium">{categoria.nome}</span>
                                    <span className="bg-white bg-opacity-20 px-2 py-1 rounded-full text-xs">
                                        {categoria.documentos.length} arquivo(s)
                                    </span>
                                </div>
                                <div className="p-4">
                                    {categoria.documentos.length === 0 ? (
                                        <p className="text-gray-400 text-center py-4 text-sm">
                                            <i className="fas fa-inbox mr-2"></i>Nenhum documento nesta categoria
                                        </p>
                                    ) : (
                                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                            {categoria.documentos.map(doc => (
                                                <div key={doc.id} className="border rounded-lg p-4 hover:shadow-md transition">
                                                    {doc.categoria === 'foto' && doc.tipo.includes('image') ? (
                                                        <div className="mb-3">
                                                            <img src={doc.arquivo} alt="Foto" className="w-20 h-20 object-cover rounded-full mx-auto" />
                                                        </div>
                                                    ) : (
                                                        <div className="flex items-center mb-3">
                                                            <i className={`fas fa-${
                                                                doc.tipo.includes('pdf') ? 'file-pdf text-red-500' :
                                                                doc.tipo.includes('image') ? 'file-image text-blue-500' :
                                                                'file text-gray-500'
                                                            } text-3xl mr-3`}></i>
                                                            <div className="flex-1 min-w-0">
                                                                <p className="font-medium truncate text-sm">{doc.nome}</p>
                                                                <p className="text-xs text-gray-500">{(doc.tamanho / 1024).toFixed(2)} KB</p>
                                                            </div>
                                                        </div>
                                                    )}
                                                    <p className="text-xs text-gray-400 mb-3">
                                                        <i className="fas fa-calendar mr-1"></i>
                                                        {new Date(doc.data).toLocaleDateString('pt-BR')}
                                                    </p>
                                                    <div className="flex gap-2">
                                                        <button onClick={() => baixarDocumento(doc)} 
                                                            className="flex-1 bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600">
                                                            <i className="fas fa-download mr-1"></i>Baixar
                                                        </button>
                                                        <button onClick={() => atualizar('documentos', dados.documentos.filter(d => d.id !== doc.id))} 
                                                            className="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">
                                                            <i className="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    )}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // PLANO DE SA√öDE - Gest√£o de planos e carteirinhas
        function PlanoSaude({ dados, atualizar, usuarioLogado }) {
            const [mostrarForm, setMostrarForm] = useState(false);
            const [planoEditando, setPlanoEditando] = useState(null);
            const planosSaude = dados.planosSaude || [];

            const salvarPlano = (plano) => {
                if (planoEditando) {
                    atualizar('planosSaude', planosSaude.map(p => p.id === planoEditando.id ? { ...plano, id: planoEditando.id } : p));
                } else {
                    atualizar('planosSaude', [...planosSaude, { ...plano, id: Date.now() }]);
                }
                setMostrarForm(false);
                setPlanoEditando(null);
            };

            const excluirPlano = (id) => {
                if (confirm('Tem certeza que deseja excluir este plano?')) {
                    atualizar('planosSaude', planosSaude.filter(p => p.id !== id));
                }
            };

            const gerarCarteirinhaPDF = (plano) => {
                const func = dados.funcionarios.find(f => f.id === plano.funcionarioId);
                if (!func) return;

                const { jsPDF } = window.jspdf;
                const doc = new jsPDF({ orientation: 'landscape', unit: 'mm', format: [85.6, 54] });

                // Fundo gradiente azul
                doc.setFillColor(59, 130, 246);
                doc.rect(0, 0, 85.6, 54, 'F');

                // Cabe√ßalho
                doc.setFillColor(30, 42, 94);
                doc.rect(0, 0, 85.6, 12, 'F');

                doc.setTextColor(255, 255, 255);
                doc.setFontSize(8);
                doc.setFont('helvetica', 'bold');
                doc.text(plano.operadora || 'Plano de Sa√∫de', 42.8, 7, { align: 'center' });

                // Dados do benefici√°rio
                doc.setFillColor(255, 255, 255);
                doc.roundedRect(4, 15, 77.6, 35, 2, 2, 'F');

                doc.setTextColor(30, 42, 94);
                doc.setFontSize(6);
                doc.text('BENEFICI√ÅRIO', 8, 20);
                doc.setFontSize(9);
                doc.setFont('helvetica', 'bold');
                doc.text(func.nome || '', 8, 25);

                doc.setFont('helvetica', 'normal');
                doc.setFontSize(6);
                doc.text('N¬∫ CARTEIRA', 8, 31);
                doc.setFontSize(8);
                doc.setFont('helvetica', 'bold');
                doc.text(plano.numeroCarteira || '', 8, 35);

                doc.setFont('helvetica', 'normal');
                doc.setFontSize(6);
                doc.text('PLANO', 45, 31);
                doc.setFontSize(7);
                doc.setFont('helvetica', 'bold');
                doc.text(plano.tipoPlano || '', 45, 35);

                doc.setFont('helvetica', 'normal');
                doc.setFontSize(6);
                doc.text('VALIDADE', 8, 41);
                doc.setFontSize(7);
                doc.setFont('helvetica', 'bold');
                doc.text(plano.validade ? formatarData(plano.validade) : 'Indeterminado', 8, 45);

                doc.setFont('helvetica', 'normal');
                doc.setFontSize(6);
                doc.text('CPF', 45, 41);
                doc.setFontSize(7);
                doc.setFont('helvetica', 'bold');
                doc.text(func.cpf || '', 45, 45);

                doc.save(`carteirinha_${func.nome.replace(/\s+/g, '_')}.pdf`);
            };

            // Visualiza√ß√£o do funcion√°rio
            const meuPlano = planosSaude.find(p => p.funcionarioId === usuarioLogado.id);

            if (usuarioLogado.tipo !== 'admin') {
                return (
                    <div>
                        <h2 className="text-3xl font-bold mb-6">Meu Plano de Sa√∫de</h2>
                        {meuPlano ? (
                            <div className="bg-white p-6 rounded-lg shadow-lg">
                                <div className="flex items-start justify-between mb-6">
                                    <div className="flex items-center gap-4">
                                        <div className="w-16 h-16 bg-primary-100 rounded-full flex items-center justify-center">
                                            <i className="fas fa-medkit text-3xl text-primary-500"></i>
                                        </div>
                                        <div>
                                            <h3 className="text-2xl font-bold text-gray-800">{meuPlano.operadora}</h3>
                                            <p className="text-gray-500">{meuPlano.tipoPlano}</p>
                                        </div>
                                    </div>
                                    <button onClick={() => gerarCarteirinhaPDF(meuPlano)} className="bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600">
                                        <i className="fas fa-id-card mr-2"></i>Baixar Carteirinha
                                    </button>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <p className="text-sm text-gray-500">N√∫mero da Carteira</p>
                                        <p className="font-bold text-lg">{meuPlano.numeroCarteira}</p>
                                    </div>
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <p className="text-sm text-gray-500">Validade</p>
                                        <p className="font-bold text-lg">{meuPlano.validade ? formatarData(meuPlano.validade) : 'Indeterminado'}</p>
                                    </div>
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <p className="text-sm text-gray-500">Acomoda√ß√£o</p>
                                        <p className="font-bold text-lg">{meuPlano.acomodacao || '-'}</p>
                                    </div>
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <p className="text-sm text-gray-500">Abrang√™ncia</p>
                                        <p className="font-bold text-lg">{meuPlano.abrangencia || '-'}</p>
                                    </div>
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <p className="text-sm text-gray-500">Coparticipa√ß√£o</p>
                                        <p className="font-bold text-lg">{meuPlano.coparticipacao || '-'}</p>
                                    </div>
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <p className="text-sm text-gray-500">Central de Atendimento</p>
                                        <p className="font-bold text-lg">{meuPlano.telefoneOperadora || '-'}</p>
                                    </div>
                                </div>
                                {meuPlano.observacoes && (
                                    <div className="mt-4 p-4 bg-yellow-50 rounded-lg">
                                        <p className="text-sm text-gray-500 mb-1">Observa√ß√µes</p>
                                        <p className="text-gray-700">{meuPlano.observacoes}</p>
                                    </div>
                                )}
                            </div>
                        ) : (
                            <div className="bg-white p-8 rounded-lg shadow-lg text-center text-gray-500">
                                <i className="fas fa-medkit text-6xl mb-4 text-gray-300"></i>
                                <p>Voc√™ ainda n√£o possui um plano de sa√∫de cadastrado.</p>
                                <p className="text-sm mt-2">Entre em contato com o RH para mais informa√ß√µes.</p>
                            </div>
                        )}
                    </div>
                );
            }

            // Visualiza√ß√£o do admin
            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Plano de Sa√∫de</h2>
                        <button onClick={() => { setPlanoEditando(null); setMostrarForm(true); }} className="bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600">
                            <i className="fas fa-plus mr-2"></i>Cadastrar Plano
                        </button>
                    </div>

                    {mostrarForm && (
                        <FormPlanoSaude 
                            plano={planoEditando}
                            funcionarios={dados.funcionarios}
                            onSalvar={salvarPlano}
                            onCancelar={() => { setMostrarForm(false); setPlanoEditando(null); }}
                        />
                    )}

                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h3 className="text-xl font-bold mb-4">Planos Cadastrados</h3>
                        {planosSaude.length === 0 ? (
                            <div className="text-center py-8 text-gray-500">
                                <i className="fas fa-medkit text-6xl mb-4 text-gray-300"></i>
                                <p>Nenhum plano cadastrado</p>
                            </div>
                        ) : (
                            <div className="overflow-x-auto">
                                <table className="w-full">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="text-left p-3">Funcion√°rio</th>
                                            <th className="text-left p-3">Operadora</th>
                                            <th className="text-left p-3">Plano</th>
                                            <th className="text-left p-3">N¬∫ Carteira</th>
                                            <th className="text-left p-3">Validade</th>
                                            <th className="text-center p-3">A√ß√µes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {planosSaude.map(plano => {
                                            const func = dados.funcionarios.find(f => f.id === plano.funcionarioId);
                                            return (
                                                <tr key={plano.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3">{func?.nome || '-'}</td>
                                                    <td className="p-3">{plano.operadora}</td>
                                                    <td className="p-3">{plano.tipoPlano}</td>
                                                    <td className="p-3 font-mono">{plano.numeroCarteira}</td>
                                                    <td className="p-3">{plano.validade ? formatarData(plano.validade) : 'Indeterminado'}</td>
                                                    <td className="p-3 text-center">
                                                        <button onClick={() => gerarCarteirinhaPDF(plano)} className="text-primary-600 hover:text-primary-800 mr-2" title="Gerar Carteirinha">
                                                            <i className="fas fa-id-card"></i>
                                                        </button>
                                                        <button onClick={() => { setPlanoEditando(plano); setMostrarForm(true); }} className="text-yellow-600 hover:text-yellow-800 mr-2" title="Editar">
                                                            <i className="fas fa-edit"></i>
                                                        </button>
                                                        <button onClick={() => excluirPlano(plano.id)} className="text-red-600 hover:text-red-800" title="Excluir">
                                                            <i className="fas fa-trash"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Formul√°rio de Plano de Sa√∫de
        function FormPlanoSaude({ plano, funcionarios, onSalvar, onCancelar }) {
            const [formData, setFormData] = useState(plano || {
                funcionarioId: '',
                operadora: '',
                tipoPlano: '',
                numeroCarteira: '',
                validade: '',
                acomodacao: 'Enfermaria',
                abrangencia: 'Nacional',
                coparticipacao: 'Sim',
                telefoneOperadora: '',
                observacoes: ''
            });

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                    <h3 className="text-xl font-bold mb-4">{plano ? 'Editar' : 'Cadastrar'} Plano de Sa√∫de</h3>
                    <form onSubmit={(e) => { e.preventDefault(); if (!formData.funcionarioId) { alert('Selecione um funcion√°rio'); return; } onSalvar(formData); }}>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div className="lg:col-span-3">
                                <label className="block mb-2 font-medium">Funcion√°rio *</label>
                                <select value={formData.funcionarioId} onChange={(e) => setFormData({...formData, funcionarioId: parseInt(e.target.value)})} className="w-full px-4 py-2 border rounded-lg" required>
                                    <option value="">Selecione um funcion√°rio</option>
                                    {funcionarios.map(f => <option key={f.id} value={f.id}>{f.nome} - {f.cpf}</option>)}
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Operadora *</label>
                                <input type="text" value={formData.operadora} onChange={(e) => setFormData({...formData, operadora: e.target.value})} className="w-full px-4 py-2 border rounded-lg" placeholder="Ex: Unimed, Bradesco Sa√∫de" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Tipo de Plano *</label>
                                <input type="text" value={formData.tipoPlano} onChange={(e) => setFormData({...formData, tipoPlano: e.target.value})} className="w-full px-4 py-2 border rounded-lg" placeholder="Ex: Empresarial, Familiar" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">N√∫mero da Carteira *</label>
                                <input type="text" value={formData.numeroCarteira} onChange={(e) => setFormData({...formData, numeroCarteira: e.target.value})} className="w-full px-4 py-2 border rounded-lg" required />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Validade</label>
                                <input type="date" value={formData.validade} onChange={(e) => setFormData({...formData, validade: e.target.value})} className="w-full px-4 py-2 border rounded-lg" />
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Acomoda√ß√£o</label>
                                <select value={formData.acomodacao} onChange={(e) => setFormData({...formData, acomodacao: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Enfermaria">Enfermaria</option>
                                    <option value="Apartamento">Apartamento</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Abrang√™ncia</label>
                                <select value={formData.abrangencia} onChange={(e) => setFormData({...formData, abrangencia: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Nacional">Nacional</option>
                                    <option value="Regional">Regional</option>
                                    <option value="Municipal">Municipal</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Coparticipa√ß√£o</label>
                                <select value={formData.coparticipacao} onChange={(e) => setFormData({...formData, coparticipacao: e.target.value})} className="w-full px-4 py-2 border rounded-lg">
                                    <option value="Sim">Sim</option>
                                    <option value="N√£o">N√£o</option>
                                </select>
                            </div>
                            <div>
                                <label className="block mb-2 font-medium">Telefone da Operadora</label>
                                <input type="tel" value={formData.telefoneOperadora} onChange={(e) => setFormData({...formData, telefoneOperadora: e.target.value})} className="w-full px-4 py-2 border rounded-lg" placeholder="0800 000 0000" />
                            </div>
                            <div className="lg:col-span-3">
                                <label className="block mb-2 font-medium">Observa√ß√µes</label>
                                <textarea value={formData.observacoes} onChange={(e) => setFormData({...formData, observacoes: e.target.value})} className="w-full px-4 py-2 border rounded-lg" rows="2" placeholder="Informa√ß√µes adicionais sobre o plano..." />
                            </div>
                        </div>
                        <div className="flex gap-4 mt-6">
                            <button type="submit" className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">
                                <i className="fas fa-save mr-2"></i>Salvar
                            </button>
                            <button type="button" onClick={onCancelar} className="bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600">Cancelar</button>
                        </div>
                    </form>
                </div>
            );
        }

        // GEST√ÉO DE ACESSOS - Admin gerencia usu√°rios do sistema
        function GestaoAcessos({ dados, atualizar, usuarioLogado }) {
            const [busca, setBusca] = useState('');
            const [mostrarModalSenha, setMostrarModalSenha] = useState(false);
            const [funcionarioSelecionado, setFuncionarioSelecionado] = useState(null);
            const [novaSenha, setNovaSenha] = useState('');
            const [mensagem, setMensagem] = useState(null);

            // Usu√°rios do sistema (funcion√°rios + admin)
            const usuariosSistema = dados.funcionarios.map(f => ({
                ...f,
                usuario: f.cpf?.replace(/\D/g, '') || '',
                senhaPersonalizada: f.senhaPersonalizada || false,
                acessoAtivo: f.acessoAtivo !== false,
                ultimoAcesso: f.ultimoAcesso || null
            }));

            const usuariosFiltrados = usuariosSistema.filter(u => 
                u.nome?.toLowerCase().includes(busca.toLowerCase()) ||
                u.cpf?.includes(busca) ||
                u.email?.toLowerCase().includes(busca.toLowerCase())
            );

            const abrirModalSenha = (func) => {
                setFuncionarioSelecionado(func);
                setNovaSenha('');
                setMostrarModalSenha(true);
            };

            const resetarSenha = () => {
                if (!funcionarioSelecionado) return;
                
                const cpfLimpo = funcionarioSelecionado.cpf?.replace(/\D/g, '') || '';
                atualizar('funcionarios', dados.funcionarios.map(f => 
                    f.id === funcionarioSelecionado.id 
                        ? { ...f, senhaPersonalizada: false, senha: null }
                        : f
                ));
                setMensagem({ tipo: 'success', texto: `Senha resetada! Nova senha: ${cpfLimpo} (CPF)` });
                setMostrarModalSenha(false);
                setTimeout(() => setMensagem(null), 5000);
            };

            const definirNovaSenha = () => {
                if (!funcionarioSelecionado || !novaSenha || novaSenha.length < 4) {
                    setMensagem({ tipo: 'error', texto: 'Senha deve ter no m√≠nimo 4 caracteres' });
                    return;
                }
                
                atualizar('funcionarios', dados.funcionarios.map(f => 
                    f.id === funcionarioSelecionado.id 
                        ? { ...f, senhaPersonalizada: true, senha: novaSenha }
                        : f
                ));
                setMensagem({ tipo: 'success', texto: `Senha definida com sucesso para ${funcionarioSelecionado.nome}!` });
                setMostrarModalSenha(false);
                setTimeout(() => setMensagem(null), 5000);
            };

            const toggleAcesso = (funcId) => {
                const func = dados.funcionarios.find(f => f.id === funcId);
                const novoStatus = func.acessoAtivo === false ? true : false;
                atualizar('funcionarios', dados.funcionarios.map(f => 
                    f.id === funcId ? { ...f, acessoAtivo: novoStatus } : f
                ));
                setMensagem({ 
                    tipo: 'info', 
                    texto: `Acesso ${novoStatus ? 'ativado' : 'bloqueado'} para ${func.nome}` 
                });
                setTimeout(() => setMensagem(null), 3000);
            };

            const copiarCredenciais = (func) => {
                const cpfLimpo = func.cpf?.replace(/\D/g, '') || '';
                const senha = func.senhaPersonalizada ? func.senha : cpfLimpo;
                const texto = `Sistema RH - InstaSolutions\n\nAcesso: https://rh.frotainstasolutions.com.br\n\nUsu√°rio: ${cpfLimpo}\nSenha: ${senha}\n\nD√∫vidas? Contate o RH.`;
                
                navigator.clipboard.writeText(texto).then(() => {
                    setMensagem({ tipo: 'success', texto: 'Credenciais copiadas para a √°rea de transfer√™ncia!' });
                    setTimeout(() => setMensagem(null), 3000);
                });
            };

            return (
                <div>
                    <div className="flex justify-between items-center mb-6">
                        <h2 className="text-3xl font-bold">Gest√£o de Acessos</h2>
                    </div>

                    {mensagem && (
                        <div className={`mb-4 p-4 rounded-lg ${
                            mensagem.tipo === 'success' ? 'bg-green-100 text-green-800 border border-green-300' :
                            mensagem.tipo === 'error' ? 'bg-red-100 text-red-800 border border-red-300' :
                            'bg-blue-100 text-blue-800 border border-blue-300'
                        }`}>
                            <i className={`fas fa-${mensagem.tipo === 'success' ? 'check-circle' : mensagem.tipo === 'error' ? 'exclamation-circle' : 'info-circle'} mr-2`}></i>
                            {mensagem.texto}
                        </div>
                    )}

                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-green-500">
                            <p className="text-gray-600 text-sm">Acessos Ativos</p>
                            <p className="text-2xl font-bold text-gray-800">{usuariosSistema.filter(u => u.acessoAtivo).length}</p>
                        </div>
                        <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-red-500">
                            <p className="text-gray-600 text-sm">Acessos Bloqueados</p>
                            <p className="text-2xl font-bold text-gray-800">{usuariosSistema.filter(u => !u.acessoAtivo).length}</p>
                        </div>
                        <div className="bg-white p-4 rounded-lg shadow-lg border-l-4 border-primary-500">
                            <p className="text-gray-600 text-sm">Senhas Personalizadas</p>
                            <p className="text-2xl font-bold text-gray-800">{usuariosSistema.filter(u => u.senhaPersonalizada).length}</p>
                        </div>
                    </div>

                    <div className="bg-white p-4 rounded-lg shadow mb-4">
                        <input 
                            type="text" 
                            placeholder="Buscar por nome, CPF ou email..." 
                            value={busca} 
                            onChange={(e) => setBusca(e.target.value)}
                            className="w-full px-4 py-2 border rounded-lg" 
                        />
                    </div>

                    <div className="bg-white rounded-lg shadow-lg overflow-hidden">
                        <table className="w-full">
                            <thead className="bg-gray-50">
                                <tr>
                                    <th className="text-left p-4">Funcion√°rio</th>
                                    <th className="text-left p-4">Usu√°rio (CPF)</th>
                                    <th className="text-center p-4">Tipo Senha</th>
                                    <th className="text-center p-4">Status</th>
                                    <th className="text-center p-4">A√ß√µes</th>
                                </tr>
                            </thead>
                            <tbody>
                                {usuariosFiltrados.map(func => (
                                    <tr key={func.id} className="border-b hover:bg-gray-50">
                                        <td className="p-4">
                                            <div className="flex items-center gap-3">
                                                <div className="w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center">
                                                    {func.foto ? (
                                                        <img src={func.foto} className="w-10 h-10 rounded-full object-cover" />
                                                    ) : (
                                                        <i className="fas fa-user text-primary-500"></i>
                                                    )}
                                                </div>
                                                <div>
                                                    <p className="font-medium">{func.nome}</p>
                                                    <p className="text-sm text-gray-500">{func.email || 'Sem email'}</p>
                                                </div>
                                            </div>
                                        </td>
                                        <td className="p-4">
                                            <code className="bg-gray-100 px-2 py-1 rounded text-sm">{func.usuario}</code>
                                        </td>
                                        <td className="p-4 text-center">
                                            <span className={`px-2 py-1 rounded text-xs ${
                                                func.senhaPersonalizada 
                                                    ? 'bg-purple-100 text-purple-700' 
                                                    : 'bg-gray-100 text-gray-700'
                                            }`}>
                                                {func.senhaPersonalizada ? 'Personalizada' : 'Padr√£o (CPF)'}
                                            </span>
                                        </td>
                                        <td className="p-4 text-center">
                                            <button 
                                                onClick={() => toggleAcesso(func.id)}
                                                className={`px-3 py-1 rounded text-xs font-medium ${
                                                    func.acessoAtivo 
                                                        ? 'bg-green-100 text-green-700 hover:bg-green-200' 
                                                        : 'bg-red-100 text-red-700 hover:bg-red-200'
                                                }`}
                                            >
                                                {func.acessoAtivo ? '‚úì Ativo' : '‚úï Bloqueado'}
                                            </button>
                                        </td>
                                        <td className="p-4">
                                            <div className="flex justify-center gap-2">
                                                <button 
                                                    onClick={() => abrirModalSenha(func)} 
                                                    className="text-primary-500 hover:text-primary-700 p-2" 
                                                    title="Gerenciar Senha"
                                                >
                                                    <i className="fas fa-key"></i>
                                                </button>
                                                <button 
                                                    onClick={() => copiarCredenciais(func)} 
                                                    className="text-green-600 hover:text-green-800 p-2" 
                                                    title="Copiar Credenciais"
                                                >
                                                    <i className="fas fa-copy"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                ))}
                                {usuariosFiltrados.length === 0 && (
                                    <tr>
                                        <td colSpan="5" className="p-8 text-center text-gray-500">
                                            <i className="fas fa-users text-4xl mb-2"></i>
                                            <p>Nenhum funcion√°rio encontrado</p>
                                        </td>
                                    </tr>
                                )}
                            </tbody>
                        </table>
                    </div>

                    <div className="mt-6 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                        <h4 className="font-bold text-yellow-800 mb-2">
                            <i className="fas fa-lightbulb mr-2"></i>Dicas
                        </h4>
                        <ul className="text-sm text-yellow-700 space-y-1">
                            <li>‚Ä¢ <strong>Copiar Credenciais:</strong> Clique no √≠cone <i className="fas fa-copy"></i> para copiar e enviar por WhatsApp/Email</li>
                            <li>‚Ä¢ <strong>Senha Padr√£o:</strong> Por padr√£o, a senha √© o CPF do funcion√°rio (apenas n√∫meros)</li>
                            <li>‚Ä¢ <strong>Bloquear Acesso:</strong> Clique no status para ativar/desativar o acesso ao sistema</li>
                            <li>‚Ä¢ <strong>Resetar Senha:</strong> Volta a senha para o CPF do funcion√°rio</li>
                        </ul>
                    </div>

                    {/* Modal Gerenciar Senha */}
                    {mostrarModalSenha && funcionarioSelecionado && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                            <div className="bg-white rounded-xl p-6 w-full max-w-md mx-4">
                                <div className="flex justify-between items-center mb-4">
                                    <h3 className="text-xl font-bold">Gerenciar Senha</h3>
                                    <button onClick={() => setMostrarModalSenha(false)} className="text-gray-500 hover:text-gray-700">
                                        <i className="fas fa-times"></i>
                                    </button>
                                </div>
                                
                                <div className="mb-4 p-3 bg-gray-50 rounded-lg">
                                    <p className="font-medium">{funcionarioSelecionado.nome}</p>
                                    <p className="text-sm text-gray-500">CPF: {funcionarioSelecionado.cpf}</p>
                                </div>

                                <div className="space-y-4">
                                    <div>
                                        <label className="block mb-2 font-medium text-sm">Definir Nova Senha</label>
                                        <input 
                                            type="text" 
                                            value={novaSenha} 
                                            onChange={(e) => setNovaSenha(e.target.value)}
                                            placeholder="Digite a nova senha (m√≠n. 4 caracteres)"
                                            className="w-full px-4 py-2 border rounded-lg"
                                        />
                                        <button 
                                            onClick={definirNovaSenha}
                                            className="w-full mt-2 bg-primary-500 text-white px-4 py-2 rounded-lg hover:bg-primary-600"
                                        >
                                            <i className="fas fa-save mr-2"></i>Salvar Nova Senha
                                        </button>
                                    </div>

                                    <div className="border-t pt-4">
                                        <p className="text-sm text-gray-600 mb-2">Ou resetar para senha padr√£o (CPF):</p>
                                        <button 
                                            onClick={resetarSenha}
                                            className="w-full bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600"
                                        >
                                            <i className="fas fa-undo mr-2"></i>Resetar Senha (CPF)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // RECUPERA√á√ÉO DE DADOS
        function RecuperacaoDados({ dados, setDados }) {
            const [backups, setBackups] = useState([]);
            const [backupSelecionado, setBackupSelecionado] = useState(null);
            const [mostrarDetalhes, setMostrarDetalhes] = useState(false);

            useEffect(() => {
                carregarBackups();
            }, []);

            const carregarBackups = () => {
                const listaBackups = Storage.listBackups('sistemaRH_v2');
                setBackups(listaBackups);
            };

            const visualizarBackup = (backup) => {
                setBackupSelecionado(backup);
                setMostrarDetalhes(true);
            };

            const restaurarBackup = (backup) => {
                if (confirm(`Tem certeza que deseja restaurar o backup de ${new Date(backup.timestamp).toLocaleString('pt-BR')}?\n\nISTO IR√Å SUBSTITUIR TODOS OS DADOS ATUAIS!`)) {
                    setDados(backup.data);
                    Storage.save('sistemaRH_v2', backup.data);
                    FirebaseStorage.saveAll(backup.data);
                    alert('‚úÖ Backup restaurado com sucesso!');
                    setMostrarDetalhes(false);
                }
            };

            const exportarDados = () => {
                const dataStr = JSON.stringify(dados, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `backup-sistema-rh-${new Date().toISOString()}.json`;
                link.click();
            };

            const importarDados = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const dadosImportados = JSON.parse(e.target.result);
                            if (confirm('Tem certeza que deseja importar estes dados? Isso substituir√° todos os dados atuais!')) {
                                setDados(dadosImportados);
                                Storage.save('sistemaRH_v2', dadosImportados);
                                FirebaseStorage.saveAll(dadosImportados);
                                alert('‚úÖ Dados importados com sucesso!');
                            }
                        } catch (error) {
                            alert('‚ùå Erro ao importar dados: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                }
            };

            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">üîÑ Recupera√ß√£o de Dados</h2>
                    
                    {/* Estat√≠sticas Atuais */}
                    <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                        <h3 className="text-xl font-bold mb-4">üìä Dados Atuais no Sistema</h3>
                        <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                            <div className="text-center p-4 bg-blue-50 rounded-lg">
                                <div className="text-3xl font-bold text-blue-600">{dados.empresas?.length || 0}</div>
                                <div className="text-sm text-gray-600">Empresas</div>
                            </div>
                            <div className="text-center p-4 bg-green-50 rounded-lg">
                                <div className="text-3xl font-bold text-green-600">{dados.funcionarios?.length || 0}</div>
                                <div className="text-sm text-gray-600">Funcion√°rios</div>
                            </div>
                            <div className="text-center p-4 bg-purple-50 rounded-lg">
                                <div className="text-3xl font-bold text-purple-600">{dados.holerites?.length || 0}</div>
                                <div className="text-sm text-gray-600">Holerites</div>
                            </div>
                            <div className="text-center p-4 bg-orange-50 rounded-lg">
                                <div className="text-3xl font-bold text-orange-600">{dados.registrosPonto?.length || 0}</div>
                                <div className="text-sm text-gray-600">Registros Ponto</div>
                            </div>
                            <div className="text-center p-4 bg-red-50 rounded-lg">
                                <div className="text-3xl font-bold text-red-600">{dados.documentos?.length || 0}</div>
                                <div className="text-sm text-gray-600">Documentos</div>
                            </div>
                        </div>
                    </div>

                    {/* A√ß√µes R√°pidas */}
                    <div className="bg-white p-6 rounded-lg shadow-lg mb-6">
                        <h3 className="text-xl font-bold mb-4">‚ö° A√ß√µes R√°pidas</h3>
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <button onClick={exportarDados} className="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">
                                <i className="fas fa-download mr-2"></i>
                                Exportar Dados (JSON)
                            </button>
                            <label className="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 cursor-pointer text-center">
                                <i className="fas fa-upload mr-2"></i>
                                Importar Dados (JSON)
                                <input type="file" accept=".json" onChange={importarDados} className="hidden" />
                            </label>
                            <button onClick={carregarBackups} className="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700">
                                <i className="fas fa-sync-alt mr-2"></i>
                                Atualizar Backups
                            </button>
                        </div>
                    </div>

                    {/* Lista de Backups */}
                    <div className="bg-white p-6 rounded-lg shadow-lg">
                        <h3 className="text-xl font-bold mb-4">üíæ Backups Autom√°ticos Dispon√≠veis ({backups.length})</h3>
                        
                        {backups.length === 0 ? (
                            <div className="text-center py-8 text-gray-500">
                                <i className="fas fa-database text-6xl mb-4"></i>
                                <p>Nenhum backup autom√°tico encontrado</p>
                                <p className="text-sm mt-2">Os backups s√£o criados automaticamente ao salvar dados</p>
                            </div>
                        ) : (
                            <div className="space-y-3">
                                {backups.map((backup, index) => {
                                    const data = new Date(backup.timestamp);
                                    return (
                                        <div key={index} className="border rounded-lg p-4 hover:bg-gray-50">
                                            <div className="flex justify-between items-center">
                                                <div className="flex-1">
                                                    <div className="font-bold text-lg">
                                                        <i className="fas fa-clock text-blue-500 mr-2"></i>
                                                        {data.toLocaleString('pt-BR')}
                                                    </div>
                                                    <div className="text-sm text-gray-600 mt-2 grid grid-cols-5 gap-2">
                                                        <span>üì¶ {backup.data.empresas?.length || 0} empresas</span>
                                                        <span>üë• {backup.data.funcionarios?.length || 0} funcion√°rios</span>
                                                        <span>üí∞ {backup.data.holerites?.length || 0} holerites</span>
                                                        <span>‚è∞ {backup.data.registrosPonto?.length || 0} pontos</span>
                                                        <span>üìÑ {backup.data.documentos?.length || 0} docs</span>
                                                    </div>
                                                </div>
                                                <div className="flex gap-2 ml-4">
                                                    <button 
                                                        onClick={() => visualizarBackup(backup)}
                                                        className="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600"
                                                    >
                                                        <i className="fas fa-eye mr-1"></i> Ver Detalhes
                                                    </button>
                                                    <button 
                                                        onClick={() => restaurarBackup(backup)}
                                                        className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700"
                                                    >
                                                        <i className="fas fa-undo mr-1"></i> Restaurar
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>

                    {/* Modal de Detalhes */}
                    {mostrarDetalhes && backupSelecionado && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setMostrarDetalhes(false)}>
                            <div className="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto" onClick={(e) => e.stopPropagation()}>
                                <div className="p-6">
                                    <div className="flex justify-between items-center mb-4">
                                        <h3 className="text-2xl font-bold">
                                            üìã Detalhes do Backup
                                        </h3>
                                        <button onClick={() => setMostrarDetalhes(false)} className="text-gray-500 hover:text-gray-700">
                                            <i className="fas fa-times text-2xl"></i>
                                        </button>
                                    </div>
                                    
                                    <div className="mb-4 p-4 bg-blue-50 rounded-lg">
                                        <p className="font-bold">Data: {new Date(backupSelecionado.timestamp).toLocaleString('pt-BR')}</p>
                                    </div>

                                    <div className="space-y-4">
                                        {/* Holerites */}
                                        <div className="border rounded-lg p-4">
                                            <h4 className="font-bold mb-2">üí∞ Holerites ({backupSelecionado.data.holerites?.length || 0})</h4>
                                            {backupSelecionado.data.holerites?.length > 0 ? (
                                                <div className="max-h-40 overflow-y-auto">
                                                    {backupSelecionado.data.holerites.map((h, i) => (
                                                        <div key={i} className="text-sm text-gray-600 py-1 border-b">
                                                            Funcion√°rio ID: {h.funcionarioId} - {h.mes}/{h.ano} - {formatarMoeda(h.salarioLiquido)}
                                                        </div>
                                                    ))}
                                                </div>
                                            ) : (
                                                <p className="text-gray-500 text-sm">Nenhum holerite neste backup</p>
                                            )}
                                        </div>

                                        {/* Funcion√°rios */}
                                        <div className="border rounded-lg p-4">
                                            <h4 className="font-bold mb-2">üë• Funcion√°rios ({backupSelecionado.data.funcionarios?.length || 0})</h4>
                                            {backupSelecionado.data.funcionarios?.length > 0 ? (
                                                <div className="max-h-40 overflow-y-auto">
                                                    {backupSelecionado.data.funcionarios.map((f, i) => (
                                                        <div key={i} className="text-sm text-gray-600 py-1 border-b">
                                                            {f.nome} - {f.cargo} - {f.status}
                                                        </div>
                                                    ))}
                                                </div>
                                            ) : (
                                                <p className="text-gray-500 text-sm">Nenhum funcion√°rio neste backup</p>
                                            )}
                                        </div>

                                        {/* Empresas */}
                                        <div className="border rounded-lg p-4">
                                            <h4 className="font-bold mb-2">üè¢ Empresas ({backupSelecionado.data.empresas?.length || 0})</h4>
                                            {backupSelecionado.data.empresas?.length > 0 ? (
                                                <div>
                                                    {backupSelecionado.data.empresas.map((e, i) => (
                                                        <div key={i} className="text-sm text-gray-600 py-1 border-b">
                                                            {e.razaoSocial} - {e.cnpj}
                                                        </div>
                                                    ))}
                                                </div>
                                            ) : (
                                                <p className="text-gray-500 text-sm">Nenhuma empresa neste backup</p>
                                            )}
                                        </div>
                                    </div>

                                    <div className="mt-6 flex gap-4">
                                        <button 
                                            onClick={() => restaurarBackup(backupSelecionado)}
                                            className="flex-1 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700"
                                        >
                                            <i className="fas fa-undo mr-2"></i>
                                            Restaurar Este Backup
                                        </button>
                                        <button 
                                            onClick={() => setMostrarDetalhes(false)}
                                            className="px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600"
                                        >
                                            Fechar
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // INFORMA√á√ïES
        function Informacoes() {
            return (
                <div>
                    <h2 className="text-3xl font-bold mb-6">Informa√ß√µes do Sistema</h2>
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4 flex items-center">
                                <i className="fas fa-info-circle text-primary-500 mr-2"></i>Sobre o Sistema
                            </h3>
                            <div className="space-y-3 text-gray-700">
                                <p><strong>Nome:</strong> Sistema de Gest√£o de Funcion√°rios</p>
                                <p><strong>Vers√£o:</strong> 2.0.0</p>
                                <p><strong>√öltima Atualiza√ß√£o:</strong> Dezembro 2024</p>
                                <p><strong>Funcionalidades:</strong></p>
                                <ul className="list-disc pl-6 space-y-1 text-sm">
                                    <li>Cadastro de Empresas e Funcion√°rios</li>
                                    <li>Gest√£o de Holerites com Upload</li>
                                    <li>Registro de Ponto Eletr√¥nico</li>
                                    <li>Gest√£o de F√©rias</li>
                                    <li>Controle de Feriados</li>
                                    <li>Sistema de Avisos</li>
                                    <li>Gerenciamento de Documentos</li>
                                </ul>
                            </div>
                        </div>

                        <div className="bg-white p-6 rounded-lg shadow-lg">
                            <h3 className="text-xl font-bold mb-4 flex items-center">
                                <i className="fas fa-headset text-green-600 mr-2"></i>Suporte
                            </h3>
                            <div className="space-y-3 text-gray-700">
                                <p><strong>Email:</strong> suporte@empresa.com.br</p>
                                <p><strong>Telefone:</strong> (67) 3333-4444</p>
                                <p><strong>Hor√°rio:</strong> Segunda a Sexta, 8h √†s 18h</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        // Renderizar aplica√ß√£o
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
